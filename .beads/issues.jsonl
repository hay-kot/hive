{"id":"hive-55z","title":"Implement message preview modal with markdown rendering","description":"Add a message preview modal that opens when user presses \u003center\u003e on a selected message.\n\nRequirements:\n- Open modal on enter key when message is selected\n- Display full message content rendered as markdown\n- Show message metadata (topic, sender, timestamp, session ID)\n- Support scrolling for long messages (viewport)\n- Close with esc or enter\n- Style consistently with existing modals (OutputModal pattern)\n\nImplementation:\n- Create MessagePreviewModal component\n- Integrate glamour for markdown rendering\n- Add keybinding handler for enter on messages\n- Wire into model Update/View cycle","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:32:16.731602-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:46:18.424529-06:00","closed_at":"2026-01-30T13:46:18.424529-06:00","close_reason":"Implemented message preview modal with glamour markdown rendering, viewport scrolling, and keyboard navigation","dependencies":[{"issue_id":"hive-55z","depends_on_id":"hive-gmj","type":"blocks","created_at":"2026-01-30T13:32:25.065727-06:00","created_by":"Hayden"}]}
{"id":"hive-66m","title":"Register msg command and add tests","description":"Final integration:\n\n- Register MsgCmd in main.go following existing pattern\n- Add unit tests for message store (publish, subscribe, retention, wildcards)\n- Add integration tests for CLI commands\n- Update any documentation if present","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.812033-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:37:39.287581-06:00","closed_at":"2026-01-29T20:37:39.287581-06:00","close_reason":"Registered MsgCmd in main.go. Unit tests already exist in msgstore_test.go (12 tests) and sender_test.go (3 tests) covering publish, subscribe, retention, wildcards, and session detection","dependencies":[{"issue_id":"hive-66m","depends_on_id":"hive-hdg","type":"blocks","created_at":"2026-01-29T20:08:24.608036-06:00","created_by":"Hayden"}]}
{"id":"hive-c02","title":"Improve active pane visual distinction in TUI","description":"The current focus indicator (▸ and bold title) is too subtle. Users accidentally press enter on the wrong pane.\n\nOptions to explore:\n- Add a colored border around the focused pane\n- Dim/fade the unfocused pane content\n- Use a more prominent focus indicator\n- Add a background tint to the focused pane header\n\nShould work in both split mode and tab mode.","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:53:45.826314-06:00","created_by":"Hayden","updated_at":"2026-01-30T14:26:04.92571-06:00","closed_at":"2026-01-30T14:26:04.92571-06:00","close_reason":"Added rounded borders to distinguish active pane: blue border for focused pane, dark gray border for unfocused. Removed old vertical divider in favor of gap between bordered panes."}
{"id":"hive-cdw","title":"Define core messaging types and store interface","description":"Create the foundational types for the messaging system:\n\n- Message struct with ID, Topic, Payload, Sender, CreatedAt fields\n- Topic struct with Name, Messages slice, UpdatedAt\n- Store interface with Publish, Subscribe, List, Prune methods\n\nLocation: internal/core/messaging/\n\nThis establishes the contract before implementing storage or CLI.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:05:42.503772-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:19:10.639495-06:00","closed_at":"2026-01-29T20:19:10.639495-06:00","close_reason":"Created Message, Topic structs and Store interface in internal/core/messaging/"}
{"id":"hive-d98","title":"Implement global JSON file message store","description":"Implement the messaging Store interface using per-topic JSON files:\n\n- Storage location: $XDG_DATA_HOME/hive/messages/topics/{topic}.json\n- Reuse file locking pattern from kvstore.go (in-process mutex + flock)\n- Atomic writes via temp file + rename\n- Count-based retention: enforce max messages per topic on write (default 100)\n- Support topic wildcards for Subscribe (e.g., agent.* matches agent.build, agent.test)\n- Support subscribing to all topics when no pattern specified\n\nLocation: internal/store/jsonfile/msgstore.go","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.073644-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:23:45.952299-06:00","closed_at":"2026-01-29T20:23:45.952299-06:00","close_reason":"Implemented MsgStore with per-topic JSON files, file locking, atomic writes, count-based retention (default 100), and wildcard topic patterns","dependencies":[{"issue_id":"hive-d98","depends_on_id":"hive-cdw","type":"blocks","created_at":"2026-01-29T20:08:24.370052-06:00","created_by":"Hayden"}]}
{"id":"hive-dm5","title":"Research TUI focus indicator design options","description":"The current focus indicator (▸ and bold title) is too subtle - users accidentally press enter on the wrong pane.\n\n## Failed Approaches\n1. **Bordered panes** - Added rounded borders around focused pane. Removed header layout, looked cluttered.\n2. **Background tint on header** - Added blue background behind focused header text. Looked awful.\n\n## Research Needed\nLook at other TUI applications for inspiration on how they handle split pane focus:\n- lazygit\n- k9s\n- btop/htop\n- lazydocker\n- Other Bubble Tea apps\n\n## Possible Options to Explore\n- Different indicator symbols or positioning\n- Underline the focused header\n- Color the divider line based on which side is focused\n- Subtle highlight on selected list items only in focused pane\n- Different approach entirely?\n\n## User Feedback Requested\nWhat visual style would you prefer? Please add notes with examples or preferences.","notes":"## Research Findings\n\n### How Popular TUIs Handle Focus Indication\n\n#### 1. Lazygit / Lazydocker\n- **Bright blue border** around the focused pane (lazygotest confirms: 'highlighted with a bright blue border')\n- **Highlighted/brighter text** for active items\n- Very consistent visual language across all panels\n- Navigation: Tab to cycle, h/l or arrows to switch panes, number keys (1-5) for direct access\n\n#### 2. K9s (Kubernetes TUI)\n- Uses **configurable focus colors** via skins\n- Key styling properties: `focusColor`, `cursorColor`, `highlightColor`\n- Border has separate `fgColor` and `focusColor` \n- Allows full theme customization\n\n#### 3. btop/htop\n- **Color-coded sections** with distinct visual hierarchy\n- **Highlighted keys** are clickable/interactive\n- Relies more on section differentiation than active/inactive states\n- Uses ASCII art and Unicode for visual clarity\n\n#### 4. Tmux (Reference Pattern)\n- **Colorizes separators/dividers** adjacent to active pane\n- Inactive panes can be 'slightly greyed'\n- Active pane border set to distinct color (commonly blue)\n- Windows Terminal adopted similar approach\n\n### Bubble Tea / Lip Gloss Patterns\n\n#### Built-in Focus Support\n- `EnableReportFocus` for terminal focus events\n- Bubbles library has `Style struct` with focused/unfocused states\n- Common pattern: conditional style application based on focus state\n\n#### Border Options Available\n- `lipgloss.NormalBorder()` - standard\n- `lipgloss.ThickBorder()` - heavier weight\n- `lipgloss.DoubleBorder()` - double-line\n- `lipgloss.HiddenBorder()` - invisible (useful for unfocused to maintain alignment)\n- `BorderForeground()` to colorize\n\n### Design Options to Consider\n\nBased on research, here are the most viable approaches:\n\n#### Option A: Colored Divider (tmux-style)\nChange the vertical divider color based on which pane is focused:\n- Left focused: divider colored on right side or entire divider blue\n- Right focused: divider colored on left side\n- Subtle but effective in terminals\n\n#### Option B: Border Accent (lazygit-style)\nAdd a border to the focused pane only:\n- Focused: visible border (blue/accent color)\n- Unfocused: hidden border (maintains spacing)\n- Clear visual distinction\n\n#### Option C: Title Underline\nUnderline the focused pane title:\n- Less intrusive than borders\n- Clear indication of which pane\n- Works well with existing arrow indicator\n\n#### Option D: Dimmed Unfocused Pane\nDim/grey out the unfocused pane content:\n- Focused: normal colors\n- Unfocused: faded/dimmed colors\n- Common in IDEs (inactive panels)\n\n#### Option E: Selected Item Differentiation\nOnly show selection indicator in focused pane:\n- Active pane: blue bar on selected item\n- Inactive pane: no selection bar shown\n- User sees which pane can receive input\n\n### Recommendation\n\n**Option A (Colored Divider)** is the most elegant solution:\n1. Minimal visual clutter\n2. Proven pattern (tmux, Windows Terminal)\n3. Easy to implement with lipgloss\n4. Works with existing arrow + bold title indicators\n\nImplementation would be:\n```go\n// In renderSplitView\nvar dividerColor lipgloss.Color\nif m.focusedPane == PaneSessions {\n    dividerColor = colorBlue  // Blue when left focused (divider 'points' right)\n} else {\n    dividerColor = colorBlue  // Blue when right focused\n}\ndivider := lipgloss.NewStyle().\n    Foreground(dividerColor).\n    Render(strings.Repeat(\"│\", contentHeight))\n```\n\nOr **Option E** could complement this - only showing the selection bar (┃) in the focused pane.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T14:35:02.81949-06:00","created_by":"Hayden","updated_at":"2026-01-30T14:39:10.487747-06:00","closed_at":"2026-01-30T14:39:10.487747-06:00","close_reason":"Research complete. Documented findings from lazygit, k9s, btop, lazydocker, and tmux. Recommended colored divider approach (Option A) as primary solution."}
{"id":"hive-gmj","title":"Research charm markdown rendering (glamour)","description":"Investigate glamour library for rendering markdown in the TUI message preview modal.\n\nResearch:\n- How to integrate glamour with bubbles/lipgloss\n- Styling options and terminal compatibility\n- How to render markdown within a modal/viewport\n- Check if glamour is already a dependency or needs adding\n- Look at existing modal patterns in the codebase (OutputModal, Modal)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:32:04.363416-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:40:37.370189-06:00","closed_at":"2026-01-30T13:40:37.370189-06:00","close_reason":"Research complete. Glamour v2 needed as new dependency. Use tokyo-night style to match existing colors. Viewport bubble for scrollable content. See .hive/research/glamour-markdown-rendering.md"}
{"id":"hive-hdg","title":"Implement hive msg CLI command","description":"Create the msg command with pub/sub/list subcommands:\n\nhive msg pub --topic \u003ctopic\u003e [message | -f file | stdin]\n  - Publish message to topic\n  - Auto-detect sender from session ID\n  \nhive msg sub [--topic \u003cpattern\u003e] [--timeout duration] [--last N]\n  - No topic: subscribe to all topics\n  - With topic: filter by pattern (supports wildcards like agent.*)\n  - --last N returns last N messages immediately\n  - Without --last, polls for new messages until timeout\n  \nhive msg list [--json]\n  - List all topics with message counts\n\nFollow pattern from cmd_ctx.go for structure.\nLocation: internal/commands/cmd_msg.go","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.434803-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:36:54.020004-06:00","closed_at":"2026-01-29T20:36:54.020004-06:00","close_reason":"Implemented hive msg CLI with pub/sub/list subcommands, auto sender detection, wildcard topic patterns, and polling for new messages","dependencies":[{"issue_id":"hive-hdg","depends_on_id":"hive-d98","type":"blocks","created_at":"2026-01-29T20:08:24.435226-06:00","created_by":"Hayden"},{"issue_id":"hive-hdg","depends_on_id":"hive-kto","type":"blocks","created_at":"2026-01-29T20:08:24.492719-06:00","created_by":"Hayden"}]}
{"id":"hive-irz","title":"Implement colored divider + focused-only selection indicator","description":"Improve focus indication by combining two techniques from research (hive-dm5):\n\n## Changes\n\n### 1. Colored Divider (tmux-style)\nChange the vertical divider color based on which pane is focused:\n- Focused pane side: blue divider\n- Unfocused: gray divider\n\n### 2. Focused-Only Selection Indicator\nOnly show the selection bar (┃) in the currently focused pane:\n- Active pane: blue bar on selected item\n- Inactive pane: no selection bar (just spacing)\n\nThis makes it immediately clear which pane will receive keyboard input.\n\n## Files to Modify\n- `internal/tui/styles.go` - divider style may need focus variant\n- `internal/tui/model.go` - pass focus state to divider rendering in `renderSplitView`\n- `internal/tui/delegate.go` - conditionally render selection bar based on pane focus\n- `internal/tui/messages_view.go` - same for message items\n\n## Acceptance Criteria\n- [ ] Divider changes color based on focused pane\n- [ ] Selection bar only visible in focused pane\n- [ ] Works correctly when switching focus with Tab\n- [ ] No visual glitches during focus transitions","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:23:59.087226-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:28:27.751431-06:00","closed_at":"2026-01-30T15:28:27.751431-06:00","close_reason":"Closed"}
{"id":"hive-kto","title":"Add session ID detection from CWD","description":"Create utility to detect current hive session from working directory:\n\n- Read sessions.json from $XDG_DATA_HOME/hive/sessions.json\n- Find session where path matches or is prefix of CWD\n- Return session ID for use as sender identifier in messages\n- Return empty string if not in a hive session (allow anonymous publishing)\n\nThis enables automatic sender identification without manual configuration.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.255375-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:25:21.976907-06:00","closed_at":"2026-01-29T20:25:21.976907-06:00","close_reason":"Added SessionDetector to find current hive session from working directory with path prefix matching"}
{"id":"hive-uhe","title":"Remove KV store implementation","description":"Remove the KV store code entirely:\n\n- Delete internal/core/context/kv.go\n- Delete internal/store/jsonfile/kvstore.go  \n- Remove 'hive ctx kv' subcommand from cmd_ctx.go\n- Remove any KV-related tests\n- Clean up any imports/references\n\nState storage will be handled by beads instead.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.613123-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:45:05.437764-06:00","closed_at":"2026-01-29T20:45:05.437764-06:00","close_reason":"Removed KV store: deleted internal/core/context/kv.go, internal/store/jsonfile/kvstore.go and test, removed hive ctx kv subcommand from cmd_ctx.go","dependencies":[{"issue_id":"hive-uhe","depends_on_id":"hive-hdg","type":"blocks","created_at":"2026-01-29T20:08:24.550509-06:00","created_by":"Hayden"}]}
{"id":"hive-wvy","title":"Update msg command: list by default, JSON output","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:48:11.945114-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:49:53.159676-06:00","closed_at":"2026-01-29T20:49:53.159676-06:00","close_reason":"Updated msg sub to list messages by default (JSON), added --listen flag for polling mode, made msg list output JSON"}
