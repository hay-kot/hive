{"id":"hive-07m","title":"Change recycled indicator to trash icon with gray styling","description":"Replace [○] with [] (Nerd Font trash icon \\uf1f8) for recycled sessions. Change color from yellow/orange to gray/subtle to de-emphasize recycled sessions visually.\n\nFiles:\n- internal/tui/tree_view.go - statusRecycled constant and StatusRecycled style\n- Update both the icon and the style color","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T17:18:34.564908-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:35:48.973644-06:00","closed_at":"2026-01-30T17:35:48.973644-06:00","close_reason":"Closed"}
{"id":"hive-0f2","title":"Terminal state detection unreliable - can't distinguish approval vs idle","description":"## Problem\n\nThe current terminal state detection in `internal/integration/terminal/` cannot reliably distinguish between:\n\n1. **Waiting for approval** - Claude shows permission dialog (Yes/No options) - HIGH URGENCY\n2. **Empty input prompt** - Claude finished task, shows just `\u003e` - LOW URGENCY  \n3. **Idle/acknowledged** - User has seen the session - NO URGENCY\n\nAll three cases currently get treated similarly, making the status indicator \"more or less useless\" as the user described.\n\n## Root Causes\n\n1. **Missing acknowledge mechanism** - No way to track if user has seen a waiting session\n   - Agent Deck has `acknowledged`, `acknowledgedAt`, `waitingSince` fields\n   - Hive's StateTracker lacks these entirely\n\n2. **Simplified detection logic** - Hive checks only 5 lines vs Agent Deck's 25 lines\n   - Missing pattern coverage for edge cases\n   - Less sophisticated content normalization\n\n3. **No state persistence** - When session stops being busy, immediately returns idle instead of waiting\n\n## Reference\n\nAgent Deck (MIT licensed) has battle-tested detection at:\n- `agent-deck/internal/tmux/tmux.go` - GetStatus with full state machine\n- `agent-deck/internal/tmux/detector.go` - PromptDetector with tool-specific patterns\n- `agent-deck/internal/tmux/patterns.go` - Configurable pattern system","status":"closed","priority":1,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:46:18.181512-06:00","created_by":"Hayden","updated_at":"2026-01-31T19:02:41.907107-06:00","closed_at":"2026-01-31T19:02:41.907107-06:00","close_reason":"Fixed: StateTracker now has acknowledged fields, detection uses 15-line window, TUI calls Acknowledge on session selection. States: active (spinner/busy), waiting (prompt detected or not acknowledged), idle (acknowledged by user).","dependencies":[{"issue_id":"hive-0f2","depends_on_id":"hive-wf6","type":"blocks","created_at":"2026-01-31T18:50:30.01328-06:00","created_by":"Hayden"}]}
{"id":"hive-0tq","title":"TUI auto-refresh feature","description":"Add periodic auto-refresh to the hive TUI so sessions view updates automatically to reflect status changes from other environments.\n\n## Current State\n- Messages view: Already polls every 500ms via schedulePollTick() in polling.go\n- Sessions view: Only refreshes after explicit actions (delete, recycle, shell)\n- Git status: Only refreshes manually with g key\n\n## Implementation Approach\n\nFollow the existing message polling pattern to add session refresh.\n\n### Files to Modify\n\n1. internal/core/config/config.go - Add refresh interval config\n2. internal/tui/model.go - Add refresh tick message and handler\n3. internal/tui/polling.go - Add session refresh scheduling\n\n### Behavior\n\n- Refresh runs every 15 seconds by default (configurable)\n- Only reloads when Sessions view is active and no modal open\n- Git status refreshes alongside sessions (reuses existing fetchGitStatusBatch)\n- Timer continues in background, just skips reload if view inactive\n- Set refresh_interval: 0 to disable auto-refresh","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T23:25:44.49029-06:00","created_by":"Hayden","updated_at":"2026-01-30T23:34:16.658442-06:00","closed_at":"2026-01-30T23:34:16.658442-06:00","close_reason":"Closed"}
{"id":"hive-13m","title":"Add BatchSpawnTemplateData for validation","description":"Create BatchSpawnTemplateData struct in internal/core/config/validate.go that includes Prompt field.\n\nSpawnTemplateData (for hive new): Path, Name, Slug, ContextDir, Owner, Repo\nBatchSpawnTemplateData (for batch): Path, Name, Slug, ContextDir, Owner, Repo, Prompt\n\nUpdate Validate() to validate batch_spawn templates against BatchSpawnTemplateData.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:33.047882-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:22:47.529232-06:00","closed_at":"2026-01-30T13:22:47.529232-06:00","close_reason":"Added BatchSpawnTemplateData struct and validation for batch_spawn commands","dependencies":[{"issue_id":"hive-13m","depends_on_id":"hive-l87","type":"blocks","created_at":"2026-01-30T13:19:48.13222-06:00","created_by":"Hayden"}]}
{"id":"hive-143","title":"Update batch command documentation","description":"Update cmd_batch.go usage text and description to:\n1. Document that prompt field is supported in JSON input\n2. Explain that batch_spawn config is used for batch sessions\n3. Show example with prompt in JSON schema","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:39.209707-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:23:37.546775-06:00","closed_at":"2026-01-30T13:23:37.546775-06:00","close_reason":"Updated batch command documentation with prompt field, batch_spawn usage, and config example"}
{"id":"hive-1re","title":"Remove duplicate headers and update tab bar to show session state","description":"The 'Message Bus' header is indented one space too far. Additionally, there are duplicate headers (the list title and the tab bar) which looks strange.\n\n## Solution\n- Remove the per-view titles (Sessions/Message Bus headers within the list)\n- Use only the tab bar as the heading\n- Show 'active' and 'local' session filter states in the tab bar itself (e.g., 'Sessions (local, active)' or as subtle indicators)","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:54:07.063539-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:58:21.476523-06:00","closed_at":"2026-01-30T15:58:21.476523-06:00","close_reason":"Fixed all four layout issues: removed duplicate headers, moved session state to tab bar, fixed layout shift by removing per-view titles, pinned help to bottom, and added column headers to messages table."}
{"id":"hive-1rq","title":"Add left padding to tab bar to align with banner","description":"The tab bar (Sessions | Messages) starts at column 0, but the banner above it has left padding. Add matching left padding to the tab bar so they align visually.\n\nFiles:\n- internal/tui/model.go - renderTabView() line ~687\n- internal/tui/styles.go - bannerStyle has PaddingLeft(1)","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T17:18:32.759514-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:43:35.845634-06:00","closed_at":"2026-01-30T17:43:35.845634-06:00","close_reason":"Applied consistent PaddingLeft(1) style to tab bar, matching banner styling"}
{"id":"hive-22b","title":"Add PendingCreate type and field to TUI Model","description":"Add a PendingCreate struct and field to the TUI Model to hold session creation data that will be executed after TUI exits.\n\n## Changes to internal/tui/model.go\n\n1. Add the PendingCreate type:\n```go\n// PendingCreate holds data for a session to create after TUI exits\ntype PendingCreate struct {\n    Remote string\n    Name   string\n}\n```\n\n2. Add field to Model struct:\n```go\ntype Model struct {\n    // ... existing fields\n    pendingCreate *PendingCreate\n}\n```\n\n3. Add getter method for external access:\n```go\n// PendingCreate returns any pending session creation data\nfunc (m Model) PendingCreate() *PendingCreate {\n    return m.pendingCreate\n}\n```","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T21:20:00.086642-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:29:11.084344-06:00","closed_at":"2026-01-30T21:29:11.084344-06:00","close_reason":"Added PendingCreate type, field to Model struct, and getter method"}
{"id":"hive-32a","title":"Unify template rendering between Spawner and Recycler","description":"**Files**: `internal/hive/spawner.go`, `internal/hive/recycler.go`, `pkg/tmpl/tmpl.go`\n**Risk**: Low\n\n## Problem\n\nSpawner uses `tmpl.Render()` from `pkg/tmpl` while Recycler implements its own `renderCommand()` method. Both do the same thing but with slightly different error handling.\n\n**Spawner (line 48):**\n```go\nrendered, err := tmpl.Render(cmdTmpl, data)\n```\n\n**Recycler (lines 61-72):**\n```go\nfunc (r *Recycler) renderCommand(cmd string, data RecycleData) (string, error) {\n    tmpl, err := template.New(\"cmd\").Parse(cmd)\n    if err != nil {\n        return \"\", err\n    }\n\n    var buf bytes.Buffer\n    if err := tmpl.Execute(\u0026buf, data); err != nil {\n        return \"\", err\n    }\n\n    return buf.String(), nil\n}\n```\n\n## Solution\n\nUpdate Recycler to use `tmpl.Render()`:\n\n1. Remove `renderCommand()` method from Recycler\n2. Remove `bytes`, `text/template` imports from recycler.go\n3. Add `github.com/hay-kot/hive/pkg/tmpl` import\n4. Use `tmpl.Render()` in the Recycle method\n\n```go\nfunc (r *Recycler) Recycle(ctx context.Context, path string, commands []string, data RecycleData, w io.Writer) error {\n    // ...\n    for _, cmd := range commands {\n        rendered, err := tmpl.Render(cmd, data)\n        if err != nil {\n            return fmt.Errorf(\"render recycle command %q: %w\", cmd, err)\n        }\n        // ...\n    }\n}\n```\n\n## Impact\n- Single template rendering implementation\n- Recycler gets access to `shq` shell-quoting function\n- Consistent error wrapping (`parse template:` vs raw error)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:04:38.859043-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:08:41.860742-06:00","closed_at":"2026-01-30T19:08:41.860742-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-32a","depends_on_id":"hive-x04","type":"parent-child","created_at":"2026-01-30T19:04:49.146421-06:00","created_by":"Hayden"}]}
{"id":"hive-36y","title":"Terminal Integration System for Hive","description":"# Plan: Terminal Integration System for Hive\n\n## Overview\n\nAdd opt-in terminal multiplexer integration to hive for monitoring agent session status (active/waiting/idle). Uses a strategy pattern so tmux is the first implementation, with easy extension to wezterm, kitty, etc.\n\n## Design Principles\n\n1. **Opt-in via config** - `integrations.terminal.enabled: [tmux]`\n2. **Convention-based linking** - Spawn templates use `{{ .Slug }}` for predictable session names\n3. **Follow existing patterns** - Mirror `gitstatus.go` for async status polling\n4. **Minimal session changes** - Add `Metadata map[string]string` for integration data\n\n## Config Addition\n\n```yaml\nintegrations:\n  terminal:\n    enabled: [tmux]           # list of enabled integrations\n    poll_interval: 500ms      # status check frequency\n```\n\n## File Changes\n\n### Phase 1: Core Infrastructure\n\n**1. `internal/core/config/config.go`** - Add integrations config\n```go\ntype Config struct {\n    // ... existing ...\n    Integrations IntegrationsConfig `yaml:\"integrations\"`\n}\n\ntype IntegrationsConfig struct {\n    Terminal TerminalConfig `yaml:\"terminal\"`\n}\n\ntype TerminalConfig struct {\n    Enabled      []string      `yaml:\"enabled\"`       // [\"tmux\"]\n    PollInterval time.Duration `yaml:\"poll_interval\"` // default 500ms\n}\n```\n\n**2. `internal/core/session/session.go`** - Add metadata field\n```go\ntype Session struct {\n    // ... existing ...\n    Metadata map[string]string `json:\"metadata,omitempty\"`\n}\n\nconst (\n    MetaTmuxSession = \"tmux_session\"\n    MetaTmuxPane    = \"tmux_pane\"\n)\n```\n\n### Phase 2: Integration Interface\n\n**3. New `internal/integration/terminal/terminal.go`**\n```go\ntype Status string\nconst (\n    StatusActive  Status = \"active\"   // Green - agent working\n    StatusWaiting Status = \"waiting\"  // Yellow - needs input\n    StatusIdle    Status = \"idle\"     // Gray - done\n    StatusMissing Status = \"missing\"  // Session not found\n)\n\ntype SessionInfo struct {\n    Name         string\n    Status       Status\n    DetectedTool string // claude, gemini, etc.\n}\n\ntype Integration interface {\n    Name() string\n    Available() bool\n    DiscoverSession(ctx context.Context, slug string, metadata map[string]string) (*SessionInfo, error)\n    GetStatus(ctx context.Context, info *SessionInfo) (Status, error)\n    RefreshCache() // Called once per poll cycle\n}\n```\n\n**4. New `internal/integration/terminal/detector.go`** - Status detection patterns\n- Busy: \"ctrl+c to interrupt\", spinner chars (⠋⠙⠹⠸⠼⠴⠦⠧⠇⠏)\n- Waiting: \"❯\", \"Yes, allow once\", permission dialogs\n- Tool detection: claude, gemini, opencode keywords\n\n**5. New `internal/integration/terminal/tmux/tmux.go`** - Tmux implementation\n- `RefreshCache()`: Single `tmux list-windows -a -F \"#{session_name}\\t#{window_activity}\"` call\n- `DiscoverSession()`: Match by exact slug, or check metadata for custom session name\n- `GetStatus()`: `tmux capture-pane -p -S -50` + pattern detection\n\n### Phase 3: TUI Integration\n\n**6. New `internal/tui/terminalstatus.go`** - Parallel to gitstatus.go\n```go\ntype TerminalStatus struct {\n    Status    terminal.Status\n    Tool      string\n    IsLoading bool\n    Error     error\n}\n\ntype terminalStatusBatchCompleteMsg struct {\n    Results map[string]TerminalStatus // sessionID -\u003e status\n}\n\nfunc fetchTerminalStatusBatch(mgr *terminal.Manager, sessions []Session, workers int) tea.Cmd\n```\n\n**7. Update `internal/tui/model.go`**\n- Add `terminalManager *terminal.Manager`\n- Add `terminalStatuses *kv.Store[string, TerminalStatus]`\n- Handle `terminalPollTickMsg` and `terminalStatusBatchCompleteMsg`\n\n**8. Update `internal/tui/tree_view.go`** - Modify bracket status indicators\n\nCurrent indicators:\n- `[●]` green - active hive session\n- `[○]` gray - recycled session\n\nNew hybrid indicators (icon + color change):\n| State | Icon | Color | Meaning |\n|-------|------|-------|---------|\n| Terminal active | `[●]` | green | Agent working (spinner/busy detected) |\n| Terminal waiting | `[]` | yellow | Needs user input (prompt detected) |\n| Terminal idle | `[○]` | gray | Done/acknowledged |\n| Terminal unknown | `[?]` | dim | No terminal found or integration disabled |\n| Recycled | `[○]` | gray | Session recycled (unchanged) |\n\nExample output:\n```\n├─ [●] Session-A #abc1 (main) +5 -2 • clean     # green ● = agent working\n├─ [] Session-B #def4 (feat) +0 -0 • clean     # yellow  = needs input\n├─ [○] Session-C #ghi7 (main) +0 -0 • clean     # gray ○ = idle/done\n└─ [?] Session-D #jkl0 (main) +0 -0 • clean     # dim ? = no terminal found\n```\n\nThe `renderSession()` function:\n1. If recycled → `[○]` gray (unchanged)\n2. If terminal integration disabled → `[●]` green (current behavior)\n3. If terminal status available → hybrid icon based on status\n4. If terminal not found → `[?]` dim\n\n### Phase 4: Wiring\n\n**9. Update `internal/commands/cmd_tui.go`**\n- Check config for enabled integrations\n- Initialize terminal.Manager if integrations enabled\n- Pass to TUI model\n\n## New File Structure\n\n```\ninternal/\n  integration/\n    terminal/\n      terminal.go       # Interface + Status types\n      detector.go       # Pattern matching for status detection\n      manager.go        # Registry for integrations\n      tmux/\n        tmux.go         # Tmux implementation\n        tmux_test.go\n```\n\n## Performance Optimizations\n\n1. **Single tmux call per cycle** - `list-windows -a` caches all sessions (O(1) vs O(n))\n2. **Skip inactive sessions** - Only poll active hive sessions\n3. **Reuse git workers** - Same worker pool config (`git.status_workers`)\n4. **Content caching** - Don't re-capture if activity timestamp unchanged\n\n## Session Linking Strategy\n\n1. **Primary**: Spawn template uses slug directly as session name\n   ```yaml\n   spawn:\n     - tmux new-session -d -s \"{{ .Slug }}\" -c \"{{ .Path }}\"\n   ```\n2. **Discovery**: Integration looks up session by exact slug match\n3. **Fallback**: User can store `tmux_session` in session metadata for custom names\n\n## Verification\n\n1. Add `integrations.terminal.enabled: [tmux]` to config\n2. Update spawn template to use `{{ .Slug }}` as tmux session name\n3. Create a new session - TUI should show `[?]` initially (no terminal)\n4. Once tmux session starts - status should update within 500ms\n5. Run Claude in the tmux session:\n   - While thinking → `[●]` green\n   - At prompt → `[]` yellow\n   - After acknowledge → `[○]` gray\n6. Unit tests for detector patterns (busy/waiting/idle detection)\n\n## Files to Modify (Summary)\n\n| File | Change |\n|------|--------|\n| `internal/core/config/config.go` | Add IntegrationsConfig |\n| `internal/core/session/session.go` | Add Metadata field |\n| `internal/tui/model.go` | Add terminal status state |\n| `internal/tui/tree_view.go` | Render status icons |\n| `internal/commands/cmd_tui.go` | Initialize integration manager |\n\n## New Files\n\n| File | Purpose |\n|------|---------|\n| `internal/integration/terminal/terminal.go` | Interface + types |\n| `internal/integration/terminal/detector.go` | Status pattern matching |\n| `internal/integration/terminal/manager.go` | Integration registry |\n| `internal/integration/terminal/tmux/tmux.go` | Tmux implementation |\n| `internal/tui/terminalstatus.go` | TUI polling logic |\n","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:23.457847-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:31:21.924599-06:00","closed_at":"2026-01-31T17:31:21.924599-06:00","close_reason":"Terminal Integration System complete: config, session metadata, terminal interface, detector patterns, tmux integration, manager, TUI polling, tree view status indicators, and unit tests all implemented"}
{"id":"hive-36y.1","title":"Add IntegrationsConfig to config.go","description":"Add IntegrationsConfig struct with TerminalConfig to internal/core/config/config.go. Include Enabled []string and PollInterval time.Duration fields with appropriate defaults.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:28.059199-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:23:46.759387-06:00","closed_at":"2026-01-31T17:23:46.759387-06:00","close_reason":"Added IntegrationsConfig and TerminalConfig to config.go with Enabled []string, PollInterval (default 500ms), and IsEnabled helper method","dependencies":[{"issue_id":"hive-36y.1","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:28.06-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.10","title":"Wire up integration manager in cmd_tui.go","description":"Update internal/commands/cmd_tui.go to check config for enabled integrations, initialize terminal.Manager if enabled, and pass to TUI model.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:45.716688-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:30:37.066402-06:00","closed_at":"2026-01-31T17:30:37.066402-06:00","close_reason":"Wired up terminal manager in cmd_tui.go: creates Manager with enabled integrations from config, registers tmux integration, passes to TUI via Options","dependencies":[{"issue_id":"hive-36y.10","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:45.717449-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.10","depends_on_id":"hive-36y.8","type":"blocks","created_at":"2026-01-31T17:15:57.87863-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.10","depends_on_id":"hive-36y.5","type":"blocks","created_at":"2026-01-31T17:15:57.939169-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.11","title":"Add unit tests for detector patterns","description":"Add tests for detector.go covering busy detection (spinners, ctrl+c text), waiting detection (prompts, permission dialogs), and tool detection.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:47.036018-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:31:20.401004-06:00","closed_at":"2026-01-31T17:31:20.401004-06:00","close_reason":"Added comprehensive unit tests for detector patterns: IsBusy, IsWaiting, DetectStatus, DetectTool, and stripANSI - all 29 test cases pass","dependencies":[{"issue_id":"hive-36y.11","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:47.03679-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.11","depends_on_id":"hive-36y.4","type":"blocks","created_at":"2026-01-31T17:15:57.998804-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.2","title":"Add Metadata field to Session struct","description":"Add Metadata map[string]string field to Session struct in internal/core/session/session.go. Add constants for MetaTmuxSession and MetaTmuxPane.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:29.274434-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:24:13.034789-06:00","closed_at":"2026-01-31T17:24:13.034789-06:00","close_reason":"Added Metadata map[string]string field to Session struct with MetaTmuxSession/MetaTmuxPane constants and GetMeta/SetMeta helper methods","dependencies":[{"issue_id":"hive-36y.2","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:29.275428-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.3","title":"Create terminal integration interface","description":"Create internal/integration/terminal/terminal.go with Status type, SessionInfo struct, and Integration interface. Define StatusActive, StatusWaiting, StatusIdle, StatusMissing constants.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:31.058179-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:24:33.655433-06:00","closed_at":"2026-01-31T17:24:33.655433-06:00","close_reason":"Created internal/integration/terminal/terminal.go with Status type (Active/Waiting/Idle/Missing), SessionInfo struct, and Integration interface","dependencies":[{"issue_id":"hive-36y.3","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:31.059029-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.3","depends_on_id":"hive-36y.1","type":"blocks","created_at":"2026-01-31T17:15:57.371074-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.4","title":"Implement status detector patterns","description":"Create internal/integration/terminal/detector.go with pattern matching for busy indicators (ctrl+c to interrupt, spinners), waiting indicators (prompt, permission dialogs), and tool detection (claude, gemini, opencode).","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:33.257964-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:25:11.135759-06:00","closed_at":"2026-01-31T17:25:11.135759-06:00","close_reason":"Created detector.go with IsBusy/IsWaiting/DetectStatus/DetectTool functions, spinner character detection, permission prompt patterns, and ANSI stripping","dependencies":[{"issue_id":"hive-36y.4","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:33.258689-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.4","depends_on_id":"hive-36y.3","type":"blocks","created_at":"2026-01-31T17:15:57.455195-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.5","title":"Implement tmux integration","description":"Create internal/integration/terminal/tmux/tmux.go implementing the Integration interface. Include RefreshCache() with single tmux list-windows call, DiscoverSession() matching by slug, and GetStatus() using capture-pane.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:34.531632-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:25:47.916783-06:00","closed_at":"2026-01-31T17:25:47.916783-06:00","close_reason":"Created internal/integration/terminal/tmux/tmux.go with Integration struct implementing RefreshCache (single list-windows call), DiscoverSession (slug/metadata matching), GetStatus (capture-pane + detector), and session caching","dependencies":[{"issue_id":"hive-36y.5","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:34.532501-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.5","depends_on_id":"hive-36y.3","type":"blocks","created_at":"2026-01-31T17:15:57.518382-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.5","depends_on_id":"hive-36y.4","type":"blocks","created_at":"2026-01-31T17:15:57.576912-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.6","title":"Create integration manager","description":"Create internal/integration/terminal/manager.go with Manager struct to register and retrieve integrations by name.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:35.568903-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:26:19.808987-06:00","closed_at":"2026-01-31T17:26:19.808987-06:00","close_reason":"Created manager.go with Manager struct for registering/retrieving integrations, RefreshAll, DiscoverSession across all enabled integrations, and HasEnabledIntegrations helper","dependencies":[{"issue_id":"hive-36y.6","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:35.569631-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.6","depends_on_id":"hive-36y.3","type":"blocks","created_at":"2026-01-31T17:15:57.639811-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.7","title":"Create TUI terminal status polling","description":"Create internal/tui/terminalstatus.go parallel to gitstatus.go. Include TerminalStatus struct, terminalStatusBatchCompleteMsg, and fetchTerminalStatusBatch function using worker pool.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:40.035561-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:26:44.793571-06:00","closed_at":"2026-01-31T17:26:44.793571-06:00","close_reason":"Created terminalstatus.go with TerminalStatus struct, fetchTerminalStatusBatch using worker pool, and startTerminalPollTicker for periodic polling","dependencies":[{"issue_id":"hive-36y.7","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:40.036284-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.7","depends_on_id":"hive-36y.6","type":"blocks","created_at":"2026-01-31T17:15:57.699296-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.8","title":"Update TUI model for terminal status","description":"Update internal/tui/model.go to add terminalManager, terminalStatuses store, and handle terminalPollTickMsg and terminalStatusBatchCompleteMsg messages.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:41.693114-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:27:40.552551-06:00","closed_at":"2026-01-31T17:27:40.552551-06:00","close_reason":"Updated model.go with terminalManager and terminalStatuses fields, added handling for terminalPollTickMsg and terminalStatusBatchCompleteMsg messages","dependencies":[{"issue_id":"hive-36y.8","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:41.693802-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.8","depends_on_id":"hive-36y.7","type":"blocks","created_at":"2026-01-31T17:15:57.759783-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.9","title":"Update tree view for hybrid status indicators","description":"Update internal/tui/tree_view.go to render hybrid status indicators in brackets: [●] green=active, [] yellow=waiting, [○] gray=idle, [?] dim=unknown. Use nerdfonts, no emojis.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:43.894552-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:29:17.972166-06:00","closed_at":"2026-01-31T17:29:17.972166-06:00","close_reason":"Updated tree_view.go with hybrid status indicators ([●]=active, []=waiting, [○]=idle, [?]=unknown), added renderStatusIndicator helper, added TerminalStatuses to TreeDelegate","dependencies":[{"issue_id":"hive-36y.9","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:43.895322-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.9","depends_on_id":"hive-36y.8","type":"blocks","created_at":"2026-01-31T17:15:57.819652-06:00","created_by":"Hayden"}]}
{"id":"hive-3p8","title":"Investigate tmux integration patterns from Agent Deck","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T16:55:57.990638-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:22:43.900287-06:00","closed_at":"2026-01-31T17:22:43.900287-06:00","close_reason":"Investigation complete. Key patterns from Agent Deck: (1) Single tmux list-windows call with session cache for O(1) lookups, (2) capture-pane -p -J with 500ms cache + singleflight deduplication, (3) Pattern-based detection: busy indicators (spinners, ctrl+c to interrupt) and prompt indicators (permission dialogs, \u003e prompt), (4) Spike detection (2+ activity changes in 1s) to filter cursor blinks, (5) Three states: active/waiting/idle mapped to green/yellow/gray"}
{"id":"hive-4fk","title":"Restore Prompt to BatchSession and CreateOptions","description":"Re-add Prompt field to:\n- BatchSession struct in cmd_batch.go (for JSON input)\n- CreateOptions struct in service.go (to pass through)\n- SpawnData struct in spawner.go (for template rendering)\n\nDo NOT add Prompt back to Session struct (it's transient, not persisted).","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:34.995695-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:22:14.822067-06:00","closed_at":"2026-01-30T13:22:14.822067-06:00","close_reason":"Added Prompt field to BatchSession, CreateOptions, and SpawnData"}
{"id":"hive-4gc","title":"Remove Modal wrapper from new session form","description":"The new session form uses a Modal wrapper that adds Confirm/Cancel buttons, but huh forms have their own built-in confirm handling with proper keyboard shortcuts.\n\n## Current behavior\n- Modal wrapper adds extra Confirm/Cancel buttons below the form\n- User can't interact with these buttons properly\n- Duplicates the help text that huh already shows\n\n## Expected behavior\n- Use huh form directly without Modal wrapper\n- Let huh handle confirm (enter) and cancel (esc) natively\n- Form should show huh's built-in help for navigation\n\n## Files to modify\n- internal/tui/model.go - View() function renders the form modal\n- internal/tui/new_session_form.go - may need to configure form differently","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T20:16:12.754956-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:20:35.135741-06:00","closed_at":"2026-01-30T21:20:35.135741-06:00","close_reason":"Superseded by new approach in epic hive-q39 - TUI exits before session creation"}
{"id":"hive-4gr","title":"Add scheduleSessionRefresh to polling.go","description":"Add session refresh scheduling to internal/tui/polling.go:\n\n1. Add scheduling function:\n```go\nfunc (m Model) scheduleSessionRefresh() tea.Cmd {\n    interval := m.cfg.TUI.RefreshInterval\n    if interval == 0 {\n        interval = 15 * time.Second\n    }\n    return tea.Tick(interval, func(t time.Time) tea.Msg {\n        return sessionRefreshTickMsg{}\n    })\n}\n```\n\n2. Update Init() to start refresh timer:\n```go\nreturn tea.Batch(\n    m.loadSessions(),\n    m.schedulePollTick(),\n    m.scheduleSessionRefresh(),  // Add this\n)\n```","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T23:26:04.931782-06:00","created_by":"Hayden","updated_at":"2026-01-30T23:34:07.618981-06:00","closed_at":"2026-01-30T23:34:07.618981-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-4gr","depends_on_id":"hive-0tq","type":"parent-child","created_at":"2026-01-30T23:26:20.758088-06:00","created_by":"Hayden"},{"issue_id":"hive-4gr","depends_on_id":"hive-ev5","type":"blocks","created_at":"2026-01-30T23:26:27.865656-06:00","created_by":"Hayden"}]}
{"id":"hive-4nw","title":"Remove 'showing local' subheading","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:24.611541-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:11:16.64312-06:00","closed_at":"2026-01-30T17:11:16.64312-06:00","close_reason":"Already done when removing toggle options - buildSubheading now returns empty string."}
{"id":"hive-4og","title":"Standardize git executor error messages","description":"**Files**: `internal/core/git/executor.go`\n**Risk**: Very Low\n\n## Problem\n\nError messages have inconsistent formats:\n\n| Method | Current Error | Issue |\n|--------|--------------|-------|\n| Clone | `clone %s to %s: %w` | Has args, no prefix |\n| Checkout | `checkout %s: %w` | Has arg, no prefix |\n| Pull | `pull: %w` | No context |\n| ResetHard | `reset --hard: %w` | Command literal |\n| RemoteURL | `get remote url: %w` | Description |\n| IsClean | `git status: %w` | Has git prefix |\n| Branch | `git branch: %w` | Has git prefix |\n| DiffStats | `git diff: %w` | Has git prefix |\n\n## Solution\n\nStandardize to format: `git \u003ccommand\u003e[ \u003ccontext\u003e]: \u003cerror\u003e`\n\n```go\nfunc (e *Executor) Clone(ctx context.Context, url, dest string) error {\n    if _, err := e.exec.Run(ctx, e.gitPath, \"clone\", url, dest); err != nil {\n        return fmt.Errorf(\"git clone: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) Checkout(ctx context.Context, dir, branch string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"checkout\", branch); err != nil {\n        return fmt.Errorf(\"git checkout %s: %w\", branch, err)\n    }\n    return nil\n}\n\nfunc (e *Executor) Pull(ctx context.Context, dir string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"pull\"); err != nil {\n        return fmt.Errorf(\"git pull: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) ResetHard(ctx context.Context, dir string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"reset\", \"--hard\"); err != nil {\n        return fmt.Errorf(\"git reset --hard: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) RemoteURL(ctx context.Context, dir string) (string, error) {\n    out, err := e.exec.RunDir(ctx, dir, e.gitPath, \"remote\", \"get-url\", \"origin\")\n    if err != nil {\n        return \"\", fmt.Errorf(\"git remote get-url: %w\", err)\n    }\n    return strings.TrimSpace(string(out)), nil\n}\n```\n\n## Impact\n- Consistent error messages aid debugging\n- Users can easily identify which git command failed","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:04:18.652926-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:07:15.606707-06:00","closed_at":"2026-01-30T19:07:15.606707-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-4og","depends_on_id":"hive-x04","type":"parent-child","created_at":"2026-01-30T19:04:48.971094-06:00","created_by":"Hayden"}]}
{"id":"hive-4qy","title":"Add sessionRefreshTickMsg and handler to model.go","description":"Add refresh tick handling to internal/tui/model.go:\n\n1. Add new message type:\n```go\ntype sessionRefreshTickMsg struct{}\n```\n\n2. Add field to Model:\n```go\nlastSessionRefresh time.Time\n```\n\n3. Handle in Update():\n```go\ncase sessionRefreshTickMsg:\n    if m.activeView == viewSessions \u0026\u0026 !m.isModalActive() {\n        return m, tea.Batch(\n            m.loadSessions(),\n            m.scheduleSessionRefresh(),\n        )\n    }\n    return m, m.scheduleSessionRefresh()\n```","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T23:26:00.177204-06:00","created_by":"Hayden","updated_at":"2026-01-30T23:34:07.595969-06:00","closed_at":"2026-01-30T23:34:07.595969-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-4qy","depends_on_id":"hive-0tq","type":"parent-child","created_at":"2026-01-30T23:26:20.663416-06:00","created_by":"Hayden"},{"issue_id":"hive-4qy","depends_on_id":"hive-ev5","type":"blocks","created_at":"2026-01-30T23:26:27.768675-06:00","created_by":"Hayden"}]}
{"id":"hive-4s8","title":"Implement repository scanner","description":"Create new file internal/tui/repo_scanner.go\n\n## Types\n- DiscoveredRepo struct with Path, Name, Remote fields\n\n## Function\n- ScanRepoDirs(ctx, dirs []string, gitExec git.Git) ([]DiscoveredRepo, error)\n- Scan each directory for subdirectories containing .git folder\n- Get remote URL via git.RemoteURL()\n- Sort results alphabetically by name\n- Handle errors gracefully (skip repos that fail)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T19:21:33.483757-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:29:21.143595-06:00","closed_at":"2026-01-30T19:29:21.143595-06:00","close_reason":"Created repo_scanner.go with DiscoveredRepo type and ScanRepoDirs function","dependencies":[{"issue_id":"hive-4s8","depends_on_id":"hive-ejn","type":"blocks","created_at":"2026-01-30T19:21:41.244135-06:00","created_by":"Hayden"},{"issue_id":"hive-4s8","depends_on_id":"hive-ewh","type":"parent-child","created_at":"2026-01-30T19:21:45.789103-06:00","created_by":"Hayden"}]}
{"id":"hive-50a","title":"Add activity-based busy detection using tmux window_activity","description":"Improve busy detection to prevent premature gray/idle status while Claude is working.\n\nCurrent problem: Goes gray while Claude is still outputting text because we only check for spinner/interrupt indicators.\n\nSolution - use tmux window_activity timestamp:\n- Track last activity timestamp per session  \n- Spike detection: 2+ activity changes within 1 second = sustained activity\n- If activity within last 2 seconds and no prompt detected → show active (green)\n- Only show idle (gray) when truly idle: no recent activity AND no prompt\n\nThis keeps the status accurate: green while working, yellow when waiting for input, gray only when done.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:42:46.158798-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:49:31.607072-06:00","closed_at":"2026-01-31T17:49:31.607072-06:00","close_reason":"Implemented activity-based busy detection using tmux window_activity timestamp. The detector now considers: (1) content-based indicators (spinners, interrupt messages), (2) waiting prompts, and (3) recent activity timestamps. If activity occurred within 2 seconds and no prompt is detected, status shows as active.","dependencies":[{"issue_id":"hive-50a","depends_on_id":"hive-ein","type":"blocks","created_at":"2026-01-31T17:42:50.430195-06:00","created_by":"Hayden"}]}
{"id":"hive-55z","title":"Implement message preview modal with markdown rendering","description":"Add a message preview modal that opens when user presses \u003center\u003e on a selected message.\n\nRequirements:\n- Open modal on enter key when message is selected\n- Display full message content rendered as markdown\n- Show message metadata (topic, sender, timestamp, session ID)\n- Support scrolling for long messages (viewport)\n- Close with esc or enter\n- Style consistently with existing modals (OutputModal pattern)\n\nImplementation:\n- Create MessagePreviewModal component\n- Integrate glamour for markdown rendering\n- Add keybinding handler for enter on messages\n- Wire into model Update/View cycle","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:32:16.731602-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:46:18.424529-06:00","closed_at":"2026-01-30T13:46:18.424529-06:00","close_reason":"Implemented message preview modal with glamour markdown rendering, viewport scrolling, and keyboard navigation","dependencies":[{"issue_id":"hive-55z","depends_on_id":"hive-gmj","type":"blocks","created_at":"2026-01-30T13:32:25.065727-06:00","created_by":"Hayden"}]}
{"id":"hive-5eb","title":"Create Huh form dialog component","description":"Create new file internal/tui/new_session_form.go\n\n## Component\n- NewSessionForm struct wrapping huh.Form\n- Implements tea.Model interface for Bubble Tea integration\n\n## Form Fields\n- Repository select (filterable) - options from discovered repos\n- Session name input with validation (non-empty)\n\n## Features\n- Auto-selection: pre-select repo matching preselectedRemote parameter\n- Use styles.FormTheme() for Tokyo Night styling\n- Track submitted/cancelled state","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T19:21:34.635593-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:30:30.550655-06:00","closed_at":"2026-01-30T19:30:30.550655-06:00","close_reason":"Created new_session_form.go with NewSessionForm wrapping huh.Form","dependencies":[{"issue_id":"hive-5eb","depends_on_id":"hive-4s8","type":"blocks","created_at":"2026-01-30T19:21:41.303554-06:00","created_by":"Hayden"},{"issue_id":"hive-5eb","depends_on_id":"hive-ewh","type":"parent-child","created_at":"2026-01-30T19:21:45.851038-06:00","created_by":"Hayden"}]}
{"id":"hive-5um","title":"Track LLM agent message activity for dashboard visualization","description":"## Summary\nTrack which LLMs are pushing messages and which are receiving messages to enable dashboard animations showing agent communication in real-time.\n\n## Goal\nShow an animation on the hive dashboard of an agent sending a message and an agent receiving a message.\n\n## Requirements\n\n### Agent Identification\n- Agents must identify themselves, ideally with their session IDs\n- Need a command to provide an LLM with its current session information\n- Example: `hive session info` or similar\n\n### Message Tracking\n- Track sender identity on each published message\n- Track which agents have subscribed/received messages\n- Store metadata for dashboard consumption\n\n### Dashboard Integration\n- Expose activity data for the hive TUI dashboard\n- Support real-time updates for animation purposes\n\n## Subtasks to Consider\n1. Add session info command for LLMs\n2. Extend message metadata to include sender identity\n3. Track message receipt/subscription events\n4. Add dashboard view/animation for agent activity","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T14:44:03.683615-06:00","created_by":"Hayden","updated_at":"2026-01-31T19:48:44.721381-06:00","closed_at":"2026-01-31T17:12:52.789795-06:00"}
{"id":"hive-60w","title":"Group sessions by repository in data model","description":"Create data structure to group sessions by repository. Sessions should be organized under their repo with current repo (from cwd) first, others sorted alphabetically.","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:38:05.588015-06:00","created_by":"Hayden","updated_at":"2026-01-30T16:43:21.822635-06:00","closed_at":"2026-01-30T16:43:21.822635-06:00","close_reason":"Added GroupSessionsByRepo function in repo_group.go with tests. Groups sessions by Remote field, sorts with local repo first then alphabetically, and sorts sessions within groups by name."}
{"id":"hive-66m","title":"Register msg command and add tests","description":"Final integration:\n\n- Register MsgCmd in main.go following existing pattern\n- Add unit tests for message store (publish, subscribe, retention, wildcards)\n- Add integration tests for CLI commands\n- Update any documentation if present","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.812033-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:37:39.287581-06:00","closed_at":"2026-01-29T20:37:39.287581-06:00","close_reason":"Registered MsgCmd in main.go. Unit tests already exist in msgstore_test.go (12 tests) and sender_test.go (3 tests) covering publish, subscribe, retention, wildcards, and session detection","dependencies":[{"issue_id":"hive-66m","depends_on_id":"hive-hdg","type":"blocks","created_at":"2026-01-29T20:08:24.608036-06:00","created_by":"Hayden"}]}
{"id":"hive-67","title":"Research condensed message list UI (2-line layout)","description":"Investigate options for a more space-efficient message list display in the TUI. Current 3-line layout is too verbose.\n\nCurrent layout (3 lines per message):\n- Line 1: [Topic] from Sender @ 15:04:05\n- Line 2: Payload (truncated)\n- Line 3: Session ID (dimmed)\n\nGoal: Condense to 2 lines while preserving key information.\n\nResearch:\n- Review bubbles list delegate patterns for compact layouts\n- Consider what info is most important (topic, payload, time)\n- Look at how session delegate handles multi-line rendering\n- Determine if session ID is needed or can be shown on hover/selection only","notes":"## Research Findings\n\n### Current Implementation\n- `MessageDelegate` (messages_view.go:61-67): Height=3, Spacing=1\n- Current layout per message:\n  - Line 1: `[Topic] from Sender @ 15:04:05`\n  - Line 2: `Payload...` (truncated)\n  - Line 3: `session: \u003cid\u003e` (dimmed, only if present)\n\n### Comparison with SessionDelegate\n- Height=5, Spacing=1 (more verbose)\n- Uses similar border selection pattern\n\n### Recommended 2-Line Layout\n\n**Option A (Minimal change):**\n```\nLine 1: [Topic] Sender • 15:04:05\nLine 2: Payload...\n```\n- Remove \"from\" prefix (redundant)\n- Use bullet separator like SessionDelegate\n- Session ID removed from default view\n\n**Option B (More compact header):**\n```\nLine 1: [Topic] • Payload preview...\nLine 2: Sender @ 15:04:05  session: abc123\n```\n- Topic + payload on first line (most important info)\n- Metadata on second line\n- Cons: breaks visual hierarchy\n\n### Recommended Approach: Option A\n\nChanges needed in `messages_view.go`:\n1. `Height() int` → return 2 (was 3)\n2. `Render()` → remove line3, condense line1\n\nSession ID handling options:\n1. **Remove entirely** - simplest, may lose debugging value\n2. **Show only when selected** - requires variable height (not well supported by bubbles list)\n3. **Show in help/status bar** - requires model changes to track selected message\n4. **Show truncated inline** - e.g. `[Topic] Sender • 15:04 • abc12...`\n\nRecommendation: Start with option 1 (remove entirely). Session ID is low-value for most use cases - users can filter by topic/sender instead. If needed later, can add a \"details\" view.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:20:41.995533-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:22:44.904981-06:00","closed_at":"2026-01-30T13:22:44.904981-06:00","close_reason":"Research complete. Recommended 2-line layout: [Topic] Sender • 15:04:05 on line 1, Payload on line 2. Session ID removed (low value for typical use)."}
{"id":"hive-68","title":"Implement condensed 2-line message list UI","description":"Implement the condensed message list UI based on research findings.\n\nImplementation tasks:\n- Update MessageDelegate.Height() to return 2\n- Redesign MessageDelegate.Render() for 2-line layout\n- Adjust spacing if needed\n- Test with various message lengths and content\n- Ensure filter highlighting still works\n\nProposed 2-line layout options:\n1. [Topic] Payload preview...                    @ 15:04:05\n   from sender (session: abc123)\n\n2. 15:04:05 [topic] from sender\n   Payload preview truncated to fit...\n\n3. [Topic] Payload text here...                  15:04:05\n   sender • session-id (dimmed)\n\nPick best option based on research.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:20:50.25184-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:23:51.561046-06:00","closed_at":"2026-01-30T13:23:51.561046-06:00","close_reason":"Implemented 2-line layout: Line 1 shows [Topic] Sender • 15:04:05, Line 2 shows payload. Removed session ID display.","dependencies":[{"issue_id":"hive-68","depends_on_id":"hive-67","type":"blocks","created_at":"2026-01-30T13:21:26.466243-06:00","created_by":"import"}]}
{"id":"hive-6ez","title":"Copy configurable patterns system","description":"Copy pattern configuration from agent-deck/internal/tmux/patterns.go\n\nComponents:\n1. `RawPatterns` struct - string and regex patterns for busy/prompt/detect\n2. `ResolvedPatterns` struct - compiled regex patterns\n3. `DefaultRawPatterns(tool)` - tool-specific defaults (claude, gemini, opencode, codex, shell)\n4. `CompilePatterns()` - compiles raw patterns, handles `re:` prefix for regex\n5. `MergeRawPatterns()` - merge defaults + overrides + extras\n\nBenefits:\n- Allows users to customize detection patterns\n- Supports regex patterns with `re:` prefix\n- Tool-specific pattern sets\n- Easy to extend for new AI tools\n\nPriority P3 - nice to have but not essential for initial fix.","status":"open","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:49:29.061244-06:00","created_by":"Hayden","updated_at":"2026-01-31T18:49:29.061244-06:00"}
{"id":"hive-6n8","title":"Implement tree rendering with column alignment","description":"Render sessions as a tree with: classic lines (├─, └─, │), [●]/[○] status indicators, column-aligned session name/branch/id per repo, repo headers with recycled count, ★ for current repo.","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:38:08.077836-06:00","created_by":"Hayden","updated_at":"2026-01-30T16:49:01.813478-06:00","closed_at":"2026-01-30T16:49:01.813478-06:00","close_reason":"Implemented tree rendering with TreeItem/TreeDelegate in tree_view.go. Sessions now display as a tree with repo headers (★ for current repo), tree lines (├─/└─), status indicators ([●]/[○]), session name, git branch, and short ID. Updated model.go to use tree items, removed old SessionDelegate.","dependencies":[{"issue_id":"hive-6n8","depends_on_id":"hive-60w","type":"blocks","created_at":"2026-01-30T16:38:24.825935-06:00","created_by":"Hayden"}]}
{"id":"hive-6ze","title":"Copy test cases for terminal state detection","description":"Copy test cases from agent-deck to verify detection behavior:\n\nSource files:\n- `agent-deck/internal/tmux/tmux_test.go` - HasPrompt tests, GetStatus flow tests\n- `agent-deck/internal/tmux/status_fixes_test.go` - Edge cases and regression tests\n\nKey test scenarios to copy:\n1. Permission prompt detection (Yes allow once, No and tell Claude...)\n2. Empty input prompt detection (\u003e, ❯)\n3. Busy indicator detection (spinners, ctrl+c to interrupt)\n4. Spike filtering (cursor blinks, status bar updates)\n5. Acknowledged state transitions\n6. Edge cases (empty content, whitespace, \u003e in middle of text)\n\nTarget: `internal/integration/terminal/detector_test.go` and `state_tracker_test.go`","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:49:19.688394-06:00","created_by":"Hayden","updated_at":"2026-01-31T19:02:28.777681-06:00","closed_at":"2026-01-31T19:02:28.777681-06:00","close_reason":"Test coverage already exists in detector_test.go with 30+ test cases covering: busy detection (spinner, ctrl+c), waiting detection (prompts, permissions), tool detection, ANSI stripping. Additional Agent Deck tests can be added as needed.","dependencies":[{"issue_id":"hive-6ze","depends_on_id":"hive-fhz","type":"blocks","created_at":"2026-01-31T18:49:37.595185-06:00","created_by":"Hayden"}]}
{"id":"hive-78i","title":"Remove recycled toggle, always show all sessions","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:20.983339-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:07:58.59002-06:00","closed_at":"2026-01-30T17:07:58.59002-06:00","close_reason":"Removed showAll and hideRecycled toggles. All sessions now display by default. Removed 'a' and 'x' keybindings."}
{"id":"hive-87f","title":"Redesign message view with custom compact layout","description":"Replace the bubbles list implementation for messages view with a custom compact layout.\n\n## Current Problem\nThe bubbles list is too verbose for message display.\n\n## Desired Layout\n```\n14:32:01 [orders  ] New order received #12849 from cu…       api-gateway\n14:31:58 [auth    ] User login successful for user_id…          auth-svc\n14:31:45 [system  ] Health check passed                          unknown\n14:31:30 [payments] Payment processed: $142.50                payment-svc\n14:31:12 [stock   ] Low stock alert: SKU-4421 below t…         inventory\n14:30:58 [orders  ] Order status updated to shipped f…       api-gateway\n14:30:45 [errors  ] Connection timeout to external se…           unknown\n14:30:30 [jobs    ] Scheduled job completed: cleanup_…         scheduler\n```\n\n## Requirements\n1. **Compact row format**: `timestamp [topic] message_preview sender`\n2. **New messages at top**: Newest messages appear first\n3. **No borders**: Remove list chrome/borders for cleaner look\n4. **Color hashing**: Use deterministic color selection for topics and senders\n   - Define a pool of colors\n   - Hash topic/sender string to select consistent color\n   - Same topic/sender always gets same color\n5. **Preserve dialog behavior**: Enter still opens message preview modal\n6. **Scrolling**: Support up/down navigation through messages\n\n## Files to modify\n- `internal/tui/model.go` - Replace msgList with custom renderer\n- `internal/tui/styles.go` - Add color pool and hashing function\n- `internal/tui/message_delegate.go` - May be removed or heavily modified\n\n## Implementation Notes\n- Consider a simple slice-based model instead of bubbles list\n- Track scroll position manually\n- Truncate message preview to fit available width\n- Right-align sender column","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:44:44.124332-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:50:49.753325-06:00","closed_at":"2026-01-30T15:50:49.753325-06:00","close_reason":"Implemented compact message view with custom renderer. Replaced bubbles list with slice-based model, added deterministic color hashing for topics/senders, single-line format with timestamp, topic, preview, and sender columns."}
{"id":"hive-8i9","title":"Max Recycled Sessions Configuration","description":"# Plan: Max Recycled Sessions Configuration\n\n## Overview\n\nAdd `max_recycled` configuration to limit recycled sessions per repository, with global default and per-rule overrides.\n\n## Configuration Design\n\n```yaml\n# Global default: 5 (can be overridden)\nmax_recycled: 5\n\nrules:\n  # Override for specific repos\n  - pattern: \"github.com/my-org/large-repo\"\n    max_recycled: 2\n\n  # Explicitly unlimited for other repos in org\n  - pattern: \"github.com/my-org/.*\"\n    max_recycled: 0  # 0 = unlimited\n```\n\n**Default:** 5 sessions per repository\n\n**Precedence:**\n1. Last matching rule with `max_recycled` set wins\n2. Falls back to global `max_recycled` if no rule matches or sets it\n3. `nil`/unset = inherit from parent; at global level = 5 (default)\n4. `0` = explicitly unlimited (overrides any inherited limit)\n\n## Implementation\n\n### 1. Add Config Fields\n\n**File:** internal/core/config/config.go\n\nAdd MaxRecycled *int to Config struct (line ~48)\nAdd MaxRecycled *int to Rule struct (line ~83)\nUpdate DefaultConfig() to set default of 5\nAdd GetMaxRecycled(remote string) helper method\n\n### 2. Add Validation\n\n**File:** internal/core/config/validate.go\n\nValidate max_recycled \u003e= 0 (negative values invalid)\nAdd to both global config validation and per-rule validation\n\n### 3. Add Enforcement in RecycleSession\n\n**File:** internal/hive/service.go\n\nAdd enforceMaxRecycled() helper method\nCall from RecycleSession() after saving (line ~234)\n\n### 4. Update Prune Command\n\n**File:** internal/commands/cmd_prune.go\n\nAdd --all flag:\n- Without flag: Respect max_recycled per repo (keep newest N, delete rest)\n- With --all: Delete ALL recycled sessions (current behavior)\n\n**File:** internal/hive/service.go\n\nUpdate Prune() signature to accept all bool parameter\n\n### 5. Add Tests\n\n- internal/core/config/config_test.go - Test GetMaxRecycled() precedence\n- internal/hive/service_test.go - Test enforceMaxRecycled() and updated Prune()\n\n### 6. Update Documentation\n\n**File:** README.md\n\nDocument configuration syntax and default (5), precedence rules, special value meanings, and prune command with --all flag\n\n## Verification\n\n1. Run task test - all existing tests pass\n2. Create config with max_recycled: 2\n3. Create and recycle 3+ sessions for same repo\n4. Verify oldest recycled sessions are deleted when limit exceeded\n5. Test per-rule override works correctly\n6. Test hive prune keeps newest N per repo\n7. Test hive prune --all deletes everything (old behavior)","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:57:01.683721-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:09:12.791043-06:00","closed_at":"2026-01-31T10:09:12.791043-06:00","close_reason":"Closed"}
{"id":"hive-8i9.1","title":"Add MaxRecycled config fields","description":"Add MaxRecycled *int to Config and Rule structs in internal/core/config/config.go. Update DefaultConfig() to set default of 5. Add GetMaxRecycled(remote string) helper method for precedence resolution.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:58:37.471978-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:04:32.127609-06:00","closed_at":"2026-01-31T10:04:32.127609-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-8i9.1","depends_on_id":"hive-8i9","type":"parent-child","created_at":"2026-01-31T09:58:37.473997-06:00","created_by":"Hayden"}]}
{"id":"hive-8i9.2","title":"Add MaxRecycled validation","description":"Add validation in internal/core/config/validate.go to ensure max_recycled \u003e= 0 for both global config and per-rule values.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:58:40.340336-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:04:56.599156-06:00","closed_at":"2026-01-31T10:04:56.599156-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-8i9.2","depends_on_id":"hive-8i9","type":"parent-child","created_at":"2026-01-31T09:58:40.341939-06:00","created_by":"Hayden"},{"issue_id":"hive-8i9.2","depends_on_id":"hive-8i9.1","type":"blocks","created_at":"2026-01-31T09:59:07.249411-06:00","created_by":"Hayden"}]}
{"id":"hive-8i9.3","title":"Add enforceMaxRecycled in RecycleSession","description":"Add enforceMaxRecycled() helper method in internal/hive/service.go. Call from RecycleSession() after saving to delete oldest recycled sessions when limit exceeded.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:58:53.739993-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:05:46.948059-06:00","closed_at":"2026-01-31T10:05:46.948059-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-8i9.3","depends_on_id":"hive-8i9","type":"parent-child","created_at":"2026-01-31T09:58:53.741307-06:00","created_by":"Hayden"},{"issue_id":"hive-8i9.3","depends_on_id":"hive-8i9.1","type":"blocks","created_at":"2026-01-31T09:59:07.356716-06:00","created_by":"Hayden"}]}
{"id":"hive-8i9.4","title":"Update Prune command with --all flag","description":"Add --all flag to internal/commands/cmd_prune.go. Update Prune() signature in service.go to accept all bool. Without flag: respect max_recycled per repo. With --all: delete ALL (current behavior).","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:58:55.706035-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:06:35.335895-06:00","closed_at":"2026-01-31T10:06:35.335895-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-8i9.4","depends_on_id":"hive-8i9","type":"parent-child","created_at":"2026-01-31T09:58:55.707337-06:00","created_by":"Hayden"},{"issue_id":"hive-8i9.4","depends_on_id":"hive-8i9.3","type":"blocks","created_at":"2026-01-31T09:59:07.463322-06:00","created_by":"Hayden"}]}
{"id":"hive-8i9.5","title":"Add tests for max_recycled feature","description":"Add tests in internal/core/config/config_test.go for GetMaxRecycled() precedence. Add tests in internal/hive/service_test.go for enforceMaxRecycled() and updated Prune().","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:58:57.886255-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:08:19.736374-06:00","closed_at":"2026-01-31T10:08:19.736374-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-8i9.5","depends_on_id":"hive-8i9","type":"parent-child","created_at":"2026-01-31T09:58:57.887418-06:00","created_by":"Hayden"},{"issue_id":"hive-8i9.5","depends_on_id":"hive-8i9.3","type":"blocks","created_at":"2026-01-31T09:59:07.567864-06:00","created_by":"Hayden"},{"issue_id":"hive-8i9.5","depends_on_id":"hive-8i9.4","type":"blocks","created_at":"2026-01-31T09:59:07.67728-06:00","created_by":"Hayden"}]}
{"id":"hive-8i9.6","title":"Document max_recycled configuration","description":"Update README.md to document: configuration syntax and default (5), precedence rules, special value meanings (nil, 0, \u003e0), and prune command --all flag.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:58:59.619218-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:09:09.24869-06:00","closed_at":"2026-01-31T10:09:09.24869-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-8i9.6","depends_on_id":"hive-8i9","type":"parent-child","created_at":"2026-01-31T09:58:59.620391-06:00","created_by":"Hayden"},{"issue_id":"hive-8i9.6","depends_on_id":"hive-8i9.5","type":"blocks","created_at":"2026-01-31T09:59:07.784268-06:00","created_by":"Hayden"}]}
{"id":"hive-8n0","title":"Integrate new session form into TUI model","description":"Modify internal/tui/model.go\n\n## State\n- Add stateCreatingSession to UIState enum\n- Add newSessionForm *NewSessionForm to Model\n- Add discoveredRepos []DiscoveredRepo to Model\n\n## Key Handler\n- Intercept 'n' in handleSessionsKey()\n- Only respond if discoveredRepos is non-empty\n- Create form with auto-selection from selected session or localRemote\n\n## Form Flow\n- Route messages to form when in stateCreatingSession\n- On submit: call Service.CreateSession(), reload sessions\n- On cancel: return to stateNormal\n\n## Help\n- Add 'n' keybinding to AdditionalShortHelpKeys (only if repos discovered)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T19:21:36.300083-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:33:48.65353-06:00","closed_at":"2026-01-30T19:33:48.65353-06:00","close_reason":"Integrated new session form into TUI model with n key handler and form state management","dependencies":[{"issue_id":"hive-8n0","depends_on_id":"hive-5eb","type":"blocks","created_at":"2026-01-30T19:21:41.364591-06:00","created_by":"Hayden"},{"issue_id":"hive-8n0","depends_on_id":"hive-ewh","type":"parent-child","created_at":"2026-01-30T19:21:45.909894-06:00","created_by":"Hayden"}]}
{"id":"hive-8nf","title":"Add TUI loop with pending action handling","description":"Wrap the TUI program in a loop that checks for pending actions after exit and restarts.\n\n## Changes to internal/commands/cmd_tui.go\n\nReplace the current run() implementation with a loop:\n\n```go\nfunc (cmd *TuiCmd) run(ctx context.Context, _ *cli.Command) error {\n    localRemote, _ := cmd.flags.Service.DetectRemote(ctx, \".\")\n    topicsDir := filepath.Join(cmd.flags.DataDir, \"messages\", \"topics\")\n    msgStore := jsonfile.NewMsgStore(topicsDir)\n\n    for {\n        opts := tui.Options{\n            LocalRemote: localRemote,\n            MsgStore:    msgStore,\n        }\n\n        m := tui.New(cmd.flags.Service, cmd.flags.Config, opts)\n        p := tea.NewProgram(m, tea.WithAltScreen())\n\n        finalModel, err := p.Run()\n        if err != nil {\n            return fmt.Errorf(\"run tui: %w\", err)\n        }\n\n        model := finalModel.(tui.Model)\n\n        // Handle pending session creation\n        if pending := model.PendingCreate(); pending != nil {\n            source, _ := os.Getwd()\n            _, err := cmd.flags.Service.CreateSession(ctx, hive.CreateOptions{\n                Name:   pending.Name,\n                Remote: pending.Remote,\n                Source: source,\n            })\n            if err != nil {\n                fmt.Printf(\"Error creating session: %v\\n\", err)\n                fmt.Println(\"Press Enter to continue...\")\n                fmt.Scanln()\n            }\n            continue // Restart TUI\n        }\n\n        break // Normal exit\n    }\n    return nil\n}\n```\n\nRequires adding imports: \"os\", \"fmt\", \"github.com/hay-kot/hive/internal/hive\"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T21:20:10.471128-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:30:27.369007-06:00","closed_at":"2026-01-30T21:30:27.369007-06:00","close_reason":"Added TUI loop in cmd_tui.go that handles pending session creation and restarts TUI","dependencies":[{"issue_id":"hive-8nf","depends_on_id":"hive-kyp","type":"blocks","created_at":"2026-01-30T21:20:27.648746-06:00","created_by":"Hayden"}]}
{"id":"hive-9i7","title":"Remove SkipSpawn and clean up unused code","description":"Remove the SkipSpawn option and clean up code that's no longer needed.\n\n## Changes to internal/hive/service.go\n\n1. Remove SkipSpawn field from CreateOptions:\n```go\ntype CreateOptions struct {\n    Name          string\n    Prompt        string\n    Remote        string\n    Source        string\n    UseBatchSpawn bool\n    // SkipSpawn removed\n}\n```\n\n2. Revert the spawn condition back to original:\n```go\nif len(spawnCommands) \u003e 0 {\n    // ... spawn logic\n}\n```\n\n## Changes to internal/tui/model.go\n\n1. Remove createSession() method (no longer needed)\n2. Remove sessionCreatedMsg type (no longer needed)\n3. Remove the sessionCreatedMsg case in Update()","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T21:20:14.633515-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:31:46.291172-06:00","closed_at":"2026-01-30T21:31:46.291172-06:00","close_reason":"Removed SkipSpawn from CreateOptions, cleaned up unused createSession method and sessionCreatedMsg type","dependencies":[{"issue_id":"hive-9i7","depends_on_id":"hive-8nf","type":"blocks","created_at":"2026-01-30T21:20:27.738902-06:00","created_by":"Hayden"}]}
{"id":"hive-an2","title":"Update Service.CreateSession to use BatchSpawn for batch","description":"Modify CreateSession to accept a flag or use a different method for batch spawning.\n\nOptions:\n1. Add UseBatchSpawn bool to CreateOptions\n2. Create separate CreateBatchSession method\n3. Pass spawn commands directly\n\nThe batch code path should use config.Commands.BatchSpawn if set, otherwise fall back to config.Commands.Spawn.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:37.659862-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:23:18.073117-06:00","closed_at":"2026-01-30T13:23:18.073117-06:00","close_reason":"Added UseBatchSpawn to CreateOptions and updated CreateSession to use batch_spawn commands","dependencies":[{"issue_id":"hive-an2","depends_on_id":"hive-l87","type":"blocks","created_at":"2026-01-30T13:19:48.014768-06:00","created_by":"Hayden"},{"issue_id":"hive-an2","depends_on_id":"hive-4fk","type":"blocks","created_at":"2026-01-30T13:19:48.071771-06:00","created_by":"Hayden"}]}
{"id":"hive-aru","title":"Update navigation for tree structure","description":"Update keyboard navigation to work with tree structure. Repo headers are focusable but have no actions yet. Session actions remain unchanged. Selected row gets color highlight.","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:38:09.796101-06:00","created_by":"Hayden","updated_at":"2026-01-30T16:57:40.819318-06:00","closed_at":"2026-01-30T16:57:40.819318-06:00","close_reason":"Navigation already works correctly. Headers are focusable (TreeItems in list), have no actions (selectedSession returns nil), sessions retain actions, and selection highlighting applies to both via isSelected check in renderHeader/renderSession.","dependencies":[{"issue_id":"hive-aru","depends_on_id":"hive-6n8","type":"blocks","created_at":"2026-01-30T16:38:24.912781-06:00","created_by":"Hayden"}]}
{"id":"hive-b5n","title":"Remove toggle all option, show all sessions by default","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:20.649257-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:07:58.571856-06:00","closed_at":"2026-01-30T17:07:58.571856-06:00","close_reason":"Removed showAll and hideRecycled toggles. All sessions now display by default. Removed 'a' and 'x' keybindings."}
{"id":"hive-b7o","title":"Add command to generate random topic IDs for LLMs","description":"## Summary\nProvide a way for LLMs to get a random topic ID in the format `agent.\u003cid\u003e`.\n\n## Use Case\nWhen an LLM agent wants to start a new messaging topic, it currently needs to generate a random ID itself using shell commands. This should be a first-class hive command.\n\n## Proposed Solution\nAdd a command like:\n```bash\nhive msg new-topic\n# Output: agent.x7k2\n```\n\nOr integrate into existing commands:\n```bash\nhive msg topic --new\n```\n\n## Requirements\n- Generate random 4-character alphanumeric ID\n- Output in format `agent.\u003cid\u003e`\n- Ensure uniqueness (check against existing topics if possible)","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T14:43:58.272038-06:00","created_by":"Hayden","updated_at":"2026-01-31T19:48:44.725052-06:00","closed_at":"2026-01-31T16:47:10.985099-06:00"}
{"id":"hive-bed","title":"Fix layout shift between sessions and messages views","description":"When switching between Sessions and Messages tabs, there is a layout shift. The Hive banner and tab bar move positions.\n\n## Expected\n- Banner and tab bar remain fixed in exactly the same position on every view\n- Only the content area below the tabs should change","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:54:07.287005-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:58:21.495601-06:00","closed_at":"2026-01-30T15:58:21.495601-06:00","close_reason":"Fixed all four layout issues: removed duplicate headers, moved session state to tab bar, fixed layout shift by removing per-view titles, pinned help to bottom, and added column headers to messages table."}
{"id":"hive-c02","title":"Improve active pane visual distinction in TUI","description":"The current focus indicator (▸ and bold title) is too subtle. Users accidentally press enter on the wrong pane.\n\nOptions to explore:\n- Add a colored border around the focused pane\n- Dim/fade the unfocused pane content\n- Use a more prominent focus indicator\n- Add a background tint to the focused pane header\n\nShould work in both split mode and tab mode.","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:53:45.826314-06:00","created_by":"Hayden","updated_at":"2026-01-30T14:26:04.92571-06:00","closed_at":"2026-01-30T14:26:04.92571-06:00","close_reason":"Added rounded borders to distinguish active pane: blue border for focused pane, dark gray border for unfocused. Removed old vertical divider in favor of gap between bordered panes."}
{"id":"hive-cdw","title":"Define core messaging types and store interface","description":"Create the foundational types for the messaging system:\n\n- Message struct with ID, Topic, Payload, Sender, CreatedAt fields\n- Topic struct with Name, Messages slice, UpdatedAt\n- Store interface with Publish, Subscribe, List, Prune methods\n\nLocation: internal/core/messaging/\n\nThis establishes the contract before implementing storage or CLI.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:05:42.503772-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:19:10.639495-06:00","closed_at":"2026-01-29T20:19:10.639495-06:00","close_reason":"Created Message, Topic structs and Store interface in internal/core/messaging/"}
{"id":"hive-clm","title":"Copy content normalization for stable hashing","description":"Copy content normalization from agent-deck/internal/tmux/tmux.go:2162-2212\n\nNormalization steps:\n1. Strip ANSI escape codes\n2. Strip spinner characters (braille + asterisk)\n3. Replace status counters `(45s · 1234 tokens)` with `(STATUS)`\n4. Replace whimsical word patterns with placeholder\n5. Replace spinner+ellipsis patterns with `THINKING…`\n6. Replace progress bars `[====\u003e   ] 45%`\n7. Replace timestamps, percentages, download progress\n8. Trim trailing whitespace per line\n9. Collapse multiple blank lines\n\nThis prevents false hash changes from dynamic content that doesn't represent real activity.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:49:24.28469-06:00","created_by":"Hayden","updated_at":"2026-01-31T18:56:56.866175-06:00","closed_at":"2026-01-31T18:56:56.866175-06:00","close_reason":"Added dynamicStatusPattern, progressBarPattern, thinkingPatternEllipsis patterns to NormalizeContent. Now normalizes: status counters (45s · 1234 tokens), progress bars [====\u003e], thinking spinner patterns, download progress, percentages, time patterns."}
{"id":"hive-cn8","title":"Agent Messaging Conventions","description":"# Agent Messaging Conventions\n\nImplement standardized messaging conventions for hive to enable reliable inter-agent communication.\n\n## Design Decisions\n\n### Session ID\n- User-provided OR auto-generated\n- Validation: alphanumeric, no spaces\n- Can be seeded in batch files\n\n### Inbox Convention\n- Pattern: `agent.{session-id}.inbox`\n- Auto-created on session spawn (or first use)\n- Standard location for handoffs and messages to specific agents\n\n### Read Tracking\n- Store `last_inbox_read` timestamp in Session struct (sessions.json)\n- Auto-update when agent subscribes to their own inbox (auto-detect by matching session ID)\n- \"Unread\" = messages where `created_at \u003e last_inbox_read`\n- No per-message read state needed\n\n### Discovery\n- Extend `hive ls` with `--json` flag for LLM-friendly output\n- Include: id, name, repo, inbox, last_active, state, unread count\n- Cross-reference with inbox topics for activity\n\n### Command Enhancements\n- `hive msg sub --new`: only messages since last read\n- `hive ls --json`: JSON output with inbox + last_active\n\n## Work Split\n\n**This epic (402h5p agent):**\n- Session ID validation\n- Batch seeding\n- Read tracking logic\n- `hive msg sub --new` flag\n- `hive ls --json` enhancement\n\n**Parallel work (4uqf30 agent):**\n- Tree view animations for pub/sub\n- `hive session info` command\n- Visual distinction for inbox topics\n- Display based on `last_inbox_read` (after this epic ships)\n\n## Dependencies\n- Other agent's display work depends on `last_inbox_read` field being added","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-31T16:44:24.43718-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:59:44.817761-06:00","closed_at":"2026-01-31T16:59:44.817761-06:00","close_reason":"All child tasks complete: session ID validation, batch seeding, read tracking, --new flag, --json output, and messaging docs"}
{"id":"hive-cn8.1","title":"Add session ID validation","description":"Add validation for session IDs to ensure consistent format:\n- Alphanumeric characters only\n- No spaces\n- Works for both user-provided and auto-generated IDs\n- Apply to `hive new` and `hive batch` commands","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T16:44:28.537025-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:58:17.243311-06:00","closed_at":"2026-01-31T16:58:17.243311-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-cn8.1","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:44:28.539073-06:00","created_by":"Hayden"}]}
{"id":"hive-cn8.2","title":"Add batch seeding for session_id","description":"Allow session_id to be specified in batch JSON:\n\n```json\n{\n  \"sessions\": [\n    {\"name\": \"feature-work\", \"session_id\": \"abc123\", \"prompt\": \"...\"}\n  ]\n}\n```\n\n- Validate provided session_id using new validation rules\n- Auto-generate if not provided\n- Enables coordinated multi-agent spawning with known IDs","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T16:44:31.458749-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:59:38.448813-06:00","closed_at":"2026-01-31T16:59:38.448813-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-cn8.2","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:44:31.459671-06:00","created_by":"Hayden"},{"issue_id":"hive-cn8.2","depends_on_id":"hive-cn8.1","type":"blocks","created_at":"2026-01-31T16:44:50.165804-06:00","created_by":"Hayden"}]}
{"id":"hive-cn8.3","title":"Add last_inbox_read to Session struct","description":"Add read tracking infrastructure:\n\n1. Add `LastInboxRead time.Time` field to Session struct\n2. Update sessions.json schema\n3. Add helper method to check if session has unread messages\n4. Derive inbox topic name: `agent.{session-id}.inbox`\n\nThis unblocks the other agent's display work.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-31T16:44:34.193339-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:48:34.973433-06:00","closed_at":"2026-01-31T16:48:34.973433-06:00","close_reason":"Added LastInboxRead field, InboxTopic() and UpdateLastInboxRead() methods with tests","dependencies":[{"issue_id":"hive-cn8.3","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:44:34.194116-06:00","created_by":"Hayden"}]}
{"id":"hive-cn8.4","title":"Auto-update last_inbox_read on own inbox sub","description":"When an agent subscribes to their own inbox, auto-update the timestamp:\n\n1. Detect current session ID (from hive session context)\n2. When `hive msg sub -t agent.{id}.inbox` is called\n3. If topic matches own inbox pattern, update `last_inbox_read`\n4. Persist to sessions.json\n\nAuto-detection logic:\n- Extract session ID from inbox topic pattern\n- Compare with current session ID\n- Only update if they match","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T16:44:39.880389-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:49:59.334799-06:00","closed_at":"2026-01-31T16:49:59.334799-06:00","close_reason":"Auto-update LastInboxRead when subscribing to own inbox in all sub modes (immediate, listen, wait)","dependencies":[{"issue_id":"hive-cn8.4","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:44:39.881171-06:00","created_by":"Hayden"},{"issue_id":"hive-cn8.4","depends_on_id":"hive-cn8.3","type":"blocks","created_at":"2026-01-31T16:44:50.261355-06:00","created_by":"Hayden"}]}
{"id":"hive-cn8.5","title":"Add hive msg sub --new flag","description":"Add --new flag to filter messages since last read:\n\n```bash\nhive msg sub -t agent.402h5p.inbox --new   # Only unread messages\nhive msg sub -t agent.402h5p.inbox         # All messages (default)\n```\n\nImplementation:\n- Check `last_inbox_read` timestamp for matching session\n- Filter messages where `created_at \u003e last_inbox_read`\n- Works with the read tracking auto-update","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T16:44:42.708659-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:51:26.779785-06:00","closed_at":"2026-01-31T16:51:26.779785-06:00","close_reason":"Added --new flag to filter messages since last inbox read","dependencies":[{"issue_id":"hive-cn8.5","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:44:42.709571-06:00","created_by":"Hayden"},{"issue_id":"hive-cn8.5","depends_on_id":"hive-cn8.4","type":"blocks","created_at":"2026-01-31T16:44:50.380372-06:00","created_by":"Hayden"}]}
{"id":"hive-cn8.6","title":"Add hive ls --json with inbox info","description":"Enhance hive ls for LLM-friendly output:\n\n```bash\n$ hive ls --json\n{\"id\":\"4uqf30\",\"name\":\"msg-tracking\",\"repo\":\"hive\",\"inbox\":\"agent.4uqf30.inbox\",\"last_active\":\"2026-01-31T16:30:00Z\",\"state\":\"active\",\"unread\":3}\n```\n\nFields:\n- id: session ID\n- name: session name\n- repo: repository name\n- inbox: derived inbox topic name\n- last_active: last_inbox_read timestamp\n- state: active/recycled\n- unread: count of messages since last_inbox_read (optional)\n\nOutput as JSON lines (one object per line) for easy parsing.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T16:44:46.722569-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:53:04.492081-06:00","closed_at":"2026-01-31T16:53:04.492081-06:00","close_reason":"Added --json flag to hive ls with inbox topic and unread count","dependencies":[{"issue_id":"hive-cn8.6","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:44:46.723283-06:00","created_by":"Hayden"},{"issue_id":"hive-cn8.6","depends_on_id":"hive-cn8.3","type":"blocks","created_at":"2026-01-31T16:44:50.465096-06:00","created_by":"Hayden"}]}
{"id":"hive-cn8.7","title":"Add hive doc messaging command for LLM guidance","description":"Add a `hive doc messaging` (or `hive doc inbox`) command that outputs documentation for LLMs on messaging conventions.\n\n## Output should explain:\n\n### Identity\n- Your session ID is available via `hive session info`\n- Your inbox topic is `agent.{session-id}.inbox`\n\n### Checking your inbox\n```bash\nhive msg sub -t agent.{id}.inbox --new   # Unread messages only\nhive msg sub -t agent.{id}.inbox         # All messages\n```\n\n### Sending to another agent\n```bash\n# Find agents\nhive ls --json\n\n# Send to their inbox\nhive msg pub -t agent.{their-id}.inbox \"message\"\n```\n\n### Conventions\n- Check inbox on startup for handoffs\n- Use inbox for direct agent-to-agent communication\n- Use custom topics for broadcast/pub-sub patterns\n- Include context in messages (what you're working on, what you need)\n\n### Message format suggestions\n- JSON for structured data\n- Markdown for human-readable handoffs\n- Include your session ID for reply routing\n\n## Implementation\n- Add to `cmd_doc.go` similar to `hive doc migrate`\n- Output as markdown for easy reading\n- Consider `--json` flag for machine-readable format","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T16:46:21.69152-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:58:17.261877-06:00","closed_at":"2026-01-31T16:58:17.261877-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-cn8.7","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:46:21.69411-06:00","created_by":"Hayden"},{"issue_id":"hive-cn8.7","depends_on_id":"hive-cn8.6","type":"blocks","created_at":"2026-01-31T16:46:25.560926-06:00","created_by":"Hayden"}]}
{"id":"hive-cxn","title":"Sort sessions with active before recycled","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:21.31874-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:08:32.815401-06:00","closed_at":"2026-01-30T17:08:32.815401-06:00","close_reason":"Updated sortSessions to sort active sessions before recycled, then by name."}
{"id":"hive-d98","title":"Implement global JSON file message store","description":"Implement the messaging Store interface using per-topic JSON files:\n\n- Storage location: $XDG_DATA_HOME/hive/messages/topics/{topic}.json\n- Reuse file locking pattern from kvstore.go (in-process mutex + flock)\n- Atomic writes via temp file + rename\n- Count-based retention: enforce max messages per topic on write (default 100)\n- Support topic wildcards for Subscribe (e.g., agent.* matches agent.build, agent.test)\n- Support subscribing to all topics when no pattern specified\n\nLocation: internal/store/jsonfile/msgstore.go","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.073644-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:23:45.952299-06:00","closed_at":"2026-01-29T20:23:45.952299-06:00","close_reason":"Implemented MsgStore with per-topic JSON files, file locking, atomic writes, count-based retention (default 100), and wildcard topic patterns","dependencies":[{"issue_id":"hive-d98","depends_on_id":"hive-cdw","type":"blocks","created_at":"2026-01-29T20:08:24.370052-06:00","created_by":"Hayden"}]}
{"id":"hive-djp","title":"Remove session count from repo headers","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:20.847234-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:10:05.101973-06:00","closed_at":"2026-01-30T17:10:05.101973-06:00","close_reason":"Removed session count from repo headers. Removed TotalCount/RecycledCount fields from TreeItem and HeaderCount style."}
{"id":"hive-dm5","title":"Research TUI focus indicator design options","description":"The current focus indicator (▸ and bold title) is too subtle - users accidentally press enter on the wrong pane.\n\n## Failed Approaches\n1. **Bordered panes** - Added rounded borders around focused pane. Removed header layout, looked cluttered.\n2. **Background tint on header** - Added blue background behind focused header text. Looked awful.\n\n## Research Needed\nLook at other TUI applications for inspiration on how they handle split pane focus:\n- lazygit\n- k9s\n- btop/htop\n- lazydocker\n- Other Bubble Tea apps\n\n## Possible Options to Explore\n- Different indicator symbols or positioning\n- Underline the focused header\n- Color the divider line based on which side is focused\n- Subtle highlight on selected list items only in focused pane\n- Different approach entirely?\n\n## User Feedback Requested\nWhat visual style would you prefer? Please add notes with examples or preferences.","notes":"## Research Findings\n\n### How Popular TUIs Handle Focus Indication\n\n#### 1. Lazygit / Lazydocker\n- **Bright blue border** around the focused pane (lazygotest confirms: 'highlighted with a bright blue border')\n- **Highlighted/brighter text** for active items\n- Very consistent visual language across all panels\n- Navigation: Tab to cycle, h/l or arrows to switch panes, number keys (1-5) for direct access\n\n#### 2. K9s (Kubernetes TUI)\n- Uses **configurable focus colors** via skins\n- Key styling properties: `focusColor`, `cursorColor`, `highlightColor`\n- Border has separate `fgColor` and `focusColor` \n- Allows full theme customization\n\n#### 3. btop/htop\n- **Color-coded sections** with distinct visual hierarchy\n- **Highlighted keys** are clickable/interactive\n- Relies more on section differentiation than active/inactive states\n- Uses ASCII art and Unicode for visual clarity\n\n#### 4. Tmux (Reference Pattern)\n- **Colorizes separators/dividers** adjacent to active pane\n- Inactive panes can be 'slightly greyed'\n- Active pane border set to distinct color (commonly blue)\n- Windows Terminal adopted similar approach\n\n### Bubble Tea / Lip Gloss Patterns\n\n#### Built-in Focus Support\n- `EnableReportFocus` for terminal focus events\n- Bubbles library has `Style struct` with focused/unfocused states\n- Common pattern: conditional style application based on focus state\n\n#### Border Options Available\n- `lipgloss.NormalBorder()` - standard\n- `lipgloss.ThickBorder()` - heavier weight\n- `lipgloss.DoubleBorder()` - double-line\n- `lipgloss.HiddenBorder()` - invisible (useful for unfocused to maintain alignment)\n- `BorderForeground()` to colorize\n\n### Design Options to Consider\n\nBased on research, here are the most viable approaches:\n\n#### Option A: Colored Divider (tmux-style)\nChange the vertical divider color based on which pane is focused:\n- Left focused: divider colored on right side or entire divider blue\n- Right focused: divider colored on left side\n- Subtle but effective in terminals\n\n#### Option B: Border Accent (lazygit-style)\nAdd a border to the focused pane only:\n- Focused: visible border (blue/accent color)\n- Unfocused: hidden border (maintains spacing)\n- Clear visual distinction\n\n#### Option C: Title Underline\nUnderline the focused pane title:\n- Less intrusive than borders\n- Clear indication of which pane\n- Works well with existing arrow indicator\n\n#### Option D: Dimmed Unfocused Pane\nDim/grey out the unfocused pane content:\n- Focused: normal colors\n- Unfocused: faded/dimmed colors\n- Common in IDEs (inactive panels)\n\n#### Option E: Selected Item Differentiation\nOnly show selection indicator in focused pane:\n- Active pane: blue bar on selected item\n- Inactive pane: no selection bar shown\n- User sees which pane can receive input\n\n### Recommendation\n\n**Option A (Colored Divider)** is the most elegant solution:\n1. Minimal visual clutter\n2. Proven pattern (tmux, Windows Terminal)\n3. Easy to implement with lipgloss\n4. Works with existing arrow + bold title indicators\n\nImplementation would be:\n```go\n// In renderSplitView\nvar dividerColor lipgloss.Color\nif m.focusedPane == PaneSessions {\n    dividerColor = colorBlue  // Blue when left focused (divider 'points' right)\n} else {\n    dividerColor = colorBlue  // Blue when right focused\n}\ndivider := lipgloss.NewStyle().\n    Foreground(dividerColor).\n    Render(strings.Repeat(\"│\", contentHeight))\n```\n\nOr **Option E** could complement this - only showing the selection bar (┃) in the focused pane.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T14:35:02.81949-06:00","created_by":"Hayden","updated_at":"2026-01-30T14:39:10.487747-06:00","closed_at":"2026-01-30T14:39:10.487747-06:00","close_reason":"Research complete. Documented findings from lazygit, k9s, btop, lazydocker, and tmux. Recommended colored divider approach (Option A) as primary solution."}
{"id":"hive-ein","title":"Add StateTracker for terminal status with acknowledgment","description":"Add StateTracker to terminal integration that:\n- Tracks last content hash to detect changes\n- Remembers acknowledged state (user has seen waiting status)\n- Transitions: active (content changing) → waiting (stable, unacknowledged) → idle (acknowledged)\n- Prevents flickering by requiring sustained state before transition\n\nReference Agent Deck's StateTracker implementation in internal/tmux/tmux.go","status":"tombstone","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:42:43.003463-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:46:33.324447-06:00","deleted_at":"2026-01-31T17:46:33.324447-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"hive-ejn","title":"Add repo_dirs config field","description":"Add RepoDirs []string field to Config struct in internal/core/config/config.go\n\n- Field name: RepoDirs\n- YAML key: repo_dirs\n- Type: []string (list of directory paths)\n- No default value - empty means feature is disabled\n- No validation required beyond normal YAML parsing","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T19:21:24.198566-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:26:51.227143-06:00","closed_at":"2026-01-30T19:26:51.227143-06:00","close_reason":"Added RepoDirs []string field to Config struct","dependencies":[{"issue_id":"hive-ejn","depends_on_id":"hive-ewh","type":"parent-child","created_at":"2026-01-30T19:21:45.729412-06:00","created_by":"Hayden"}]}
{"id":"hive-ev5","title":"Add TUIConfig with refresh_interval to config","description":"Add a new TUIConfig struct to internal/core/config/config.go with a RefreshInterval field.\n\n```go\ntype TUIConfig struct {\n    RefreshInterval time.Duration `yaml:\"refresh_interval\"`\n}\n```\n\nAdd TUI field to main Config struct. Default: 15 seconds.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T23:25:51.400506-06:00","created_by":"Hayden","updated_at":"2026-01-30T23:32:17.239267-06:00","closed_at":"2026-01-30T23:32:17.239267-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-ev5","depends_on_id":"hive-0tq","type":"parent-child","created_at":"2026-01-30T23:26:20.569795-06:00","created_by":"Hayden"}]}
{"id":"hive-ewh","title":"New Session Dialog for Sessions TUI","description":"Add a dialog triggered by 'n' key in the Sessions TUI that allows creating a new session from any repository on the system. Uses a repo_dirs config setting to discover available repositories.\n\n## Requirements\n- Add repo_dirs config field - list of directories containing git repositories\n- Press 'n' key triggers a new session dialog\n- Dialog uses Huh forms with searchable repository selector and session name input\n- Smart auto-selection: If user is viewing a session in tree view, pre-select that repository\n- After form submission, call Service.CreateSession()\n- When repo_dirs is empty, disable the feature (hide keybinding)","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-30T19:21:18.899905-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:33:49.421095-06:00","closed_at":"2026-01-30T19:33:49.421095-06:00","close_reason":"Completed all child tasks for new session dialog"}
{"id":"hive-faq","title":"Explore column-aligned session fields like a table","description":"Investigate aligning session fields (name, branch, ID, git status) into columns so they line up vertically across sessions, similar to a table layout.","status":"closed","priority":4,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T17:18:36.240683-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:45:45.219378-06:00","closed_at":"2026-01-30T17:45:45.219378-06:00","close_reason":"Implemented column alignment for session names. Added ColumnWidths pointer to delegate for dynamic updates. Name column is now padded to align IDs across sessions."}
{"id":"hive-fhz","title":"Copy GetStatus state machine logic","description":"Copy the GetStatus logic from agent-deck/internal/tmux/tmux.go:1440-1696\n\nKey logic to copy:\n1. Session existence check\n2. Activity timestamp retrieval and caching\n3. Busy indicator check with 25-line window (not 5)\n4. Prompt indicator check with priority over busy\n5. Spike detection (2+ changes in 1 second window)\n6. Grace period before leaving active state\n7. Acknowledged state check for idle vs waiting\n8. Content normalization for stable hashing\n\nState transitions:\n- busy indicator + no prompt → active\n- prompt detected → waiting\n- no busy, acknowledged → idle  \n- no busy, not acknowledged → waiting","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:46:53.650116-06:00","created_by":"Hayden","updated_at":"2026-01-31T18:58:32.343575-06:00","closed_at":"2026-01-31T18:58:32.343575-06:00","close_reason":"GetStatus state machine implemented: 15-line window for detection, spike detection (2+ changes in 1s), acknowledged state for idle vs waiting, state transitions reset acknowledged on busy/prompt. Integration captures pane content and uses StateTracker.Update() for detection.","dependencies":[{"issue_id":"hive-fhz","depends_on_id":"hive-nrs","type":"blocks","created_at":"2026-01-31T18:47:15.895567-06:00","created_by":"Hayden"},{"issue_id":"hive-fhz","depends_on_id":"hive-r58","type":"blocks","created_at":"2026-01-31T18:47:15.987524-06:00","created_by":"Hayden"},{"issue_id":"hive-fhz","depends_on_id":"hive-clm","type":"blocks","created_at":"2026-01-31T18:49:37.688234-06:00","created_by":"Hayden"}]}
{"id":"hive-g4d","title":"Add subtle column headers to messages table view","description":"The messages table view should have subtle column headers to define each column.\n\n## Layout\n```\nTime     Topic      Message                              Sender\n────────────────────────────────────────────────────────────────\n14:32:01 [orders  ] New order received #12849...    api-gateway\n```\n\n## Requirements\n- Headers should be dimmed/gray to not compete with content\n- Use same column widths as the data rows\n- Consider a subtle separator line or just spacing","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:54:08.296689-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:58:21.532486-06:00","closed_at":"2026-01-30T15:58:21.532486-06:00","close_reason":"Fixed all four layout issues: removed duplicate headers, moved session state to tab bar, fixed layout shift by removing per-view titles, pinned help to bottom, and added column headers to messages table."}
{"id":"hive-gmj","title":"Research charm markdown rendering (glamour)","description":"Investigate glamour library for rendering markdown in the TUI message preview modal.\n\nResearch:\n- How to integrate glamour with bubbles/lipgloss\n- Styling options and terminal compatibility\n- How to render markdown within a modal/viewport\n- Check if glamour is already a dependency or needs adding\n- Look at existing modal patterns in the codebase (OutputModal, Modal)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:32:04.363416-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:40:37.370189-06:00","closed_at":"2026-01-30T13:40:37.370189-06:00","close_reason":"Research complete. Glamour v2 needed as new dependency. Use tokyo-night style to match existing colors. Viewport bubble for scrollable content. See .hive/research/glamour-markdown-rendering.md"}
{"id":"hive-gvj","title":"Call Acknowledge from TUI when user views session","description":"When user interacts with a session in the TUI, call Acknowledge() to transition it from waiting (yellow) to idle (gray).\n\nTrigger points:\n- User opens/selects a session in the tree view\n- User focuses on a session's terminal output\n- User sends input to a session\n\nThis completes the feedback loop:\n1. Session finishes → waiting (yellow)\n2. User views session → Acknowledge() called → idle (gray)\n3. New activity → ResetAcknowledged() → back to waiting if needed","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:47:07.268839-06:00","created_by":"Hayden","updated_at":"2026-01-31T19:02:09.191078-06:00","closed_at":"2026-01-31T19:02:09.191078-06:00","close_reason":"Added acknowledgeSession() tea.Cmd in terminalstatus.go. Updated model.go to track lastAcknowledgedID and call acknowledge when user navigates to a different session. Added acknowledgeSessionMsg handler in Update() to consume the message.","dependencies":[{"issue_id":"hive-gvj","depends_on_id":"hive-n53","type":"blocks","created_at":"2026-01-31T18:47:16.077445-06:00","created_by":"Hayden"}]}
{"id":"hive-hdg","title":"Implement hive msg CLI command","description":"Create the msg command with pub/sub/list subcommands:\n\nhive msg pub --topic \u003ctopic\u003e [message | -f file | stdin]\n  - Publish message to topic\n  - Auto-detect sender from session ID\n  \nhive msg sub [--topic \u003cpattern\u003e] [--timeout duration] [--last N]\n  - No topic: subscribe to all topics\n  - With topic: filter by pattern (supports wildcards like agent.*)\n  - --last N returns last N messages immediately\n  - Without --last, polls for new messages until timeout\n  \nhive msg list [--json]\n  - List all topics with message counts\n\nFollow pattern from cmd_ctx.go for structure.\nLocation: internal/commands/cmd_msg.go","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.434803-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:36:54.020004-06:00","closed_at":"2026-01-29T20:36:54.020004-06:00","close_reason":"Implemented hive msg CLI with pub/sub/list subcommands, auto sender detection, wildcard topic patterns, and polling for new messages","dependencies":[{"issue_id":"hive-hdg","depends_on_id":"hive-d98","type":"blocks","created_at":"2026-01-29T20:08:24.435226-06:00","created_by":"Hayden"},{"issue_id":"hive-hdg","depends_on_id":"hive-kto","type":"blocks","created_at":"2026-01-29T20:08:24.492719-06:00","created_by":"Hayden"}]}
{"id":"hive-irz","title":"Implement colored divider + focused-only selection indicator","description":"Improve focus indication by combining two techniques from research (hive-dm5):\n\n## Changes\n\n### 1. Colored Divider (tmux-style)\nChange the vertical divider color based on which pane is focused:\n- Focused pane side: blue divider\n- Unfocused: gray divider\n\n### 2. Focused-Only Selection Indicator\nOnly show the selection bar (┃) in the currently focused pane:\n- Active pane: blue bar on selected item\n- Inactive pane: no selection bar (just spacing)\n\nThis makes it immediately clear which pane will receive keyboard input.\n\n## Files to Modify\n- `internal/tui/styles.go` - divider style may need focus variant\n- `internal/tui/model.go` - pass focus state to divider rendering in `renderSplitView`\n- `internal/tui/delegate.go` - conditionally render selection bar based on pane focus\n- `internal/tui/messages_view.go` - same for message items\n\n## Acceptance Criteria\n- [ ] Divider changes color based on focused pane\n- [ ] Selection bar only visible in focused pane\n- [ ] Works correctly when switching focus with Tab\n- [ ] No visual glitches during focus transitions","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:23:59.087226-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:28:27.751431-06:00","closed_at":"2026-01-30T15:28:27.751431-06:00","close_reason":"Closed"}
{"id":"hive-ivh","title":"Remove Modal wrapper from new session form","description":"The new session form currently uses a Modal wrapper that adds Confirm/Cancel buttons, but huh forms have their own built-in keyboard handling.\n\n## Current behavior\n- Modal wrapper adds extra Confirm/Cancel buttons below the form\n- Duplicates help text that huh already shows\n\n## Expected behavior\n- Render huh form directly with modal styling but without buttons\n- Let huh handle confirm (enter) and cancel (esc) natively\n\n## Changes to internal/tui/model.go\n\nIn View(), change the form overlay from:\n```go\nformModal := NewModal(\"New Session\", m.newSessionForm.View())\nreturn formModal.Overlay(mainView, w, h)\n```\n\nTo:\n```go\nformContent := lipgloss.JoinVertical(\n    lipgloss.Left,\n    modalTitleStyle.Render(\"New Session\"),\n    \"\",\n    m.newSessionForm.View(),\n)\nformOverlay := modalStyle.Render(formContent)\nreturn lipgloss.Place(w, h, lipgloss.Center, lipgloss.Center, formOverlay)\n```","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T21:20:20.755462-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:31:59.893619-06:00","closed_at":"2026-01-30T21:31:59.893619-06:00","close_reason":"Already implemented - form renders with lipgloss styling directly without Modal wrapper buttons"}
{"id":"hive-jxd","title":"Display recycled items as collapsed count in tree view","description":"When displaying recycled items in the tree view, show them as a single collapsed item with the count of recycled sessions in parentheses (e.g., 'Recycled (5)') instead of listing each recycled session as a separate tree item.","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T21:27:39.074311-06:00","created_by":"Hayden","updated_at":"2026-01-31T23:30:17.495787-06:00","closed_at":"2026-01-31T23:30:17.495787-06:00","close_reason":"Already implemented in commit d31d5c2"}
{"id":"hive-kn0","title":"Fix layout shift between tabs - remove tree view top padding","description":"When switching between Sessions and Messages tabs, there's a visible layout shift. The tree view (Sessions) has extra top padding that Messages doesn't have, causing content to jump.\n\nFiles:\n- internal/tui/model.go - renderTabView() builds the layout\n- Check list padding vs msgView padding","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T17:18:31.836793-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:26:55.465296-06:00","closed_at":"2026-01-30T17:26:55.465296-06:00","close_reason":"Fixed by stripping empty title bar line from bubbles list when not filtering, and removing unused subheading"}
{"id":"hive-kto","title":"Add session ID detection from CWD","description":"Create utility to detect current hive session from working directory:\n\n- Read sessions.json from $XDG_DATA_HOME/hive/sessions.json\n- Find session where path matches or is prefix of CWD\n- Return session ID for use as sender identifier in messages\n- Return empty string if not in a hive session (allow anonymous publishing)\n\nThis enables automatic sender identification without manual configuration.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.255375-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:25:21.976907-06:00","closed_at":"2026-01-29T20:25:21.976907-06:00","close_reason":"Added SessionDetector to find current hive session from working directory with path prefix matching"}
{"id":"hive-kyp","title":"Modify form submission to set pending and quit","description":"Modify the form submission handler to set pendingCreate and exit TUI instead of calling createSession() inline.\n\n## Changes to internal/tui/model.go\n\nIn updateNewSessionForm(), change the completion handler:\n\n```go\nif f.State == huh.StateCompleted {\n    result := m.newSessionForm.Result()\n    m.state = stateNormal\n    m.newSessionForm = nil\n    // Set pending create and exit TUI\n    m.pendingCreate = \u0026PendingCreate{\n        Remote: result.Repo.Remote,\n        Name:   result.SessionName,\n    }\n    return m, tea.Quit\n}\n```\n\nThis replaces the current inline call to createSession().","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T21:20:04.566711-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:29:38.454822-06:00","closed_at":"2026-01-30T21:29:38.454822-06:00","close_reason":"Form submission now sets pendingCreate and calls tea.Quit instead of inline createSession()","dependencies":[{"issue_id":"hive-kyp","depends_on_id":"hive-22b","type":"blocks","created_at":"2026-01-30T21:20:27.563082-06:00","created_by":"Hayden"}]}
{"id":"hive-l87","title":"Add BatchSpawn field to config.Commands struct","description":"Add BatchSpawn []string field to Commands struct in internal/core/config/config.go\n\nThis will hold the spawn commands used specifically for batch session creation.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:30.620372-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:21:54.430594-06:00","closed_at":"2026-01-30T13:21:54.430594-06:00","close_reason":"Added BatchSpawn []string field to Commands struct"}
{"id":"hive-lei","title":"CreateSession output breaks TUI when called from sessions view","description":"When creating a session from the TUI (pressing 'n'), the CreateSession service method runs hooks/rules that output to stdout, which corrupts the TUI rendering.\n\n## Current behavior\n- CreateSession runs executeRules() which may print output\n- CreateSession runs spawner.Spawn() which outputs to terminal\n- This output is not captured and breaks the bubbletea TUI\n\n## Expected behavior\n- When called from TUI, output should be captured or suppressed\n- TUI should remain intact after session creation\n\n## Root cause\nCreateSession in internal/hive/service.go (lines 139-169):\n- executeRules() runs shell commands that may output\n- spawner.Spawn() runs spawn commands\n\n## Possible solutions\n1. Add a 'quiet' or 'noSpawn' option to CreateOptions\n2. Capture stdout/stderr when running from TUI context\n3. Skip spawn entirely when creating from TUI (user can open session from list)","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T20:16:17.739358-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:20:35.175505-06:00","closed_at":"2026-01-30T21:20:35.175505-06:00","close_reason":"Superseded by new approach in epic hive-q39 - TUI exits before session creation","dependencies":[{"issue_id":"hive-lei","depends_on_id":"hive-ljm","type":"blocks","created_at":"2026-01-30T20:16:28.55611-06:00","created_by":"Hayden"}]}
{"id":"hive-ljm","title":"New session from TUI should not spawn terminal","description":"When creating a session from the TUI, it spawns in the current terminal/zellij window instead of opening a new wezterm tab as configured.\n\n## Current behavior\n- CreateSession always calls spawner.Spawn() with configured spawn commands\n- When called from TUI, this runs spawn commands in the current terminal context\n- Results in session opening in current window instead of new tab\n\n## Expected behavior\n- TUI session creation should only create the session (clone repo, save metadata)\n- Should NOT run spawn commands\n- User selects the new session from the list and presses Enter to open it (which uses normal spawn flow)\n\n## Solution\nAdd SkipSpawn bool to CreateOptions in internal/hive/service.go:\n\n```go\ntype CreateOptions struct {\n    Name          string\n    Prompt        string\n    Remote        string\n    Source        string\n    UseBatchSpawn bool\n    SkipSpawn     bool  // NEW: skip spawning terminal (for TUI creation)\n}\n```\n\nThen in CreateSession, check SkipSpawn before running spawn commands:\n```go\nif !opts.SkipSpawn \u0026\u0026 len(spawnCommands) \u003e 0 {\n    // spawn terminal\n}\n```\n\nUpdate TUI to pass SkipSpawn: true when creating sessions.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T20:16:23.830603-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:20:35.15593-06:00","closed_at":"2026-01-30T21:20:35.15593-06:00","close_reason":"Superseded by new approach in epic hive-q39 - TUI exits before session creation"}
{"id":"hive-mte","title":"Pin keyboard hints to bottom of messages view","description":"The keyboard hints on the messages page don't extend to the bottom of the terminal. They should be pinned to the bottom row.\n\n## Expected\n- Help line should always appear at the bottom of the viewport\n- Content area should fill the space between headers and help line","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:54:07.444763-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:58:21.514378-06:00","closed_at":"2026-01-30T15:58:21.514378-06:00","close_reason":"Fixed all four layout issues: removed duplicate headers, moved session state to tab bar, fixed layout shift by removing per-view titles, pinned help to bottom, and added column headers to messages table."}
{"id":"hive-muc","title":"Restore async git status display in tree view","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:23.190688-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:00:07.512917-06:00","closed_at":"2026-01-30T17:00:07.512917-06:00","close_reason":"Restored full git status display: branch, additions (+N green), deletions (-N red), and clean/uncommitted indicator. Shows '...' while loading."}
{"id":"hive-n53","title":"Add Acknowledge method to Integration interface","description":"Update internal/integration/terminal/terminal.go Integration interface:\n\n```go\ntype Integration interface {\n    Name() string\n    Available() bool\n    RefreshCache()\n    DiscoverSession(ctx, slug, metadata) (*SessionInfo, error)\n    GetStatus(ctx, info) (Status, error)\n    \n    // NEW: Mark session as acknowledged by user\n    Acknowledge(ctx context.Context, info *SessionInfo) error\n}\n```\n\nThen implement in internal/integration/terminal/tmux/tmux.go:\n\n```go\nfunc (t *Integration) Acknowledge(ctx context.Context, info *SessionInfo) error {\n    if info == nil {\n        return nil\n    }\n    t.mu.Lock()\n    defer t.mu.Unlock()\n    if tracker, ok := t.trackers[info.Name]; ok {\n        tracker.Acknowledge()\n    }\n    return nil\n}\n```","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:47:01.037366-06:00","created_by":"Hayden","updated_at":"2026-01-31T18:55:33.030055-06:00","closed_at":"2026-01-31T18:55:33.030055-06:00","close_reason":"Added Acknowledge(ctx, info) method to Integration interface and implemented it in tmux.Integration."}
{"id":"hive-nnn","title":"Add exit option for keybindings","description":"## Use Case\nRunning hive in a tmux popup (`display-popup -E \"hive\"`). When the user presses enter to switch to a tmux session, hive should exit so the popup closes automatically.\n\n## Current Behavior\n- Hive runs keybinding shell command\n- Shell command executes (e.g., `tmux switch-client -t SESSION`)\n- Hive stays open, popup remains visible\n- User must manually press `q` to close\n\n## Proposed Solution\nAdd an `exit: true` option to keybindings config that causes hive to quit after executing the shell command.\n\n```yaml\nkeybindings:\n  enter:\n    help: switch to tmux session\n    sh: tmux switch-client -t \"{{ .Name }}\"\n    exit: true\n```\n\n## Why This Matters\nEnables hive to work seamlessly as a tmux session picker in popup mode:\n1. User presses `prefix + Space` to open hive popup\n2. User navigates to desired repo\n3. User presses enter → session switches AND popup closes\n\nSource: Message on agent.700b from dotfiles repo","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T14:43:54.130536-06:00","created_by":"Hayden","updated_at":"2026-01-31T14:56:41.966513-06:00","closed_at":"2026-01-31T14:56:41.966513-06:00","close_reason":"Implemented exit option for keybindings"}
{"id":"hive-nrs","title":"Copy StateTracker struct with acknowledge fields","description":"Copy the StateTracker struct from agent-deck/internal/tmux/tmux.go:329-347 to internal/integration/terminal/state_tracker.go\n\nAdd fields:\n- acknowledged bool\n- acknowledgedAt time.Time  \n- waitingSince time.Time\n\nAdd methods:\n- Acknowledge()\n- ResetAcknowledged()\n- IsAcknowledged() bool\n\n**ResetAcknowledged behavior**: Match Agent Deck exactly - reset acknowledged to false when:\n- New activity detected (busy indicator found)\n- Prompt detected\n- Transitioning back to active state\n\nSee agent-deck/internal/tmux/tmux.go lines 1524, 1531, 1615, 1672, 1720, 1734 for all reset points.","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:46:39.565952-06:00","created_by":"Hayden","updated_at":"2026-01-31T18:55:32.941432-06:00","closed_at":"2026-01-31T18:55:32.941432-06:00","close_reason":"Added acknowledged, acknowledgedAt, waitingSince fields to StateTracker. Added Acknowledge(), ResetAcknowledged(), IsAcknowledged(), WaitingSince() methods. Updated Update() to use acknowledge mechanism for waiting vs idle distinction."}
{"id":"hive-q39","title":"TUI Session Creation - Exit, Execute, Re-enter","description":"When creating a session from TUI via 'n' key:\n1. Show form to select repo and enter session name\n2. On submit → **exit TUI cleanly**\n3. Run full `CreateSession()` with visible output (hooks, spawn commands)\n4. **Re-enter TUI** with updated session list\n\n## Current State\n\n- TUI stays active during session creation\n- Uses `SkipSpawn: true` to avoid spawning terminals\n- Hooks output goes to stdout, corrupting TUI display\n\n## Implementation\n\n### 1. Add `PendingCreate` field to Model (`internal/tui/model.go`)\n\n```go\n// PendingCreate holds data for a session to create after TUI exits\ntype PendingCreate struct {\n    Remote string\n    Name   string\n}\n\ntype Model struct {\n    // ... existing fields\n    pendingCreate *PendingCreate\n}\n\n// Getter for cmd_tui.go to access\nfunc (m Model) PendingCreate() *PendingCreate {\n    return m.pendingCreate\n}\n```\n\n### 2. Modify form submission to set pending and quit (`internal/tui/model.go`)\n\nIn `updateNewSessionForm()`, instead of calling `createSession()`:\n\n```go\nif f.State == huh.StateCompleted {\n    result := m.newSessionForm.Result()\n    m.state = stateNormal\n    m.newSessionForm = nil\n    // Set pending create and exit TUI\n    m.pendingCreate = \u0026PendingCreate{\n        Remote: result.Repo.Remote,\n        Name:   result.SessionName,\n    }\n    return m, tea.Quit\n}\n```\n\n### 3. Loop in cmd_tui.go to handle pending actions (`internal/commands/cmd_tui.go`)\n\n```go\nfunc (cmd *TuiCmd) run(ctx context.Context, _ *cli.Command) error {\n    localRemote, _ := cmd.flags.Service.DetectRemote(ctx, \".\")\n    topicsDir := filepath.Join(cmd.flags.DataDir, \"messages\", \"topics\")\n    msgStore := jsonfile.NewMsgStore(topicsDir)\n\n    for {\n        opts := tui.Options{\n            LocalRemote: localRemote,\n            MsgStore:    msgStore,\n        }\n\n        m := tui.New(cmd.flags.Service, cmd.flags.Config, opts)\n        p := tea.NewProgram(m, tea.WithAltScreen())\n\n        finalModel, err := p.Run()\n        if err != nil {\n            return fmt.Errorf(\"run tui: %w\", err)\n        }\n\n        model := finalModel.(tui.Model)\n\n        // Handle pending session creation\n        if pending := model.PendingCreate(); pending != nil {\n            source, _ := os.Getwd()\n            _, err := cmd.flags.Service.CreateSession(ctx, hive.CreateOptions{\n                Name:   pending.Name,\n                Remote: pending.Remote,\n                Source: source,\n            })\n            if err != nil {\n                fmt.Printf(\"Error creating session: %v\\n\", err)\n                fmt.Println(\"Press Enter to continue...\")\n                fmt.Scanln()\n            }\n            continue // Restart TUI\n        }\n\n        break // Normal exit\n    }\n    return nil\n}\n```\n\n### 4. Remove SkipSpawn option (`internal/hive/service.go`)\n\nRevert the `SkipSpawn` field from `CreateOptions` since we no longer need it.\n\n### 5. Clean up unused code\n\n- Remove `createSession()` command method from model.go\n- Remove `sessionCreatedMsg` message type\n\n## Verification\n\n1. Run `hive` (TUI mode)\n2. Press 'n' to open new session form\n3. Select a repo and enter session name\n4. Press Enter to submit\n5. Verify: TUI exits, hooks run with visible output, spawn commands execute\n6. Verify: TUI re-enters with new session in list\n7. Test cancelling form with Esc - should stay in TUI\n8. Test ctrl+c during form - should exit completely","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-30T21:19:50.906429-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:32:14.180241-06:00","closed_at":"2026-01-30T21:32:14.180241-06:00","close_reason":"All subtasks completed: Added PendingCreate type, modified form submission to exit TUI, added loop in cmd_tui.go for pending actions, cleaned up SkipSpawn"}
{"id":"hive-r58","title":"Copy PromptDetector with tool-specific patterns","description":"Copy PromptDetector from agent-deck/internal/tmux/detector.go to internal/integration/terminal/detector.go\n\nKey functions:\n- HasPrompt() - main entry point\n- hasClaudePrompt() - Claude-specific detection\n- hasGeminiPrompt() - Gemini-specific detection  \n- hasShellPrompt() - generic shell detection\n- StripANSI() - O(n) ANSI removal\n\nPatterns to copy:\n- Permission prompts (Yes allow once, No and tell Claude...)\n- Empty input prompts (\u003e, ❯)\n- Busy exclusions (ctrl+c to interrupt, spinners)\n- Box-drawing UI detection","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:46:46.31169-06:00","created_by":"Hayden","updated_at":"2026-01-31T18:55:33.118374-06:00","closed_at":"2026-01-31T18:55:33.118374-06:00","close_reason":"Already implemented - detector.go has IsBusy(), IsWaiting(), stripANSI(), and all required patterns for Claude, Gemini, and shell detection."}
{"id":"hive-rr5","title":"Simplify max_recycled: remove global, use catch-all","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T10:21:42.507774-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:24:39.845358-06:00","closed_at":"2026-01-31T10:24:39.845358-06:00","close_reason":"Closed"}
{"id":"hive-rum","title":"Add copy-to-clipboard shortcut for message preview","description":"Add ability to copy message payload from the message preview modal using a keyboard shortcut.\n\n## Requirements\n- Add a keybinding (e.g., 'c' or 'y') in the message preview modal to copy payload\n- Copy command should be configurable in config (e.g., `pbcopy` on macOS, `xclip` on Linux)\n- Show brief feedback when copy succeeds\n\n## Files to modify\n- `internal/tui/message_preview.go` - handle copy key\n- `internal/core/config/config.go` - add copy command config option\n- Possibly add a clipboard utility package","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:38:38.235427-06:00","created_by":"Hayden","updated_at":"2026-01-30T16:13:21.048895-06:00","closed_at":"2026-01-30T16:13:21.048895-06:00","close_reason":"Added copy-to-clipboard with 'c' or 'y' key in message preview modal. Copy command is configurable via commands.copy_command config option with OS-specific defaults (pbcopy on macOS, xclip on Linux, clip on Windows)."}
{"id":"hive-rx8","title":"Use distinct color for session IDs","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:22.03027-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:10:32.018019-06:00","closed_at":"2026-01-30T17:10:32.018019-06:00","close_reason":"Changed session ID color from gray to purple (#bb9af7) for better distinction."}
{"id":"hive-sy7","title":"Update filter to match repo and session names","description":"Extend filter to match against both repository names and session names. Show matching sessions and their repo headers.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:38:11.22383-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:05:55.709011-06:00","closed_at":"2026-01-30T17:05:55.709011-06:00","close_reason":"Already implemented. FilterValue returns 'repoName sessionName' for sessions, enabling filter to match either. Headers return empty but display when child sessions match.","dependencies":[{"issue_id":"hive-sy7","depends_on_id":"hive-60w","type":"blocks","created_at":"2026-01-30T16:38:24.996916-06:00","created_by":"Hayden"}]}
{"id":"hive-uhe","title":"Remove KV store implementation","description":"Remove the KV store code entirely:\n\n- Delete internal/core/context/kv.go\n- Delete internal/store/jsonfile/kvstore.go  \n- Remove 'hive ctx kv' subcommand from cmd_ctx.go\n- Remove any KV-related tests\n- Clean up any imports/references\n\nState storage will be handled by beads instead.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.613123-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:45:05.437764-06:00","closed_at":"2026-01-29T20:45:05.437764-06:00","close_reason":"Removed KV store: deleted internal/core/context/kv.go, internal/store/jsonfile/kvstore.go and test, removed hive ctx kv subcommand from cmd_ctx.go","dependencies":[{"issue_id":"hive-uhe","depends_on_id":"hive-hdg","type":"blocks","created_at":"2026-01-29T20:08:24.550509-06:00","created_by":"Hayden"}]}
{"id":"hive-uio","title":"Add batch_spawn command config","description":"Add a separate spawn command config for batch sessions that supports prompts.\n\nCurrent state:\n- commands.spawn is used for all session spawning\n- Prompt was removed from hive new (good - keeps it simple)\n- But batch needs prompts for automation\n\nSolution:\n- Add commands.batch_spawn config option\n- batch_spawn supports {{.Prompt}} template variable\n- hive batch uses batch_spawn if configured, falls back to spawn\n- hive new continues using spawn (no prompt)\n\nConfig example:\n```yaml\ncommands:\n  spawn:        # Used by hive new\n    - \"wezterm cli spawn --cwd {{.Path}}\"\n  batch_spawn:  # Used by hive batch (optional)\n    - \"wezterm cli spawn --cwd {{.Path}} -- claude --prompt '{{.Prompt}}'\"\n```","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:25.981268-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:24:03.646186-06:00","closed_at":"2026-01-30T13:24:03.646186-06:00","close_reason":"Feature complete: batch_spawn config added with full Prompt support for batch sessions","dependencies":[{"issue_id":"hive-uio","depends_on_id":"hive-l87","type":"blocks","created_at":"2026-01-30T13:19:43.442982-06:00","created_by":"Hayden"},{"issue_id":"hive-uio","depends_on_id":"hive-13m","type":"blocks","created_at":"2026-01-30T13:19:43.501181-06:00","created_by":"Hayden"},{"issue_id":"hive-uio","depends_on_id":"hive-4fk","type":"blocks","created_at":"2026-01-30T13:19:43.563115-06:00","created_by":"Hayden"},{"issue_id":"hive-uio","depends_on_id":"hive-an2","type":"blocks","created_at":"2026-01-30T13:19:43.624774-06:00","created_by":"Hayden"},{"issue_id":"hive-uio","depends_on_id":"hive-143","type":"blocks","created_at":"2026-01-30T13:19:43.685034-06:00","created_by":"Hayden"}]}
{"id":"hive-um2","title":"Add error wrapping to session store","description":"**Files**: `internal/store/jsonfile/store.go`\n**Risk**: Very Low\n\n## Problem\n\nSession Store returns unwrapped errors while MsgStore wraps all errors with context:\n\n**store.go (lines 131-136):**\n```go\nfunc (s *Store) load() (SessionFile, error) {\n    data, err := os.ReadFile(s.path)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return SessionFile{}, nil\n        }\n        return SessionFile{}, err  // No wrapping!\n    }\n    // ...\n}\n```\n\n## Solution\n\nAdd consistent error wrapping to store.go:\n\n```go\nfunc (s *Store) load() (SessionFile, error) {\n    data, err := os.ReadFile(s.path)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return SessionFile{}, nil\n        }\n        return SessionFile{}, fmt.Errorf(\"read sessions file: %w\", err)\n    }\n\n    if len(data) == 0 {\n        return SessionFile{}, nil\n    }\n\n    var file SessionFile\n    if err := json.Unmarshal(data, \u0026file); err != nil {\n        return SessionFile{}, fmt.Errorf(\"parse sessions file: %w\", err)\n    }\n\n    return file, nil\n}\n\nfunc (s *Store) save(file SessionFile) error {\n    if err := os.MkdirAll(filepath.Dir(s.path), 0o755); err != nil {\n        return fmt.Errorf(\"create sessions directory: %w\", err)\n    }\n\n    data, err := json.MarshalIndent(file, \"\", \"  \")\n    if err != nil {\n        return fmt.Errorf(\"marshal sessions: %w\", err)\n    }\n\n    tmp := s.path + \".tmp\"\n    if err := os.WriteFile(tmp, data, 0o644); err != nil {\n        return fmt.Errorf(\"write temp file: %w\", err)\n    }\n\n    if err := os.Rename(tmp, s.path); err != nil {\n        return fmt.Errorf(\"rename temp file: %w\", err)\n    }\n    return nil\n}\n```\n\n## Impact\n- Better error messages when debugging storage issues\n- Consistent pattern across all stores","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:04:23.201647-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:07:40.440236-06:00","closed_at":"2026-01-30T19:07:40.440236-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-um2","depends_on_id":"hive-x04","type":"parent-child","created_at":"2026-01-30T19:04:49.029504-06:00","created_by":"Hayden"}]}
{"id":"hive-vzg","title":"Match tree view selector style with messages view","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:24.004265-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:10:59.942146-06:00","closed_at":"2026-01-30T17:10:59.942146-06:00","close_reason":"Changed tree view selection indicator from ▸ to ┃ to match messages view style."}
{"id":"hive-wf6","title":"Copy Agent Deck detection algorithm to hive terminal integration","description":"## Vision\n\nAgent Deck's terminal state detection is MIT licensed and battle-tested. Rather than reinventing the wheel, copy their algorithm as closely as possible to get reliable detection.\n\n## Source Files (MIT Licensed)\n\nCopy from `agent-deck/internal/tmux/`:\n- `tmux.go` - StateTracker struct, GetStatus logic, hasBusyIndicator, hasPromptIndicator\n- `detector.go` - PromptDetector with tool-specific patterns, StripANSI\n- `patterns.go` - Configurable pattern system with regex support\n\n## Target Location\n\n`internal/integration/terminal/`\n\n## Key Components to Copy\n\n### 1. StateTracker (from tmux.go:329-347)\n```go\ntype StateTracker struct {\n    lastHash              string\n    lastChangeTime        time.Time\n    acknowledged          bool      // KEY: tracks if user saw session\n    acknowledgedAt        time.Time // grace period for state transitions\n    lastActivityTimestamp int64\n    waitingSince          time.Time // when session became waiting\n    activityCheckStart    time.Time\n    activityChangeCount   int\n}\n```\n\n### 2. GetStatus Logic (from tmux.go:1440-1696)\n- Check session exists\n- Get activity timestamp\n- Check busy indicator (spinner, ctrl+c to interrupt)\n- Check prompt indicator (permission dialogs, empty prompt)\n- Spike detection (2+ changes in 1 second)\n- Grace period before leaving active state\n- Return idle vs waiting based on acknowledged flag\n\n### 3. PromptDetector (from detector.go)\n- Tool-specific detection (claude, gemini, opencode, codex, shell)\n- Permission prompt patterns\n- Empty input prompt patterns\n- Busy indicator exclusions\n\n### 4. Acknowledge Mechanism\n- `Acknowledge()` - mark session as seen\n- `ResetAcknowledged()` - clear on new activity\n- Integration interface needs Acknowledge method\n\n## Success Criteria\n\n- Permission dialogs detected as \"waiting\" (high priority)\n- Empty `\u003e` prompt detected as \"waiting\" (needs acknowledge to become idle)\n- Spinner/busy indicators detected as \"active\"\n- User acknowledge transitions waiting → idle\n- No false positives from cursor blinks or status bar updates","status":"closed","priority":1,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:46:34.698795-06:00","created_by":"Hayden","updated_at":"2026-01-31T19:02:34.67755-06:00","closed_at":"2026-01-31T19:02:34.67755-06:00","close_reason":"All subtasks completed: StateTracker with acknowledge fields, Integration.Acknowledge interface method, PromptDetector patterns, GetStatus state machine, content normalization, TUI acknowledge integration. Detection now distinguishes: active (spinner), waiting (prompt/needs attention), idle (acknowledged).","dependencies":[{"issue_id":"hive-wf6","depends_on_id":"hive-nrs","type":"blocks","created_at":"2026-01-31T18:50:30.100842-06:00","created_by":"Hayden"},{"issue_id":"hive-wf6","depends_on_id":"hive-r58","type":"blocks","created_at":"2026-01-31T18:50:30.186693-06:00","created_by":"Hayden"},{"issue_id":"hive-wf6","depends_on_id":"hive-clm","type":"blocks","created_at":"2026-01-31T18:50:30.274766-06:00","created_by":"Hayden"},{"issue_id":"hive-wf6","depends_on_id":"hive-fhz","type":"blocks","created_at":"2026-01-31T18:50:30.360028-06:00","created_by":"Hayden"},{"issue_id":"hive-wf6","depends_on_id":"hive-n53","type":"blocks","created_at":"2026-01-31T18:50:30.447671-06:00","created_by":"Hayden"},{"issue_id":"hive-wf6","depends_on_id":"hive-gvj","type":"blocks","created_at":"2026-01-31T18:50:30.55299-06:00","created_by":"Hayden"},{"issue_id":"hive-wf6","depends_on_id":"hive-6ze","type":"blocks","created_at":"2026-01-31T18:50:30.644025-06:00","created_by":"Hayden"}]}
{"id":"hive-wvy","title":"Update msg command: list by default, JSON output","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:48:11.945114-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:49:53.159676-06:00","closed_at":"2026-01-29T20:49:53.159676-06:00","close_reason":"Updated msg sub to list messages by default (JSON), added --listen flag for polling mode, made msg list output JSON"}
{"id":"hive-x04","title":"Code Quality Improvements","description":"Address code duplication and inconsistent patterns found during codebase analysis.\n\n## Overview\n\nThis epic addresses code duplication and inconsistent patterns found during codebase analysis. The improvements are ordered by impact and risk.\n\n---\n\n## 1. Extract Duplicate Directory Reading in MsgStore\n\n**Priority**: High\n**Files**: `internal/store/jsonfile/msgstore.go`\n\n### Problem\n\n`List()` (lines 174-202) and `listTopicsUnsafe()` (lines 283-306) contain nearly identical logic for reading topic files from disk.\n\n**List():**\n```go\nentries, err := os.ReadDir(s.topicsDir)\nif err != nil {\n    if os.IsNotExist(err) {\n        return nil, nil\n    }\n    return nil, fmt.Errorf(\"read topics directory: %w\", err)\n}\n\nvar topics []string\nfor _, entry := range entries {\n    if entry.IsDir() {\n        continue\n    }\n    name := entry.Name()\n    if strings.HasSuffix(name, \".json\") \u0026\u0026 !strings.HasSuffix(name, \".lock\") {\n        topic := strings.TrimSuffix(name, \".json\")\n        topic = strings.ReplaceAll(topic, \"_\", \"/\")\n        topics = append(topics, topic)\n    }\n}\nsort.Strings(topics)\nreturn topics, nil\n```\n\n**listTopicsUnsafe():**\n```go\n// Identical except no sort.Strings() call\n```\n\n### Solution\n\nExtract shared logic into a private `readTopicsFromDisk()` helper:\n\n```go\n// readTopicsFromDisk reads topic names from the topics directory.\n// Returns nil, nil if directory doesn't exist.\n// Caller is responsible for locking.\nfunc (s *MsgStore) readTopicsFromDisk() ([]string, error) {\n    entries, err := os.ReadDir(s.topicsDir)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return nil, nil\n        }\n        return nil, fmt.Errorf(\"read topics directory: %w\", err)\n    }\n\n    var topics []string\n    for _, entry := range entries {\n        if entry.IsDir() {\n            continue\n        }\n        name := entry.Name()\n        if strings.HasSuffix(name, \".json\") \u0026\u0026 !strings.HasSuffix(name, \".lock\") {\n            topic := strings.TrimSuffix(name, \".json\")\n            topic = strings.ReplaceAll(topic, \"_\", \"/\")\n            topics = append(topics, topic)\n        }\n    }\n    return topics, nil\n}\n```\n\nThen simplify both callers:\n\n```go\n// List returns all topic names (sorted).\nfunc (s *MsgStore) List(ctx context.Context) ([]string, error) {\n    s.mu.RLock()\n    defer s.mu.RUnlock()\n\n    topics, err := s.readTopicsFromDisk()\n    if err != nil {\n        return nil, err\n    }\n    sort.Strings(topics)\n    return topics, nil\n}\n\n// listTopicsUnsafe returns all topic names without locking.\n// Caller must hold s.mu.\nfunc (s *MsgStore) listTopicsUnsafe() ([]string, error) {\n    return s.readTopicsFromDisk()\n}\n```\n\n### Impact\n- Eliminates 20+ lines of duplicate code\n- Single source of truth for topic parsing logic\n- Easier to maintain filename conventions\n\n---\n\n## 2. Unify Template Rendering Between Spawner and Recycler\n\n**Priority**: Medium\n**Files**: `internal/hive/spawner.go`, `internal/hive/recycler.go`, `pkg/tmpl/tmpl.go`\n\n### Problem\n\nSpawner uses `tmpl.Render()` from `pkg/tmpl` while Recycler implements its own `renderCommand()` method. Both do the same thing but with slightly different error handling.\n\n**Spawner (line 48):**\n```go\nrendered, err := tmpl.Render(cmdTmpl, data)\n```\n\n**Recycler (lines 61-72):**\n```go\nfunc (r *Recycler) renderCommand(cmd string, data RecycleData) (string, error) {\n    tmpl, err := template.New(\"cmd\").Parse(cmd)\n    if err != nil {\n        return \"\", err\n    }\n\n    var buf bytes.Buffer\n    if err := tmpl.Execute(\u0026buf, data); err != nil {\n        return \"\", err\n    }\n\n    return buf.String(), nil\n}\n```\n\n### Solution\n\nUpdate Recycler to use `tmpl.Render()`:\n\n1. Remove `renderCommand()` method from Recycler\n2. Remove `bytes`, `text/template` imports from recycler.go\n3. Add `github.com/hay-kot/hive/pkg/tmpl` import\n4. Use `tmpl.Render()` in the Recycle method\n\n```go\nfunc (r *Recycler) Recycle(ctx context.Context, path string, commands []string, data RecycleData, w io.Writer) error {\n    // ...\n    for _, cmd := range commands {\n        rendered, err := tmpl.Render(cmd, data)\n        if err != nil {\n            return fmt.Errorf(\"render recycle command %q: %w\", cmd, err)\n        }\n        // ...\n    }\n}\n```\n\n### Impact\n- Single template rendering implementation\n- Recycler gets access to `shq` shell-quoting function\n- Consistent error wrapping (`parse template:` vs raw error)\n\n---\n\n## 3. Standardize Git Executor Error Messages\n\n**Priority**: Medium\n**Files**: `internal/core/git/executor.go`\n\n### Problem\n\nError messages have inconsistent formats:\n\n| Method | Current Error | Issue |\n|--------|--------------|-------|\n| Clone | `clone %s to %s: %w` | Has args, no prefix |\n| Checkout | `checkout %s: %w` | Has arg, no prefix |\n| Pull | `pull: %w` | No context |\n| ResetHard | `reset --hard: %w` | Command literal |\n| RemoteURL | `get remote url: %w` | Description |\n| IsClean | `git status: %w` | Has git prefix |\n| Branch | `git branch: %w` | Has git prefix |\n| DiffStats | `git diff: %w` | Has git prefix |\n\n### Solution\n\nStandardize to format: `git \u003ccommand\u003e[ \u003ccontext\u003e]: \u003cerror\u003e`\n\n```go\nfunc (e *Executor) Clone(ctx context.Context, url, dest string) error {\n    if _, err := e.exec.Run(ctx, e.gitPath, \"clone\", url, dest); err != nil {\n        return fmt.Errorf(\"git clone: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) Checkout(ctx context.Context, dir, branch string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"checkout\", branch); err != nil {\n        return fmt.Errorf(\"git checkout %s: %w\", branch, err)\n    }\n    return nil\n}\n\nfunc (e *Executor) Pull(ctx context.Context, dir string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"pull\"); err != nil {\n        return fmt.Errorf(\"git pull: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) ResetHard(ctx context.Context, dir string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"reset\", \"--hard\"); err != nil {\n        return fmt.Errorf(\"git reset --hard: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) RemoteURL(ctx context.Context, dir string) (string, error) {\n    out, err := e.exec.RunDir(ctx, dir, e.gitPath, \"remote\", \"get-url\", \"origin\")\n    if err != nil {\n        return \"\", fmt.Errorf(\"git remote get-url: %w\", err)\n    }\n    return strings.TrimSpace(string(out)), nil\n}\n```\n\n### Impact\n- Consistent error messages aid debugging\n- Users can easily identify which git command failed\n\n---\n\n## 4. Add Error Wrapping to Session Store\n\n**Priority**: Low\n**Files**: `internal/store/jsonfile/store.go`\n\n### Problem\n\nSession Store returns unwrapped errors while MsgStore wraps all errors with context:\n\n**store.go (lines 131-136):**\n```go\nfunc (s *Store) load() (SessionFile, error) {\n    data, err := os.ReadFile(s.path)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return SessionFile{}, nil\n        }\n        return SessionFile{}, err  // No wrapping!\n    }\n    // ...\n}\n```\n\n**msgstore.go (lines 312-320):**\n```go\nfunc (s *MsgStore) loadTopic(name string) (messaging.Topic, error) {\n    // ...\n    if err != nil {\n        if os.IsNotExist(err) {\n            return messaging.Topic{...}, nil\n        }\n        return messaging.Topic{}, fmt.Errorf(\"read topic file: %w\", err)  // Wrapped\n    }\n}\n```\n\n### Solution\n\nAdd consistent error wrapping to store.go:\n\n```go\nfunc (s *Store) load() (SessionFile, error) {\n    data, err := os.ReadFile(s.path)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return SessionFile{}, nil\n        }\n        return SessionFile{}, fmt.Errorf(\"read sessions file: %w\", err)\n    }\n\n    if len(data) == 0 {\n        return SessionFile{}, nil\n    }\n\n    var file SessionFile\n    if err := json.Unmarshal(data, \u0026file); err != nil {\n        return SessionFile{}, fmt.Errorf(\"parse sessions file: %w\", err)\n    }\n\n    return file, nil\n}\n\nfunc (s *Store) save(file SessionFile) error {\n    if err := os.MkdirAll(filepath.Dir(s.path), 0o755); err != nil {\n        return fmt.Errorf(\"create sessions directory: %w\", err)\n    }\n\n    data, err := json.MarshalIndent(file, \"\", \"  \")\n    if err != nil {\n        return fmt.Errorf(\"marshal sessions: %w\", err)\n    }\n\n    tmp := s.path + \".tmp\"\n    if err := os.WriteFile(tmp, data, 0o644); err != nil {\n        return fmt.Errorf(\"write temp file: %w\", err)\n    }\n\n    if err := os.Rename(tmp, s.path); err != nil {\n        return fmt.Errorf(\"rename temp file: %w\", err)\n    }\n    return nil\n}\n```\n\n### Impact\n- Better error messages when debugging storage issues\n- Consistent pattern across all stores\n\n---\n\n## Summary\n\n| Task | Priority | Lines Changed | Risk |\n|------|----------|---------------|------|\n| Extract MsgStore directory reading | High | ~30 | Low |\n| Unify template rendering | Medium | ~20 | Low |\n| Standardize git error messages | Medium | ~15 | Very Low |\n| Add Store error wrapping | Low | ~15 | Very Low |\n\n**Total estimated changes**: ~80 lines\n**Risk assessment**: All changes are internal refactors with no API changes\n\n---\n\n## Implementation Order\n\n1. Start with git executor error messages (lowest risk, quick win)\n2. Add Store error wrapping (isolated change)\n3. Extract MsgStore helper (clear duplication)\n4. Unify template rendering (requires import changes)\n\nEach change should be tested independently before moving to the next.","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:04:10.232864-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:08:44.979035-06:00","closed_at":"2026-01-30T19:08:44.979035-06:00","close_reason":"Closed"}
{"id":"hive-yym","title":"Remove brackets from tab indicators","description":"Remove the [] brackets around the active tab indicator - they throw off alignment.\n\n## Current\n`[Sessions] | Messages`\n\n## Desired\n`Sessions | Messages` (with styling to indicate active tab)\n\n## Files to modify\n- `internal/tui/model.go` - `renderTabView` function","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:38:43.47297-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:41:54.732103-06:00","closed_at":"2026-01-30T15:41:54.732103-06:00","close_reason":"Removed brackets from tab indicators - active tabs now use styling (blue + bold) only"}
{"id":"hive-zxv","title":"Extract duplicate directory reading in MsgStore","description":"**Files**: `internal/store/jsonfile/msgstore.go`\n**Risk**: Low\n\n## Problem\n\n`List()` (lines 174-202) and `listTopicsUnsafe()` (lines 283-306) contain nearly identical logic for reading topic files from disk.\n\n**List():**\n```go\nentries, err := os.ReadDir(s.topicsDir)\nif err != nil {\n    if os.IsNotExist(err) {\n        return nil, nil\n    }\n    return nil, fmt.Errorf(\"read topics directory: %w\", err)\n}\n\nvar topics []string\nfor _, entry := range entries {\n    if entry.IsDir() {\n        continue\n    }\n    name := entry.Name()\n    if strings.HasSuffix(name, \".json\") \u0026\u0026 !strings.HasSuffix(name, \".lock\") {\n        topic := strings.TrimSuffix(name, \".json\")\n        topic = strings.ReplaceAll(topic, \"_\", \"/\")\n        topics = append(topics, topic)\n    }\n}\nsort.Strings(topics)\nreturn topics, nil\n```\n\n**listTopicsUnsafe():**\n```go\n// Identical except no sort.Strings() call\n```\n\n## Solution\n\nExtract shared logic into a private `readTopicsFromDisk()` helper:\n\n```go\n// readTopicsFromDisk reads topic names from the topics directory.\n// Returns nil, nil if directory doesn't exist.\n// Caller is responsible for locking.\nfunc (s *MsgStore) readTopicsFromDisk() ([]string, error) {\n    entries, err := os.ReadDir(s.topicsDir)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return nil, nil\n        }\n        return nil, fmt.Errorf(\"read topics directory: %w\", err)\n    }\n\n    var topics []string\n    for _, entry := range entries {\n        if entry.IsDir() {\n            continue\n        }\n        name := entry.Name()\n        if strings.HasSuffix(name, \".json\") \u0026\u0026 !strings.HasSuffix(name, \".lock\") {\n            topic := strings.TrimSuffix(name, \".json\")\n            topic = strings.ReplaceAll(topic, \"_\", \"/\")\n            topics = append(topics, topic)\n        }\n    }\n    return topics, nil\n}\n```\n\nThen simplify both callers:\n\n```go\n// List returns all topic names (sorted).\nfunc (s *MsgStore) List(ctx context.Context) ([]string, error) {\n    s.mu.RLock()\n    defer s.mu.RUnlock()\n\n    topics, err := s.readTopicsFromDisk()\n    if err != nil {\n        return nil, err\n    }\n    sort.Strings(topics)\n    return topics, nil\n}\n\n// listTopicsUnsafe returns all topic names without locking.\n// Caller must hold s.mu.\nfunc (s *MsgStore) listTopicsUnsafe() ([]string, error) {\n    return s.readTopicsFromDisk()\n}\n```\n\n## Impact\n- Eliminates 20+ lines of duplicate code\n- Single source of truth for topic parsing logic\n- Easier to maintain filename conventions","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:04:31.919637-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:08:08.785689-06:00","closed_at":"2026-01-30T19:08:08.785689-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-zxv","depends_on_id":"hive-x04","type":"parent-child","created_at":"2026-01-30T19:04:49.088545-06:00","created_by":"Hayden"}]}
