{"id":"hive-07m","title":"Change recycled indicator to trash icon with gray styling","description":"Replace [○] with [] (Nerd Font trash icon \\uf1f8) for recycled sessions. Change color from yellow/orange to gray/subtle to de-emphasize recycled sessions visually.\n\nFiles:\n- internal/tui/tree_view.go - statusRecycled constant and StatusRecycled style\n- Update both the icon and the style color","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T17:18:34.564908-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:35:48.973644-06:00","closed_at":"2026-01-30T17:35:48.973644-06:00","close_reason":"Closed"}
{"id":"hive-1re","title":"Remove duplicate headers and update tab bar to show session state","description":"The 'Message Bus' header is indented one space too far. Additionally, there are duplicate headers (the list title and the tab bar) which looks strange.\n\n## Solution\n- Remove the per-view titles (Sessions/Message Bus headers within the list)\n- Use only the tab bar as the heading\n- Show 'active' and 'local' session filter states in the tab bar itself (e.g., 'Sessions (local, active)' or as subtle indicators)","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:54:07.063539-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:58:21.476523-06:00","closed_at":"2026-01-30T15:58:21.476523-06:00","close_reason":"Fixed all four layout issues: removed duplicate headers, moved session state to tab bar, fixed layout shift by removing per-view titles, pinned help to bottom, and added column headers to messages table."}
{"id":"hive-1rq","title":"Add left padding to tab bar to align with banner","description":"The tab bar (Sessions | Messages) starts at column 0, but the banner above it has left padding. Add matching left padding to the tab bar so they align visually.\n\nFiles:\n- internal/tui/model.go - renderTabView() line ~687\n- internal/tui/styles.go - bannerStyle has PaddingLeft(1)","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T17:18:32.759514-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:43:35.845634-06:00","closed_at":"2026-01-30T17:43:35.845634-06:00","close_reason":"Applied consistent PaddingLeft(1) style to tab bar, matching banner styling"}
{"id":"hive-22b","title":"Add PendingCreate type and field to TUI Model","description":"Add a PendingCreate struct and field to the TUI Model to hold session creation data that will be executed after TUI exits.\n\n## Changes to internal/tui/model.go\n\n1. Add the PendingCreate type:\n```go\n// PendingCreate holds data for a session to create after TUI exits\ntype PendingCreate struct {\n    Remote string\n    Name   string\n}\n```\n\n2. Add field to Model struct:\n```go\ntype Model struct {\n    // ... existing fields\n    pendingCreate *PendingCreate\n}\n```\n\n3. Add getter method for external access:\n```go\n// PendingCreate returns any pending session creation data\nfunc (m Model) PendingCreate() *PendingCreate {\n    return m.pendingCreate\n}\n```","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T21:20:00.086642-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:29:11.084344-06:00","closed_at":"2026-01-30T21:29:11.084344-06:00","close_reason":"Added PendingCreate type, field to Model struct, and getter method"}
{"id":"hive-32a","title":"Unify template rendering between Spawner and Recycler","description":"**Files**: `internal/hive/spawner.go`, `internal/hive/recycler.go`, `pkg/tmpl/tmpl.go`\n**Risk**: Low\n\n## Problem\n\nSpawner uses `tmpl.Render()` from `pkg/tmpl` while Recycler implements its own `renderCommand()` method. Both do the same thing but with slightly different error handling.\n\n**Spawner (line 48):**\n```go\nrendered, err := tmpl.Render(cmdTmpl, data)\n```\n\n**Recycler (lines 61-72):**\n```go\nfunc (r *Recycler) renderCommand(cmd string, data RecycleData) (string, error) {\n    tmpl, err := template.New(\"cmd\").Parse(cmd)\n    if err != nil {\n        return \"\", err\n    }\n\n    var buf bytes.Buffer\n    if err := tmpl.Execute(\u0026buf, data); err != nil {\n        return \"\", err\n    }\n\n    return buf.String(), nil\n}\n```\n\n## Solution\n\nUpdate Recycler to use `tmpl.Render()`:\n\n1. Remove `renderCommand()` method from Recycler\n2. Remove `bytes`, `text/template` imports from recycler.go\n3. Add `github.com/hay-kot/hive/pkg/tmpl` import\n4. Use `tmpl.Render()` in the Recycle method\n\n```go\nfunc (r *Recycler) Recycle(ctx context.Context, path string, commands []string, data RecycleData, w io.Writer) error {\n    // ...\n    for _, cmd := range commands {\n        rendered, err := tmpl.Render(cmd, data)\n        if err != nil {\n            return fmt.Errorf(\"render recycle command %q: %w\", cmd, err)\n        }\n        // ...\n    }\n}\n```\n\n## Impact\n- Single template rendering implementation\n- Recycler gets access to `shq` shell-quoting function\n- Consistent error wrapping (`parse template:` vs raw error)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T19:04:38.859043-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:08:41.860742-06:00","closed_at":"2026-01-30T19:08:41.860742-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-32a","depends_on_id":"hive-x04","type":"parent-child","created_at":"2026-01-30T19:04:49.146421-06:00","created_by":"Hayden"}]}
{"id":"hive-4gc","title":"Remove Modal wrapper from new session form","description":"The new session form uses a Modal wrapper that adds Confirm/Cancel buttons, but huh forms have their own built-in confirm handling with proper keyboard shortcuts.\n\n## Current behavior\n- Modal wrapper adds extra Confirm/Cancel buttons below the form\n- User can't interact with these buttons properly\n- Duplicates the help text that huh already shows\n\n## Expected behavior\n- Use huh form directly without Modal wrapper\n- Let huh handle confirm (enter) and cancel (esc) natively\n- Form should show huh's built-in help for navigation\n\n## Files to modify\n- internal/tui/model.go - View() function renders the form modal\n- internal/tui/new_session_form.go - may need to configure form differently","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T20:16:12.754956-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:20:35.135741-06:00","closed_at":"2026-01-30T21:20:35.135741-06:00","close_reason":"Superseded by new approach in epic hive-q39 - TUI exits before session creation"}
{"id":"hive-4nw","title":"Remove 'showing local' subheading","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:24.611541-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:11:16.64312-06:00","closed_at":"2026-01-30T17:11:16.64312-06:00","close_reason":"Already done when removing toggle options - buildSubheading now returns empty string."}
{"id":"hive-4og","title":"Standardize git executor error messages","description":"**Files**: `internal/core/git/executor.go`\n**Risk**: Very Low\n\n## Problem\n\nError messages have inconsistent formats:\n\n| Method | Current Error | Issue |\n|--------|--------------|-------|\n| Clone | `clone %s to %s: %w` | Has args, no prefix |\n| Checkout | `checkout %s: %w` | Has arg, no prefix |\n| Pull | `pull: %w` | No context |\n| ResetHard | `reset --hard: %w` | Command literal |\n| RemoteURL | `get remote url: %w` | Description |\n| IsClean | `git status: %w` | Has git prefix |\n| Branch | `git branch: %w` | Has git prefix |\n| DiffStats | `git diff: %w` | Has git prefix |\n\n## Solution\n\nStandardize to format: `git \u003ccommand\u003e[ \u003ccontext\u003e]: \u003cerror\u003e`\n\n```go\nfunc (e *Executor) Clone(ctx context.Context, url, dest string) error {\n    if _, err := e.exec.Run(ctx, e.gitPath, \"clone\", url, dest); err != nil {\n        return fmt.Errorf(\"git clone: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) Checkout(ctx context.Context, dir, branch string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"checkout\", branch); err != nil {\n        return fmt.Errorf(\"git checkout %s: %w\", branch, err)\n    }\n    return nil\n}\n\nfunc (e *Executor) Pull(ctx context.Context, dir string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"pull\"); err != nil {\n        return fmt.Errorf(\"git pull: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) ResetHard(ctx context.Context, dir string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"reset\", \"--hard\"); err != nil {\n        return fmt.Errorf(\"git reset --hard: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) RemoteURL(ctx context.Context, dir string) (string, error) {\n    out, err := e.exec.RunDir(ctx, dir, e.gitPath, \"remote\", \"get-url\", \"origin\")\n    if err != nil {\n        return \"\", fmt.Errorf(\"git remote get-url: %w\", err)\n    }\n    return strings.TrimSpace(string(out)), nil\n}\n```\n\n## Impact\n- Consistent error messages aid debugging\n- Users can easily identify which git command failed","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T19:04:18.652926-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:07:15.606707-06:00","closed_at":"2026-01-30T19:07:15.606707-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-4og","depends_on_id":"hive-x04","type":"parent-child","created_at":"2026-01-30T19:04:48.971094-06:00","created_by":"Hayden"}]}
{"id":"hive-4s8","title":"Implement repository scanner","description":"Create new file internal/tui/repo_scanner.go\n\n## Types\n- DiscoveredRepo struct with Path, Name, Remote fields\n\n## Function\n- ScanRepoDirs(ctx, dirs []string, gitExec git.Git) ([]DiscoveredRepo, error)\n- Scan each directory for subdirectories containing .git folder\n- Get remote URL via git.RemoteURL()\n- Sort results alphabetically by name\n- Handle errors gracefully (skip repos that fail)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:21:33.483757-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:29:21.143595-06:00","closed_at":"2026-01-30T19:29:21.143595-06:00","close_reason":"Created repo_scanner.go with DiscoveredRepo type and ScanRepoDirs function","dependencies":[{"issue_id":"hive-4s8","depends_on_id":"hive-ejn","type":"blocks","created_at":"2026-01-30T19:21:41.244135-06:00","created_by":"Hayden"},{"issue_id":"hive-4s8","depends_on_id":"hive-ewh","type":"parent-child","created_at":"2026-01-30T19:21:45.789103-06:00","created_by":"Hayden"}]}
{"id":"hive-55z","title":"Implement message preview modal with markdown rendering","description":"Add a message preview modal that opens when user presses \u003center\u003e on a selected message.\n\nRequirements:\n- Open modal on enter key when message is selected\n- Display full message content rendered as markdown\n- Show message metadata (topic, sender, timestamp, session ID)\n- Support scrolling for long messages (viewport)\n- Close with esc or enter\n- Style consistently with existing modals (OutputModal pattern)\n\nImplementation:\n- Create MessagePreviewModal component\n- Integrate glamour for markdown rendering\n- Add keybinding handler for enter on messages\n- Wire into model Update/View cycle","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:32:16.731602-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:46:18.424529-06:00","closed_at":"2026-01-30T13:46:18.424529-06:00","close_reason":"Implemented message preview modal with glamour markdown rendering, viewport scrolling, and keyboard navigation","dependencies":[{"issue_id":"hive-55z","depends_on_id":"hive-gmj","type":"blocks","created_at":"2026-01-30T13:32:25.065727-06:00","created_by":"Hayden"}]}
{"id":"hive-5eb","title":"Create Huh form dialog component","description":"Create new file internal/tui/new_session_form.go\n\n## Component\n- NewSessionForm struct wrapping huh.Form\n- Implements tea.Model interface for Bubble Tea integration\n\n## Form Fields\n- Repository select (filterable) - options from discovered repos\n- Session name input with validation (non-empty)\n\n## Features\n- Auto-selection: pre-select repo matching preselectedRemote parameter\n- Use styles.FormTheme() for Tokyo Night styling\n- Track submitted/cancelled state","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:21:34.635593-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:30:30.550655-06:00","closed_at":"2026-01-30T19:30:30.550655-06:00","close_reason":"Created new_session_form.go with NewSessionForm wrapping huh.Form","dependencies":[{"issue_id":"hive-5eb","depends_on_id":"hive-4s8","type":"blocks","created_at":"2026-01-30T19:21:41.303554-06:00","created_by":"Hayden"},{"issue_id":"hive-5eb","depends_on_id":"hive-ewh","type":"parent-child","created_at":"2026-01-30T19:21:45.851038-06:00","created_by":"Hayden"}]}
{"id":"hive-60w","title":"Group sessions by repository in data model","description":"Create data structure to group sessions by repository. Sessions should be organized under their repo with current repo (from cwd) first, others sorted alphabetically.","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:38:05.588015-06:00","created_by":"Hayden","updated_at":"2026-01-30T16:43:21.822635-06:00","closed_at":"2026-01-30T16:43:21.822635-06:00","close_reason":"Added GroupSessionsByRepo function in repo_group.go with tests. Groups sessions by Remote field, sorts with local repo first then alphabetically, and sorts sessions within groups by name."}
{"id":"hive-66m","title":"Register msg command and add tests","description":"Final integration:\n\n- Register MsgCmd in main.go following existing pattern\n- Add unit tests for message store (publish, subscribe, retention, wildcards)\n- Add integration tests for CLI commands\n- Update any documentation if present","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.812033-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:37:39.287581-06:00","closed_at":"2026-01-29T20:37:39.287581-06:00","close_reason":"Registered MsgCmd in main.go. Unit tests already exist in msgstore_test.go (12 tests) and sender_test.go (3 tests) covering publish, subscribe, retention, wildcards, and session detection","dependencies":[{"issue_id":"hive-66m","depends_on_id":"hive-hdg","type":"blocks","created_at":"2026-01-29T20:08:24.608036-06:00","created_by":"Hayden"}]}
{"id":"hive-67","title":"Research condensed message list UI (2-line layout)","description":"Investigate options for a more space-efficient message list display in the TUI. Current 3-line layout is too verbose.\n\nCurrent layout (3 lines per message):\n- Line 1: [Topic] from Sender @ 15:04:05\n- Line 2: Payload (truncated)\n- Line 3: Session ID (dimmed)\n\nGoal: Condense to 2 lines while preserving key information.\n\nResearch:\n- Review bubbles list delegate patterns for compact layouts\n- Consider what info is most important (topic, payload, time)\n- Look at how session delegate handles multi-line rendering\n- Determine if session ID is needed or can be shown on hover/selection only","notes":"## Research Findings\n\n### Current Implementation\n- `MessageDelegate` (messages_view.go:61-67): Height=3, Spacing=1\n- Current layout per message:\n  - Line 1: `[Topic] from Sender @ 15:04:05`\n  - Line 2: `Payload...` (truncated)\n  - Line 3: `session: \u003cid\u003e` (dimmed, only if present)\n\n### Comparison with SessionDelegate\n- Height=5, Spacing=1 (more verbose)\n- Uses similar border selection pattern\n\n### Recommended 2-Line Layout\n\n**Option A (Minimal change):**\n```\nLine 1: [Topic] Sender • 15:04:05\nLine 2: Payload...\n```\n- Remove \"from\" prefix (redundant)\n- Use bullet separator like SessionDelegate\n- Session ID removed from default view\n\n**Option B (More compact header):**\n```\nLine 1: [Topic] • Payload preview...\nLine 2: Sender @ 15:04:05  session: abc123\n```\n- Topic + payload on first line (most important info)\n- Metadata on second line\n- Cons: breaks visual hierarchy\n\n### Recommended Approach: Option A\n\nChanges needed in `messages_view.go`:\n1. `Height() int` → return 2 (was 3)\n2. `Render()` → remove line3, condense line1\n\nSession ID handling options:\n1. **Remove entirely** - simplest, may lose debugging value\n2. **Show only when selected** - requires variable height (not well supported by bubbles list)\n3. **Show in help/status bar** - requires model changes to track selected message\n4. **Show truncated inline** - e.g. `[Topic] Sender • 15:04 • abc12...`\n\nRecommendation: Start with option 1 (remove entirely). Session ID is low-value for most use cases - users can filter by topic/sender instead. If needed later, can add a \"details\" view.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:20:41.995533-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:22:44.904981-06:00","closed_at":"2026-01-30T13:22:44.904981-06:00","close_reason":"Research complete. Recommended 2-line layout: [Topic] Sender • 15:04:05 on line 1, Payload on line 2. Session ID removed (low value for typical use)."}
{"id":"hive-68","title":"Implement condensed 2-line message list UI","description":"Implement the condensed message list UI based on research findings.\n\nImplementation tasks:\n- Update MessageDelegate.Height() to return 2\n- Redesign MessageDelegate.Render() for 2-line layout\n- Adjust spacing if needed\n- Test with various message lengths and content\n- Ensure filter highlighting still works\n\nProposed 2-line layout options:\n1. [Topic] Payload preview...                    @ 15:04:05\n   from sender (session: abc123)\n\n2. 15:04:05 [topic] from sender\n   Payload preview truncated to fit...\n\n3. [Topic] Payload text here...                  15:04:05\n   sender • session-id (dimmed)\n\nPick best option based on research.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:20:50.25184-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:23:51.561046-06:00","closed_at":"2026-01-30T13:23:51.561046-06:00","close_reason":"Implemented 2-line layout: Line 1 shows [Topic] Sender • 15:04:05, Line 2 shows payload. Removed session ID display.","dependencies":[{"issue_id":"hive-68","depends_on_id":"hive-67","type":"blocks","created_at":"2026-01-30T13:21:26.466243-06:00","created_by":"import"}]}
{"id":"hive-6n8","title":"Implement tree rendering with column alignment","description":"Render sessions as a tree with: classic lines (├─, └─, │), [●]/[○] status indicators, column-aligned session name/branch/id per repo, repo headers with recycled count, ★ for current repo.","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:38:08.077836-06:00","created_by":"Hayden","updated_at":"2026-01-30T16:49:01.813478-06:00","closed_at":"2026-01-30T16:49:01.813478-06:00","close_reason":"Implemented tree rendering with TreeItem/TreeDelegate in tree_view.go. Sessions now display as a tree with repo headers (★ for current repo), tree lines (├─/└─), status indicators ([●]/[○]), session name, git branch, and short ID. Updated model.go to use tree items, removed old SessionDelegate.","dependencies":[{"issue_id":"hive-6n8","depends_on_id":"hive-60w","type":"blocks","created_at":"2026-01-30T16:38:24.825935-06:00","created_by":"Hayden"}]}
{"id":"hive-78i","title":"Remove recycled toggle, always show all sessions","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:20.983339-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:07:58.59002-06:00","closed_at":"2026-01-30T17:07:58.59002-06:00","close_reason":"Removed showAll and hideRecycled toggles. All sessions now display by default. Removed 'a' and 'x' keybindings."}
{"id":"hive-87f","title":"Redesign message view with custom compact layout","description":"Replace the bubbles list implementation for messages view with a custom compact layout.\n\n## Current Problem\nThe bubbles list is too verbose for message display.\n\n## Desired Layout\n```\n14:32:01 [orders  ] New order received #12849 from cu…       api-gateway\n14:31:58 [auth    ] User login successful for user_id…          auth-svc\n14:31:45 [system  ] Health check passed                          unknown\n14:31:30 [payments] Payment processed: $142.50                payment-svc\n14:31:12 [stock   ] Low stock alert: SKU-4421 below t…         inventory\n14:30:58 [orders  ] Order status updated to shipped f…       api-gateway\n14:30:45 [errors  ] Connection timeout to external se…           unknown\n14:30:30 [jobs    ] Scheduled job completed: cleanup_…         scheduler\n```\n\n## Requirements\n1. **Compact row format**: `timestamp [topic] message_preview sender`\n2. **New messages at top**: Newest messages appear first\n3. **No borders**: Remove list chrome/borders for cleaner look\n4. **Color hashing**: Use deterministic color selection for topics and senders\n   - Define a pool of colors\n   - Hash topic/sender string to select consistent color\n   - Same topic/sender always gets same color\n5. **Preserve dialog behavior**: Enter still opens message preview modal\n6. **Scrolling**: Support up/down navigation through messages\n\n## Files to modify\n- `internal/tui/model.go` - Replace msgList with custom renderer\n- `internal/tui/styles.go` - Add color pool and hashing function\n- `internal/tui/message_delegate.go` - May be removed or heavily modified\n\n## Implementation Notes\n- Consider a simple slice-based model instead of bubbles list\n- Track scroll position manually\n- Truncate message preview to fit available width\n- Right-align sender column","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:44:44.124332-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:50:49.753325-06:00","closed_at":"2026-01-30T15:50:49.753325-06:00","close_reason":"Implemented compact message view with custom renderer. Replaced bubbles list with slice-based model, added deterministic color hashing for topics/senders, single-line format with timestamp, topic, preview, and sender columns."}
{"id":"hive-8n0","title":"Integrate new session form into TUI model","description":"Modify internal/tui/model.go\n\n## State\n- Add stateCreatingSession to UIState enum\n- Add newSessionForm *NewSessionForm to Model\n- Add discoveredRepos []DiscoveredRepo to Model\n\n## Key Handler\n- Intercept 'n' in handleSessionsKey()\n- Only respond if discoveredRepos is non-empty\n- Create form with auto-selection from selected session or localRemote\n\n## Form Flow\n- Route messages to form when in stateCreatingSession\n- On submit: call Service.CreateSession(), reload sessions\n- On cancel: return to stateNormal\n\n## Help\n- Add 'n' keybinding to AdditionalShortHelpKeys (only if repos discovered)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:21:36.300083-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:33:48.65353-06:00","closed_at":"2026-01-30T19:33:48.65353-06:00","close_reason":"Integrated new session form into TUI model with n key handler and form state management","dependencies":[{"issue_id":"hive-8n0","depends_on_id":"hive-5eb","type":"blocks","created_at":"2026-01-30T19:21:41.364591-06:00","created_by":"Hayden"},{"issue_id":"hive-8n0","depends_on_id":"hive-ewh","type":"parent-child","created_at":"2026-01-30T19:21:45.909894-06:00","created_by":"Hayden"}]}
{"id":"hive-8nf","title":"Add TUI loop with pending action handling","description":"Wrap the TUI program in a loop that checks for pending actions after exit and restarts.\n\n## Changes to internal/commands/cmd_tui.go\n\nReplace the current run() implementation with a loop:\n\n```go\nfunc (cmd *TuiCmd) run(ctx context.Context, _ *cli.Command) error {\n    localRemote, _ := cmd.flags.Service.DetectRemote(ctx, \".\")\n    topicsDir := filepath.Join(cmd.flags.DataDir, \"messages\", \"topics\")\n    msgStore := jsonfile.NewMsgStore(topicsDir)\n\n    for {\n        opts := tui.Options{\n            LocalRemote: localRemote,\n            MsgStore:    msgStore,\n        }\n\n        m := tui.New(cmd.flags.Service, cmd.flags.Config, opts)\n        p := tea.NewProgram(m, tea.WithAltScreen())\n\n        finalModel, err := p.Run()\n        if err != nil {\n            return fmt.Errorf(\"run tui: %w\", err)\n        }\n\n        model := finalModel.(tui.Model)\n\n        // Handle pending session creation\n        if pending := model.PendingCreate(); pending != nil {\n            source, _ := os.Getwd()\n            _, err := cmd.flags.Service.CreateSession(ctx, hive.CreateOptions{\n                Name:   pending.Name,\n                Remote: pending.Remote,\n                Source: source,\n            })\n            if err != nil {\n                fmt.Printf(\"Error creating session: %v\\n\", err)\n                fmt.Println(\"Press Enter to continue...\")\n                fmt.Scanln()\n            }\n            continue // Restart TUI\n        }\n\n        break // Normal exit\n    }\n    return nil\n}\n```\n\nRequires adding imports: \"os\", \"fmt\", \"github.com/hay-kot/hive/internal/hive\"","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T21:20:10.471128-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:30:27.369007-06:00","closed_at":"2026-01-30T21:30:27.369007-06:00","close_reason":"Added TUI loop in cmd_tui.go that handles pending session creation and restarts TUI","dependencies":[{"issue_id":"hive-8nf","depends_on_id":"hive-kyp","type":"blocks","created_at":"2026-01-30T21:20:27.648746-06:00","created_by":"Hayden"}]}
{"id":"hive-9i7","title":"Remove SkipSpawn and clean up unused code","description":"Remove the SkipSpawn option and clean up code that's no longer needed.\n\n## Changes to internal/hive/service.go\n\n1. Remove SkipSpawn field from CreateOptions:\n```go\ntype CreateOptions struct {\n    Name          string\n    Prompt        string\n    Remote        string\n    Source        string\n    UseBatchSpawn bool\n    // SkipSpawn removed\n}\n```\n\n2. Revert the spawn condition back to original:\n```go\nif len(spawnCommands) \u003e 0 {\n    // ... spawn logic\n}\n```\n\n## Changes to internal/tui/model.go\n\n1. Remove createSession() method (no longer needed)\n2. Remove sessionCreatedMsg type (no longer needed)\n3. Remove the sessionCreatedMsg case in Update()","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T21:20:14.633515-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:31:46.291172-06:00","closed_at":"2026-01-30T21:31:46.291172-06:00","close_reason":"Removed SkipSpawn from CreateOptions, cleaned up unused createSession method and sessionCreatedMsg type","dependencies":[{"issue_id":"hive-9i7","depends_on_id":"hive-8nf","type":"blocks","created_at":"2026-01-30T21:20:27.738902-06:00","created_by":"Hayden"}]}
{"id":"hive-aru","title":"Update navigation for tree structure","description":"Update keyboard navigation to work with tree structure. Repo headers are focusable but have no actions yet. Session actions remain unchanged. Selected row gets color highlight.","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:38:09.796101-06:00","created_by":"Hayden","updated_at":"2026-01-30T16:57:40.819318-06:00","closed_at":"2026-01-30T16:57:40.819318-06:00","close_reason":"Navigation already works correctly. Headers are focusable (TreeItems in list), have no actions (selectedSession returns nil), sessions retain actions, and selection highlighting applies to both via isSelected check in renderHeader/renderSession.","dependencies":[{"issue_id":"hive-aru","depends_on_id":"hive-6n8","type":"blocks","created_at":"2026-01-30T16:38:24.912781-06:00","created_by":"Hayden"}]}
{"id":"hive-b5n","title":"Remove toggle all option, show all sessions by default","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:20.649257-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:07:58.571856-06:00","closed_at":"2026-01-30T17:07:58.571856-06:00","close_reason":"Removed showAll and hideRecycled toggles. All sessions now display by default. Removed 'a' and 'x' keybindings."}
{"id":"hive-bed","title":"Fix layout shift between sessions and messages views","description":"When switching between Sessions and Messages tabs, there is a layout shift. The Hive banner and tab bar move positions.\n\n## Expected\n- Banner and tab bar remain fixed in exactly the same position on every view\n- Only the content area below the tabs should change","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:54:07.287005-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:58:21.495601-06:00","closed_at":"2026-01-30T15:58:21.495601-06:00","close_reason":"Fixed all four layout issues: removed duplicate headers, moved session state to tab bar, fixed layout shift by removing per-view titles, pinned help to bottom, and added column headers to messages table."}
{"id":"hive-c02","title":"Improve active pane visual distinction in TUI","description":"The current focus indicator (▸ and bold title) is too subtle. Users accidentally press enter on the wrong pane.\n\nOptions to explore:\n- Add a colored border around the focused pane\n- Dim/fade the unfocused pane content\n- Use a more prominent focus indicator\n- Add a background tint to the focused pane header\n\nShould work in both split mode and tab mode.","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:53:45.826314-06:00","created_by":"Hayden","updated_at":"2026-01-30T14:26:04.92571-06:00","closed_at":"2026-01-30T14:26:04.92571-06:00","close_reason":"Added rounded borders to distinguish active pane: blue border for focused pane, dark gray border for unfocused. Removed old vertical divider in favor of gap between bordered panes."}
{"id":"hive-cdw","title":"Define core messaging types and store interface","description":"Create the foundational types for the messaging system:\n\n- Message struct with ID, Topic, Payload, Sender, CreatedAt fields\n- Topic struct with Name, Messages slice, UpdatedAt\n- Store interface with Publish, Subscribe, List, Prune methods\n\nLocation: internal/core/messaging/\n\nThis establishes the contract before implementing storage or CLI.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:05:42.503772-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:19:10.639495-06:00","closed_at":"2026-01-29T20:19:10.639495-06:00","close_reason":"Created Message, Topic structs and Store interface in internal/core/messaging/"}
{"id":"hive-cxn","title":"Sort sessions with active before recycled","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:21.31874-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:08:32.815401-06:00","closed_at":"2026-01-30T17:08:32.815401-06:00","close_reason":"Updated sortSessions to sort active sessions before recycled, then by name."}
{"id":"hive-d98","title":"Implement global JSON file message store","description":"Implement the messaging Store interface using per-topic JSON files:\n\n- Storage location: $XDG_DATA_HOME/hive/messages/topics/{topic}.json\n- Reuse file locking pattern from kvstore.go (in-process mutex + flock)\n- Atomic writes via temp file + rename\n- Count-based retention: enforce max messages per topic on write (default 100)\n- Support topic wildcards for Subscribe (e.g., agent.* matches agent.build, agent.test)\n- Support subscribing to all topics when no pattern specified\n\nLocation: internal/store/jsonfile/msgstore.go","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.073644-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:23:45.952299-06:00","closed_at":"2026-01-29T20:23:45.952299-06:00","close_reason":"Implemented MsgStore with per-topic JSON files, file locking, atomic writes, count-based retention (default 100), and wildcard topic patterns","dependencies":[{"issue_id":"hive-d98","depends_on_id":"hive-cdw","type":"blocks","created_at":"2026-01-29T20:08:24.370052-06:00","created_by":"Hayden"}]}
{"id":"hive-djp","title":"Remove session count from repo headers","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:20.847234-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:10:05.101973-06:00","closed_at":"2026-01-30T17:10:05.101973-06:00","close_reason":"Removed session count from repo headers. Removed TotalCount/RecycledCount fields from TreeItem and HeaderCount style."}
{"id":"hive-dm5","title":"Research TUI focus indicator design options","description":"The current focus indicator (▸ and bold title) is too subtle - users accidentally press enter on the wrong pane.\n\n## Failed Approaches\n1. **Bordered panes** - Added rounded borders around focused pane. Removed header layout, looked cluttered.\n2. **Background tint on header** - Added blue background behind focused header text. Looked awful.\n\n## Research Needed\nLook at other TUI applications for inspiration on how they handle split pane focus:\n- lazygit\n- k9s\n- btop/htop\n- lazydocker\n- Other Bubble Tea apps\n\n## Possible Options to Explore\n- Different indicator symbols or positioning\n- Underline the focused header\n- Color the divider line based on which side is focused\n- Subtle highlight on selected list items only in focused pane\n- Different approach entirely?\n\n## User Feedback Requested\nWhat visual style would you prefer? Please add notes with examples or preferences.","notes":"## Research Findings\n\n### How Popular TUIs Handle Focus Indication\n\n#### 1. Lazygit / Lazydocker\n- **Bright blue border** around the focused pane (lazygotest confirms: 'highlighted with a bright blue border')\n- **Highlighted/brighter text** for active items\n- Very consistent visual language across all panels\n- Navigation: Tab to cycle, h/l or arrows to switch panes, number keys (1-5) for direct access\n\n#### 2. K9s (Kubernetes TUI)\n- Uses **configurable focus colors** via skins\n- Key styling properties: `focusColor`, `cursorColor`, `highlightColor`\n- Border has separate `fgColor` and `focusColor` \n- Allows full theme customization\n\n#### 3. btop/htop\n- **Color-coded sections** with distinct visual hierarchy\n- **Highlighted keys** are clickable/interactive\n- Relies more on section differentiation than active/inactive states\n- Uses ASCII art and Unicode for visual clarity\n\n#### 4. Tmux (Reference Pattern)\n- **Colorizes separators/dividers** adjacent to active pane\n- Inactive panes can be 'slightly greyed'\n- Active pane border set to distinct color (commonly blue)\n- Windows Terminal adopted similar approach\n\n### Bubble Tea / Lip Gloss Patterns\n\n#### Built-in Focus Support\n- `EnableReportFocus` for terminal focus events\n- Bubbles library has `Style struct` with focused/unfocused states\n- Common pattern: conditional style application based on focus state\n\n#### Border Options Available\n- `lipgloss.NormalBorder()` - standard\n- `lipgloss.ThickBorder()` - heavier weight\n- `lipgloss.DoubleBorder()` - double-line\n- `lipgloss.HiddenBorder()` - invisible (useful for unfocused to maintain alignment)\n- `BorderForeground()` to colorize\n\n### Design Options to Consider\n\nBased on research, here are the most viable approaches:\n\n#### Option A: Colored Divider (tmux-style)\nChange the vertical divider color based on which pane is focused:\n- Left focused: divider colored on right side or entire divider blue\n- Right focused: divider colored on left side\n- Subtle but effective in terminals\n\n#### Option B: Border Accent (lazygit-style)\nAdd a border to the focused pane only:\n- Focused: visible border (blue/accent color)\n- Unfocused: hidden border (maintains spacing)\n- Clear visual distinction\n\n#### Option C: Title Underline\nUnderline the focused pane title:\n- Less intrusive than borders\n- Clear indication of which pane\n- Works well with existing arrow indicator\n\n#### Option D: Dimmed Unfocused Pane\nDim/grey out the unfocused pane content:\n- Focused: normal colors\n- Unfocused: faded/dimmed colors\n- Common in IDEs (inactive panels)\n\n#### Option E: Selected Item Differentiation\nOnly show selection indicator in focused pane:\n- Active pane: blue bar on selected item\n- Inactive pane: no selection bar shown\n- User sees which pane can receive input\n\n### Recommendation\n\n**Option A (Colored Divider)** is the most elegant solution:\n1. Minimal visual clutter\n2. Proven pattern (tmux, Windows Terminal)\n3. Easy to implement with lipgloss\n4. Works with existing arrow + bold title indicators\n\nImplementation would be:\n```go\n// In renderSplitView\nvar dividerColor lipgloss.Color\nif m.focusedPane == PaneSessions {\n    dividerColor = colorBlue  // Blue when left focused (divider 'points' right)\n} else {\n    dividerColor = colorBlue  // Blue when right focused\n}\ndivider := lipgloss.NewStyle().\n    Foreground(dividerColor).\n    Render(strings.Repeat(\"│\", contentHeight))\n```\n\nOr **Option E** could complement this - only showing the selection bar (┃) in the focused pane.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T14:35:02.81949-06:00","created_by":"Hayden","updated_at":"2026-01-30T14:39:10.487747-06:00","closed_at":"2026-01-30T14:39:10.487747-06:00","close_reason":"Research complete. Documented findings from lazygit, k9s, btop, lazydocker, and tmux. Recommended colored divider approach (Option A) as primary solution."}
{"id":"hive-ejn","title":"Add repo_dirs config field","description":"Add RepoDirs []string field to Config struct in internal/core/config/config.go\n\n- Field name: RepoDirs\n- YAML key: repo_dirs\n- Type: []string (list of directory paths)\n- No default value - empty means feature is disabled\n- No validation required beyond normal YAML parsing","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:21:24.198566-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:26:51.227143-06:00","closed_at":"2026-01-30T19:26:51.227143-06:00","close_reason":"Added RepoDirs []string field to Config struct","dependencies":[{"issue_id":"hive-ejn","depends_on_id":"hive-ewh","type":"parent-child","created_at":"2026-01-30T19:21:45.729412-06:00","created_by":"Hayden"}]}
{"id":"hive-ewh","title":"New Session Dialog for Sessions TUI","description":"Add a dialog triggered by 'n' key in the Sessions TUI that allows creating a new session from any repository on the system. Uses a repo_dirs config setting to discover available repositories.\n\n## Requirements\n- Add repo_dirs config field - list of directories containing git repositories\n- Press 'n' key triggers a new session dialog\n- Dialog uses Huh forms with searchable repository selector and session name input\n- Smart auto-selection: If user is viewing a session in tree view, pre-select that repository\n- After form submission, call Service.CreateSession()\n- When repo_dirs is empty, disable the feature (hide keybinding)","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:21:18.899905-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:33:49.421095-06:00","closed_at":"2026-01-30T19:33:49.421095-06:00","close_reason":"Completed all child tasks for new session dialog"}
{"id":"hive-faq","title":"Explore column-aligned session fields like a table","description":"Investigate aligning session fields (name, branch, ID, git status) into columns so they line up vertically across sessions, similar to a table layout.","status":"closed","priority":4,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T17:18:36.240683-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:45:45.219378-06:00","closed_at":"2026-01-30T17:45:45.219378-06:00","close_reason":"Implemented column alignment for session names. Added ColumnWidths pointer to delegate for dynamic updates. Name column is now padded to align IDs across sessions."}
{"id":"hive-g4d","title":"Add subtle column headers to messages table view","description":"The messages table view should have subtle column headers to define each column.\n\n## Layout\n```\nTime     Topic      Message                              Sender\n────────────────────────────────────────────────────────────────\n14:32:01 [orders  ] New order received #12849...    api-gateway\n```\n\n## Requirements\n- Headers should be dimmed/gray to not compete with content\n- Use same column widths as the data rows\n- Consider a subtle separator line or just spacing","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:54:08.296689-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:58:21.532486-06:00","closed_at":"2026-01-30T15:58:21.532486-06:00","close_reason":"Fixed all four layout issues: removed duplicate headers, moved session state to tab bar, fixed layout shift by removing per-view titles, pinned help to bottom, and added column headers to messages table."}
{"id":"hive-gmj","title":"Research charm markdown rendering (glamour)","description":"Investigate glamour library for rendering markdown in the TUI message preview modal.\n\nResearch:\n- How to integrate glamour with bubbles/lipgloss\n- Styling options and terminal compatibility\n- How to render markdown within a modal/viewport\n- Check if glamour is already a dependency or needs adding\n- Look at existing modal patterns in the codebase (OutputModal, Modal)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:32:04.363416-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:40:37.370189-06:00","closed_at":"2026-01-30T13:40:37.370189-06:00","close_reason":"Research complete. Glamour v2 needed as new dependency. Use tokyo-night style to match existing colors. Viewport bubble for scrollable content. See .hive/research/glamour-markdown-rendering.md"}
{"id":"hive-hdg","title":"Implement hive msg CLI command","description":"Create the msg command with pub/sub/list subcommands:\n\nhive msg pub --topic \u003ctopic\u003e [message | -f file | stdin]\n  - Publish message to topic\n  - Auto-detect sender from session ID\n  \nhive msg sub [--topic \u003cpattern\u003e] [--timeout duration] [--last N]\n  - No topic: subscribe to all topics\n  - With topic: filter by pattern (supports wildcards like agent.*)\n  - --last N returns last N messages immediately\n  - Without --last, polls for new messages until timeout\n  \nhive msg list [--json]\n  - List all topics with message counts\n\nFollow pattern from cmd_ctx.go for structure.\nLocation: internal/commands/cmd_msg.go","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.434803-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:36:54.020004-06:00","closed_at":"2026-01-29T20:36:54.020004-06:00","close_reason":"Implemented hive msg CLI with pub/sub/list subcommands, auto sender detection, wildcard topic patterns, and polling for new messages","dependencies":[{"issue_id":"hive-hdg","depends_on_id":"hive-d98","type":"blocks","created_at":"2026-01-29T20:08:24.435226-06:00","created_by":"Hayden"},{"issue_id":"hive-hdg","depends_on_id":"hive-kto","type":"blocks","created_at":"2026-01-29T20:08:24.492719-06:00","created_by":"Hayden"}]}
{"id":"hive-irz","title":"Implement colored divider + focused-only selection indicator","description":"Improve focus indication by combining two techniques from research (hive-dm5):\n\n## Changes\n\n### 1. Colored Divider (tmux-style)\nChange the vertical divider color based on which pane is focused:\n- Focused pane side: blue divider\n- Unfocused: gray divider\n\n### 2. Focused-Only Selection Indicator\nOnly show the selection bar (┃) in the currently focused pane:\n- Active pane: blue bar on selected item\n- Inactive pane: no selection bar (just spacing)\n\nThis makes it immediately clear which pane will receive keyboard input.\n\n## Files to Modify\n- `internal/tui/styles.go` - divider style may need focus variant\n- `internal/tui/model.go` - pass focus state to divider rendering in `renderSplitView`\n- `internal/tui/delegate.go` - conditionally render selection bar based on pane focus\n- `internal/tui/messages_view.go` - same for message items\n\n## Acceptance Criteria\n- [ ] Divider changes color based on focused pane\n- [ ] Selection bar only visible in focused pane\n- [ ] Works correctly when switching focus with Tab\n- [ ] No visual glitches during focus transitions","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:23:59.087226-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:28:27.751431-06:00","closed_at":"2026-01-30T15:28:27.751431-06:00","close_reason":"Closed"}
{"id":"hive-ivh","title":"Remove Modal wrapper from new session form","description":"The new session form currently uses a Modal wrapper that adds Confirm/Cancel buttons, but huh forms have their own built-in keyboard handling.\n\n## Current behavior\n- Modal wrapper adds extra Confirm/Cancel buttons below the form\n- Duplicates help text that huh already shows\n\n## Expected behavior\n- Render huh form directly with modal styling but without buttons\n- Let huh handle confirm (enter) and cancel (esc) natively\n\n## Changes to internal/tui/model.go\n\nIn View(), change the form overlay from:\n```go\nformModal := NewModal(\"New Session\", m.newSessionForm.View())\nreturn formModal.Overlay(mainView, w, h)\n```\n\nTo:\n```go\nformContent := lipgloss.JoinVertical(\n    lipgloss.Left,\n    modalTitleStyle.Render(\"New Session\"),\n    \"\",\n    m.newSessionForm.View(),\n)\nformOverlay := modalStyle.Render(formContent)\nreturn lipgloss.Place(w, h, lipgloss.Center, lipgloss.Center, formOverlay)\n```","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T21:20:20.755462-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:31:59.893619-06:00","closed_at":"2026-01-30T21:31:59.893619-06:00","close_reason":"Already implemented - form renders with lipgloss styling directly without Modal wrapper buttons"}
{"id":"hive-kn0","title":"Fix layout shift between tabs - remove tree view top padding","description":"When switching between Sessions and Messages tabs, there's a visible layout shift. The tree view (Sessions) has extra top padding that Messages doesn't have, causing content to jump.\n\nFiles:\n- internal/tui/model.go - renderTabView() builds the layout\n- Check list padding vs msgView padding","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T17:18:31.836793-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:26:55.465296-06:00","closed_at":"2026-01-30T17:26:55.465296-06:00","close_reason":"Fixed by stripping empty title bar line from bubbles list when not filtering, and removing unused subheading"}
{"id":"hive-kto","title":"Add session ID detection from CWD","description":"Create utility to detect current hive session from working directory:\n\n- Read sessions.json from $XDG_DATA_HOME/hive/sessions.json\n- Find session where path matches or is prefix of CWD\n- Return session ID for use as sender identifier in messages\n- Return empty string if not in a hive session (allow anonymous publishing)\n\nThis enables automatic sender identification without manual configuration.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.255375-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:25:21.976907-06:00","closed_at":"2026-01-29T20:25:21.976907-06:00","close_reason":"Added SessionDetector to find current hive session from working directory with path prefix matching"}
{"id":"hive-kyp","title":"Modify form submission to set pending and quit","description":"Modify the form submission handler to set pendingCreate and exit TUI instead of calling createSession() inline.\n\n## Changes to internal/tui/model.go\n\nIn updateNewSessionForm(), change the completion handler:\n\n```go\nif f.State == huh.StateCompleted {\n    result := m.newSessionForm.Result()\n    m.state = stateNormal\n    m.newSessionForm = nil\n    // Set pending create and exit TUI\n    m.pendingCreate = \u0026PendingCreate{\n        Remote: result.Repo.Remote,\n        Name:   result.SessionName,\n    }\n    return m, tea.Quit\n}\n```\n\nThis replaces the current inline call to createSession().","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T21:20:04.566711-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:29:38.454822-06:00","closed_at":"2026-01-30T21:29:38.454822-06:00","close_reason":"Form submission now sets pendingCreate and calls tea.Quit instead of inline createSession()","dependencies":[{"issue_id":"hive-kyp","depends_on_id":"hive-22b","type":"blocks","created_at":"2026-01-30T21:20:27.563082-06:00","created_by":"Hayden"}]}
{"id":"hive-lei","title":"CreateSession output breaks TUI when called from sessions view","description":"When creating a session from the TUI (pressing 'n'), the CreateSession service method runs hooks/rules that output to stdout, which corrupts the TUI rendering.\n\n## Current behavior\n- CreateSession runs executeRules() which may print output\n- CreateSession runs spawner.Spawn() which outputs to terminal\n- This output is not captured and breaks the bubbletea TUI\n\n## Expected behavior\n- When called from TUI, output should be captured or suppressed\n- TUI should remain intact after session creation\n\n## Root cause\nCreateSession in internal/hive/service.go (lines 139-169):\n- executeRules() runs shell commands that may output\n- spawner.Spawn() runs spawn commands\n\n## Possible solutions\n1. Add a 'quiet' or 'noSpawn' option to CreateOptions\n2. Capture stdout/stderr when running from TUI context\n3. Skip spawn entirely when creating from TUI (user can open session from list)","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T20:16:17.739358-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:20:35.175505-06:00","closed_at":"2026-01-30T21:20:35.175505-06:00","close_reason":"Superseded by new approach in epic hive-q39 - TUI exits before session creation","dependencies":[{"issue_id":"hive-lei","depends_on_id":"hive-ljm","type":"blocks","created_at":"2026-01-30T20:16:28.55611-06:00","created_by":"Hayden"}]}
{"id":"hive-ljm","title":"New session from TUI should not spawn terminal","description":"When creating a session from the TUI, it spawns in the current terminal/zellij window instead of opening a new wezterm tab as configured.\n\n## Current behavior\n- CreateSession always calls spawner.Spawn() with configured spawn commands\n- When called from TUI, this runs spawn commands in the current terminal context\n- Results in session opening in current window instead of new tab\n\n## Expected behavior\n- TUI session creation should only create the session (clone repo, save metadata)\n- Should NOT run spawn commands\n- User selects the new session from the list and presses Enter to open it (which uses normal spawn flow)\n\n## Solution\nAdd SkipSpawn bool to CreateOptions in internal/hive/service.go:\n\n```go\ntype CreateOptions struct {\n    Name          string\n    Prompt        string\n    Remote        string\n    Source        string\n    UseBatchSpawn bool\n    SkipSpawn     bool  // NEW: skip spawning terminal (for TUI creation)\n}\n```\n\nThen in CreateSession, check SkipSpawn before running spawn commands:\n```go\nif !opts.SkipSpawn \u0026\u0026 len(spawnCommands) \u003e 0 {\n    // spawn terminal\n}\n```\n\nUpdate TUI to pass SkipSpawn: true when creating sessions.","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T20:16:23.830603-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:20:35.15593-06:00","closed_at":"2026-01-30T21:20:35.15593-06:00","close_reason":"Superseded by new approach in epic hive-q39 - TUI exits before session creation"}
{"id":"hive-mte","title":"Pin keyboard hints to bottom of messages view","description":"The keyboard hints on the messages page don't extend to the bottom of the terminal. They should be pinned to the bottom row.\n\n## Expected\n- Help line should always appear at the bottom of the viewport\n- Content area should fill the space between headers and help line","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:54:07.444763-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:58:21.514378-06:00","closed_at":"2026-01-30T15:58:21.514378-06:00","close_reason":"Fixed all four layout issues: removed duplicate headers, moved session state to tab bar, fixed layout shift by removing per-view titles, pinned help to bottom, and added column headers to messages table."}
{"id":"hive-muc","title":"Restore async git status display in tree view","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:23.190688-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:00:07.512917-06:00","closed_at":"2026-01-30T17:00:07.512917-06:00","close_reason":"Restored full git status display: branch, additions (+N green), deletions (-N red), and clean/uncommitted indicator. Shows '...' while loading."}
{"id":"hive-q39","title":"TUI Session Creation - Exit, Execute, Re-enter","description":"When creating a session from TUI via 'n' key:\n1. Show form to select repo and enter session name\n2. On submit → **exit TUI cleanly**\n3. Run full `CreateSession()` with visible output (hooks, spawn commands)\n4. **Re-enter TUI** with updated session list\n\n## Current State\n\n- TUI stays active during session creation\n- Uses `SkipSpawn: true` to avoid spawning terminals\n- Hooks output goes to stdout, corrupting TUI display\n\n## Implementation\n\n### 1. Add `PendingCreate` field to Model (`internal/tui/model.go`)\n\n```go\n// PendingCreate holds data for a session to create after TUI exits\ntype PendingCreate struct {\n    Remote string\n    Name   string\n}\n\ntype Model struct {\n    // ... existing fields\n    pendingCreate *PendingCreate\n}\n\n// Getter for cmd_tui.go to access\nfunc (m Model) PendingCreate() *PendingCreate {\n    return m.pendingCreate\n}\n```\n\n### 2. Modify form submission to set pending and quit (`internal/tui/model.go`)\n\nIn `updateNewSessionForm()`, instead of calling `createSession()`:\n\n```go\nif f.State == huh.StateCompleted {\n    result := m.newSessionForm.Result()\n    m.state = stateNormal\n    m.newSessionForm = nil\n    // Set pending create and exit TUI\n    m.pendingCreate = \u0026PendingCreate{\n        Remote: result.Repo.Remote,\n        Name:   result.SessionName,\n    }\n    return m, tea.Quit\n}\n```\n\n### 3. Loop in cmd_tui.go to handle pending actions (`internal/commands/cmd_tui.go`)\n\n```go\nfunc (cmd *TuiCmd) run(ctx context.Context, _ *cli.Command) error {\n    localRemote, _ := cmd.flags.Service.DetectRemote(ctx, \".\")\n    topicsDir := filepath.Join(cmd.flags.DataDir, \"messages\", \"topics\")\n    msgStore := jsonfile.NewMsgStore(topicsDir)\n\n    for {\n        opts := tui.Options{\n            LocalRemote: localRemote,\n            MsgStore:    msgStore,\n        }\n\n        m := tui.New(cmd.flags.Service, cmd.flags.Config, opts)\n        p := tea.NewProgram(m, tea.WithAltScreen())\n\n        finalModel, err := p.Run()\n        if err != nil {\n            return fmt.Errorf(\"run tui: %w\", err)\n        }\n\n        model := finalModel.(tui.Model)\n\n        // Handle pending session creation\n        if pending := model.PendingCreate(); pending != nil {\n            source, _ := os.Getwd()\n            _, err := cmd.flags.Service.CreateSession(ctx, hive.CreateOptions{\n                Name:   pending.Name,\n                Remote: pending.Remote,\n                Source: source,\n            })\n            if err != nil {\n                fmt.Printf(\"Error creating session: %v\\n\", err)\n                fmt.Println(\"Press Enter to continue...\")\n                fmt.Scanln()\n            }\n            continue // Restart TUI\n        }\n\n        break // Normal exit\n    }\n    return nil\n}\n```\n\n### 4. Remove SkipSpawn option (`internal/hive/service.go`)\n\nRevert the `SkipSpawn` field from `CreateOptions` since we no longer need it.\n\n### 5. Clean up unused code\n\n- Remove `createSession()` command method from model.go\n- Remove `sessionCreatedMsg` message type\n\n## Verification\n\n1. Run `hive` (TUI mode)\n2. Press 'n' to open new session form\n3. Select a repo and enter session name\n4. Press Enter to submit\n5. Verify: TUI exits, hooks run with visible output, spawn commands execute\n6. Verify: TUI re-enters with new session in list\n7. Test cancelling form with Esc - should stay in TUI\n8. Test ctrl+c during form - should exit completely","status":"closed","priority":1,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T21:19:50.906429-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:32:14.180241-06:00","closed_at":"2026-01-30T21:32:14.180241-06:00","close_reason":"All subtasks completed: Added PendingCreate type, modified form submission to exit TUI, added loop in cmd_tui.go for pending actions, cleaned up SkipSpawn"}
{"id":"hive-rum","title":"Add copy-to-clipboard shortcut for message preview","description":"Add ability to copy message payload from the message preview modal using a keyboard shortcut.\n\n## Requirements\n- Add a keybinding (e.g., 'c' or 'y') in the message preview modal to copy payload\n- Copy command should be configurable in config (e.g., `pbcopy` on macOS, `xclip` on Linux)\n- Show brief feedback when copy succeeds\n\n## Files to modify\n- `internal/tui/message_preview.go` - handle copy key\n- `internal/core/config/config.go` - add copy command config option\n- Possibly add a clipboard utility package","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:38:38.235427-06:00","created_by":"Hayden","updated_at":"2026-01-30T16:13:21.048895-06:00","closed_at":"2026-01-30T16:13:21.048895-06:00","close_reason":"Added copy-to-clipboard with 'c' or 'y' key in message preview modal. Copy command is configurable via commands.copy_command config option with OS-specific defaults (pbcopy on macOS, xclip on Linux, clip on Windows)."}
{"id":"hive-rx8","title":"Use distinct color for session IDs","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:22.03027-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:10:32.018019-06:00","closed_at":"2026-01-30T17:10:32.018019-06:00","close_reason":"Changed session ID color from gray to purple (#bb9af7) for better distinction."}
{"id":"hive-sy7","title":"Update filter to match repo and session names","description":"Extend filter to match against both repository names and session names. Show matching sessions and their repo headers.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:38:11.22383-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:05:55.709011-06:00","closed_at":"2026-01-30T17:05:55.709011-06:00","close_reason":"Already implemented. FilterValue returns 'repoName sessionName' for sessions, enabling filter to match either. Headers return empty but display when child sessions match.","dependencies":[{"issue_id":"hive-sy7","depends_on_id":"hive-60w","type":"blocks","created_at":"2026-01-30T16:38:24.996916-06:00","created_by":"Hayden"}]}
{"id":"hive-uhe","title":"Remove KV store implementation","description":"Remove the KV store code entirely:\n\n- Delete internal/core/context/kv.go\n- Delete internal/store/jsonfile/kvstore.go  \n- Remove 'hive ctx kv' subcommand from cmd_ctx.go\n- Remove any KV-related tests\n- Clean up any imports/references\n\nState storage will be handled by beads instead.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.613123-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:45:05.437764-06:00","closed_at":"2026-01-29T20:45:05.437764-06:00","close_reason":"Removed KV store: deleted internal/core/context/kv.go, internal/store/jsonfile/kvstore.go and test, removed hive ctx kv subcommand from cmd_ctx.go","dependencies":[{"issue_id":"hive-uhe","depends_on_id":"hive-hdg","type":"blocks","created_at":"2026-01-29T20:08:24.550509-06:00","created_by":"Hayden"}]}
{"id":"hive-um2","title":"Add error wrapping to session store","description":"**Files**: `internal/store/jsonfile/store.go`\n**Risk**: Very Low\n\n## Problem\n\nSession Store returns unwrapped errors while MsgStore wraps all errors with context:\n\n**store.go (lines 131-136):**\n```go\nfunc (s *Store) load() (SessionFile, error) {\n    data, err := os.ReadFile(s.path)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return SessionFile{}, nil\n        }\n        return SessionFile{}, err  // No wrapping!\n    }\n    // ...\n}\n```\n\n## Solution\n\nAdd consistent error wrapping to store.go:\n\n```go\nfunc (s *Store) load() (SessionFile, error) {\n    data, err := os.ReadFile(s.path)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return SessionFile{}, nil\n        }\n        return SessionFile{}, fmt.Errorf(\"read sessions file: %w\", err)\n    }\n\n    if len(data) == 0 {\n        return SessionFile{}, nil\n    }\n\n    var file SessionFile\n    if err := json.Unmarshal(data, \u0026file); err != nil {\n        return SessionFile{}, fmt.Errorf(\"parse sessions file: %w\", err)\n    }\n\n    return file, nil\n}\n\nfunc (s *Store) save(file SessionFile) error {\n    if err := os.MkdirAll(filepath.Dir(s.path), 0o755); err != nil {\n        return fmt.Errorf(\"create sessions directory: %w\", err)\n    }\n\n    data, err := json.MarshalIndent(file, \"\", \"  \")\n    if err != nil {\n        return fmt.Errorf(\"marshal sessions: %w\", err)\n    }\n\n    tmp := s.path + \".tmp\"\n    if err := os.WriteFile(tmp, data, 0o644); err != nil {\n        return fmt.Errorf(\"write temp file: %w\", err)\n    }\n\n    if err := os.Rename(tmp, s.path); err != nil {\n        return fmt.Errorf(\"rename temp file: %w\", err)\n    }\n    return nil\n}\n```\n\n## Impact\n- Better error messages when debugging storage issues\n- Consistent pattern across all stores","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T19:04:23.201647-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:07:40.440236-06:00","closed_at":"2026-01-30T19:07:40.440236-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-um2","depends_on_id":"hive-x04","type":"parent-child","created_at":"2026-01-30T19:04:49.029504-06:00","created_by":"Hayden"}]}
{"id":"hive-vzg","title":"Match tree view selector style with messages view","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:24.004265-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:10:59.942146-06:00","closed_at":"2026-01-30T17:10:59.942146-06:00","close_reason":"Changed tree view selection indicator from ▸ to ┃ to match messages view style."}
{"id":"hive-wvy","title":"Update msg command: list by default, JSON output","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:48:11.945114-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:49:53.159676-06:00","closed_at":"2026-01-29T20:49:53.159676-06:00","close_reason":"Updated msg sub to list messages by default (JSON), added --listen flag for polling mode, made msg list output JSON"}
{"id":"hive-x04","title":"Code Quality Improvements","description":"Address code duplication and inconsistent patterns found during codebase analysis.\n\n## Overview\n\nThis epic addresses code duplication and inconsistent patterns found during codebase analysis. The improvements are ordered by impact and risk.\n\n---\n\n## 1. Extract Duplicate Directory Reading in MsgStore\n\n**Priority**: High\n**Files**: `internal/store/jsonfile/msgstore.go`\n\n### Problem\n\n`List()` (lines 174-202) and `listTopicsUnsafe()` (lines 283-306) contain nearly identical logic for reading topic files from disk.\n\n**List():**\n```go\nentries, err := os.ReadDir(s.topicsDir)\nif err != nil {\n    if os.IsNotExist(err) {\n        return nil, nil\n    }\n    return nil, fmt.Errorf(\"read topics directory: %w\", err)\n}\n\nvar topics []string\nfor _, entry := range entries {\n    if entry.IsDir() {\n        continue\n    }\n    name := entry.Name()\n    if strings.HasSuffix(name, \".json\") \u0026\u0026 !strings.HasSuffix(name, \".lock\") {\n        topic := strings.TrimSuffix(name, \".json\")\n        topic = strings.ReplaceAll(topic, \"_\", \"/\")\n        topics = append(topics, topic)\n    }\n}\nsort.Strings(topics)\nreturn topics, nil\n```\n\n**listTopicsUnsafe():**\n```go\n// Identical except no sort.Strings() call\n```\n\n### Solution\n\nExtract shared logic into a private `readTopicsFromDisk()` helper:\n\n```go\n// readTopicsFromDisk reads topic names from the topics directory.\n// Returns nil, nil if directory doesn't exist.\n// Caller is responsible for locking.\nfunc (s *MsgStore) readTopicsFromDisk() ([]string, error) {\n    entries, err := os.ReadDir(s.topicsDir)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return nil, nil\n        }\n        return nil, fmt.Errorf(\"read topics directory: %w\", err)\n    }\n\n    var topics []string\n    for _, entry := range entries {\n        if entry.IsDir() {\n            continue\n        }\n        name := entry.Name()\n        if strings.HasSuffix(name, \".json\") \u0026\u0026 !strings.HasSuffix(name, \".lock\") {\n            topic := strings.TrimSuffix(name, \".json\")\n            topic = strings.ReplaceAll(topic, \"_\", \"/\")\n            topics = append(topics, topic)\n        }\n    }\n    return topics, nil\n}\n```\n\nThen simplify both callers:\n\n```go\n// List returns all topic names (sorted).\nfunc (s *MsgStore) List(ctx context.Context) ([]string, error) {\n    s.mu.RLock()\n    defer s.mu.RUnlock()\n\n    topics, err := s.readTopicsFromDisk()\n    if err != nil {\n        return nil, err\n    }\n    sort.Strings(topics)\n    return topics, nil\n}\n\n// listTopicsUnsafe returns all topic names without locking.\n// Caller must hold s.mu.\nfunc (s *MsgStore) listTopicsUnsafe() ([]string, error) {\n    return s.readTopicsFromDisk()\n}\n```\n\n### Impact\n- Eliminates 20+ lines of duplicate code\n- Single source of truth for topic parsing logic\n- Easier to maintain filename conventions\n\n---\n\n## 2. Unify Template Rendering Between Spawner and Recycler\n\n**Priority**: Medium\n**Files**: `internal/hive/spawner.go`, `internal/hive/recycler.go`, `pkg/tmpl/tmpl.go`\n\n### Problem\n\nSpawner uses `tmpl.Render()` from `pkg/tmpl` while Recycler implements its own `renderCommand()` method. Both do the same thing but with slightly different error handling.\n\n**Spawner (line 48):**\n```go\nrendered, err := tmpl.Render(cmdTmpl, data)\n```\n\n**Recycler (lines 61-72):**\n```go\nfunc (r *Recycler) renderCommand(cmd string, data RecycleData) (string, error) {\n    tmpl, err := template.New(\"cmd\").Parse(cmd)\n    if err != nil {\n        return \"\", err\n    }\n\n    var buf bytes.Buffer\n    if err := tmpl.Execute(\u0026buf, data); err != nil {\n        return \"\", err\n    }\n\n    return buf.String(), nil\n}\n```\n\n### Solution\n\nUpdate Recycler to use `tmpl.Render()`:\n\n1. Remove `renderCommand()` method from Recycler\n2. Remove `bytes`, `text/template` imports from recycler.go\n3. Add `github.com/hay-kot/hive/pkg/tmpl` import\n4. Use `tmpl.Render()` in the Recycle method\n\n```go\nfunc (r *Recycler) Recycle(ctx context.Context, path string, commands []string, data RecycleData, w io.Writer) error {\n    // ...\n    for _, cmd := range commands {\n        rendered, err := tmpl.Render(cmd, data)\n        if err != nil {\n            return fmt.Errorf(\"render recycle command %q: %w\", cmd, err)\n        }\n        // ...\n    }\n}\n```\n\n### Impact\n- Single template rendering implementation\n- Recycler gets access to `shq` shell-quoting function\n- Consistent error wrapping (`parse template:` vs raw error)\n\n---\n\n## 3. Standardize Git Executor Error Messages\n\n**Priority**: Medium\n**Files**: `internal/core/git/executor.go`\n\n### Problem\n\nError messages have inconsistent formats:\n\n| Method | Current Error | Issue |\n|--------|--------------|-------|\n| Clone | `clone %s to %s: %w` | Has args, no prefix |\n| Checkout | `checkout %s: %w` | Has arg, no prefix |\n| Pull | `pull: %w` | No context |\n| ResetHard | `reset --hard: %w` | Command literal |\n| RemoteURL | `get remote url: %w` | Description |\n| IsClean | `git status: %w` | Has git prefix |\n| Branch | `git branch: %w` | Has git prefix |\n| DiffStats | `git diff: %w` | Has git prefix |\n\n### Solution\n\nStandardize to format: `git \u003ccommand\u003e[ \u003ccontext\u003e]: \u003cerror\u003e`\n\n```go\nfunc (e *Executor) Clone(ctx context.Context, url, dest string) error {\n    if _, err := e.exec.Run(ctx, e.gitPath, \"clone\", url, dest); err != nil {\n        return fmt.Errorf(\"git clone: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) Checkout(ctx context.Context, dir, branch string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"checkout\", branch); err != nil {\n        return fmt.Errorf(\"git checkout %s: %w\", branch, err)\n    }\n    return nil\n}\n\nfunc (e *Executor) Pull(ctx context.Context, dir string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"pull\"); err != nil {\n        return fmt.Errorf(\"git pull: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) ResetHard(ctx context.Context, dir string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"reset\", \"--hard\"); err != nil {\n        return fmt.Errorf(\"git reset --hard: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) RemoteURL(ctx context.Context, dir string) (string, error) {\n    out, err := e.exec.RunDir(ctx, dir, e.gitPath, \"remote\", \"get-url\", \"origin\")\n    if err != nil {\n        return \"\", fmt.Errorf(\"git remote get-url: %w\", err)\n    }\n    return strings.TrimSpace(string(out)), nil\n}\n```\n\n### Impact\n- Consistent error messages aid debugging\n- Users can easily identify which git command failed\n\n---\n\n## 4. Add Error Wrapping to Session Store\n\n**Priority**: Low\n**Files**: `internal/store/jsonfile/store.go`\n\n### Problem\n\nSession Store returns unwrapped errors while MsgStore wraps all errors with context:\n\n**store.go (lines 131-136):**\n```go\nfunc (s *Store) load() (SessionFile, error) {\n    data, err := os.ReadFile(s.path)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return SessionFile{}, nil\n        }\n        return SessionFile{}, err  // No wrapping!\n    }\n    // ...\n}\n```\n\n**msgstore.go (lines 312-320):**\n```go\nfunc (s *MsgStore) loadTopic(name string) (messaging.Topic, error) {\n    // ...\n    if err != nil {\n        if os.IsNotExist(err) {\n            return messaging.Topic{...}, nil\n        }\n        return messaging.Topic{}, fmt.Errorf(\"read topic file: %w\", err)  // Wrapped\n    }\n}\n```\n\n### Solution\n\nAdd consistent error wrapping to store.go:\n\n```go\nfunc (s *Store) load() (SessionFile, error) {\n    data, err := os.ReadFile(s.path)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return SessionFile{}, nil\n        }\n        return SessionFile{}, fmt.Errorf(\"read sessions file: %w\", err)\n    }\n\n    if len(data) == 0 {\n        return SessionFile{}, nil\n    }\n\n    var file SessionFile\n    if err := json.Unmarshal(data, \u0026file); err != nil {\n        return SessionFile{}, fmt.Errorf(\"parse sessions file: %w\", err)\n    }\n\n    return file, nil\n}\n\nfunc (s *Store) save(file SessionFile) error {\n    if err := os.MkdirAll(filepath.Dir(s.path), 0o755); err != nil {\n        return fmt.Errorf(\"create sessions directory: %w\", err)\n    }\n\n    data, err := json.MarshalIndent(file, \"\", \"  \")\n    if err != nil {\n        return fmt.Errorf(\"marshal sessions: %w\", err)\n    }\n\n    tmp := s.path + \".tmp\"\n    if err := os.WriteFile(tmp, data, 0o644); err != nil {\n        return fmt.Errorf(\"write temp file: %w\", err)\n    }\n\n    if err := os.Rename(tmp, s.path); err != nil {\n        return fmt.Errorf(\"rename temp file: %w\", err)\n    }\n    return nil\n}\n```\n\n### Impact\n- Better error messages when debugging storage issues\n- Consistent pattern across all stores\n\n---\n\n## Summary\n\n| Task | Priority | Lines Changed | Risk |\n|------|----------|---------------|------|\n| Extract MsgStore directory reading | High | ~30 | Low |\n| Unify template rendering | Medium | ~20 | Low |\n| Standardize git error messages | Medium | ~15 | Very Low |\n| Add Store error wrapping | Low | ~15 | Very Low |\n\n**Total estimated changes**: ~80 lines\n**Risk assessment**: All changes are internal refactors with no API changes\n\n---\n\n## Implementation Order\n\n1. Start with git executor error messages (lowest risk, quick win)\n2. Add Store error wrapping (isolated change)\n3. Extract MsgStore helper (clear duplication)\n4. Unify template rendering (requires import changes)\n\nEach change should be tested independently before moving to the next.","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-30T19:04:10.232864-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:08:44.979035-06:00","closed_at":"2026-01-30T19:08:44.979035-06:00","close_reason":"Closed"}
{"id":"hive-yym","title":"Remove brackets from tab indicators","description":"Remove the [] brackets around the active tab indicator - they throw off alignment.\n\n## Current\n`[Sessions] | Messages`\n\n## Desired\n`Sessions | Messages` (with styling to indicate active tab)\n\n## Files to modify\n- `internal/tui/model.go` - `renderTabView` function","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:38:43.47297-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:41:54.732103-06:00","closed_at":"2026-01-30T15:41:54.732103-06:00","close_reason":"Removed brackets from tab indicators - active tabs now use styling (blue + bold) only"}
{"id":"hive-zxv","title":"Extract duplicate directory reading in MsgStore","description":"**Files**: `internal/store/jsonfile/msgstore.go`\n**Risk**: Low\n\n## Problem\n\n`List()` (lines 174-202) and `listTopicsUnsafe()` (lines 283-306) contain nearly identical logic for reading topic files from disk.\n\n**List():**\n```go\nentries, err := os.ReadDir(s.topicsDir)\nif err != nil {\n    if os.IsNotExist(err) {\n        return nil, nil\n    }\n    return nil, fmt.Errorf(\"read topics directory: %w\", err)\n}\n\nvar topics []string\nfor _, entry := range entries {\n    if entry.IsDir() {\n        continue\n    }\n    name := entry.Name()\n    if strings.HasSuffix(name, \".json\") \u0026\u0026 !strings.HasSuffix(name, \".lock\") {\n        topic := strings.TrimSuffix(name, \".json\")\n        topic = strings.ReplaceAll(topic, \"_\", \"/\")\n        topics = append(topics, topic)\n    }\n}\nsort.Strings(topics)\nreturn topics, nil\n```\n\n**listTopicsUnsafe():**\n```go\n// Identical except no sort.Strings() call\n```\n\n## Solution\n\nExtract shared logic into a private `readTopicsFromDisk()` helper:\n\n```go\n// readTopicsFromDisk reads topic names from the topics directory.\n// Returns nil, nil if directory doesn't exist.\n// Caller is responsible for locking.\nfunc (s *MsgStore) readTopicsFromDisk() ([]string, error) {\n    entries, err := os.ReadDir(s.topicsDir)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return nil, nil\n        }\n        return nil, fmt.Errorf(\"read topics directory: %w\", err)\n    }\n\n    var topics []string\n    for _, entry := range entries {\n        if entry.IsDir() {\n            continue\n        }\n        name := entry.Name()\n        if strings.HasSuffix(name, \".json\") \u0026\u0026 !strings.HasSuffix(name, \".lock\") {\n            topic := strings.TrimSuffix(name, \".json\")\n            topic = strings.ReplaceAll(topic, \"_\", \"/\")\n            topics = append(topics, topic)\n        }\n    }\n    return topics, nil\n}\n```\n\nThen simplify both callers:\n\n```go\n// List returns all topic names (sorted).\nfunc (s *MsgStore) List(ctx context.Context) ([]string, error) {\n    s.mu.RLock()\n    defer s.mu.RUnlock()\n\n    topics, err := s.readTopicsFromDisk()\n    if err != nil {\n        return nil, err\n    }\n    sort.Strings(topics)\n    return topics, nil\n}\n\n// listTopicsUnsafe returns all topic names without locking.\n// Caller must hold s.mu.\nfunc (s *MsgStore) listTopicsUnsafe() ([]string, error) {\n    return s.readTopicsFromDisk()\n}\n```\n\n## Impact\n- Eliminates 20+ lines of duplicate code\n- Single source of truth for topic parsing logic\n- Easier to maintain filename conventions","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-30T19:04:31.919637-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:08:08.785689-06:00","closed_at":"2026-01-30T19:08:08.785689-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-zxv","depends_on_id":"hive-x04","type":"parent-child","created_at":"2026-01-30T19:04:49.088545-06:00","created_by":"Hayden"}]}
